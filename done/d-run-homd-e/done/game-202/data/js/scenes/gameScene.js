var soundsPath="sounds/",gameScene=function(){function oa(){z.alpha=1;D.alpha=1;p[p.length]=game.add.tween(D).to({alpha:0},300,Phaser.Easing.Cubic.In,!0);n.angle=-5;var a=game.add.tween(n).to({angle:5},750,"Linear",!0,0,-1);a.yoyo(!0,0);p.push(a);fa();E.push(game.time.events.add(250,Ca));E.push(game.time.events.add(2E3,Da))}function Da(){A.active=!0;A.active&&30>game.time.fps&&(A.active=!1,Ea(),game.antialias=!1)}function Ca(){B=!0;pa()}function pa(){B&&(H+=.016*game.time.fps,H>60*I&&(H=60*I),gamee.updateScore(H),
game.time.events.add(100,pa))}function Fa(){var a=x.list[v],c=500;L&&(p.push(game.add.tween(a).from({alpha:0},500,"Linear",!0)),c+=500);var f=a.startColor;0==I&&(a.alpha=1,f.alpha=1);var b=game.add.tween(f).to({alpha:1},1E3,"Linear",!0,0);p.push(b);b.onComplete.add(function(){E.push(game.time.events.add(c,function(){Y=!0}));E.push(game.time.events.add(1700,function(){Y=!1}));p.push(game.add.tween(f).to({alpha:0},1200,"Linear",!0,c));M(v,x);v++;v>=x.length&&(v=0);L&&(L.alpha=0);L=a})}function fa(a){0==
I||a||(V("star",n),sound.play("magic"),1.2<m.scale.x?qa("scale"):1==y.alpha&&qa("spike"),ra(),a=game.add.tween(n.scale).to({x:1.4,y:1.4},200,"Linear",!0,0,0),a.yoyo(!0,0),p.push(a));Fa();I++;0==t.alpha&&(t.alpha=1);t.text=I;t.reset(game.world.centerX,1.5*-t.height);t.active=!0;a=t.obstacle.body;a.reset(t.x,t.y);a.velocity.x=0;a.velocity.y=0;a.fixedRotation=!1;a.angularVelocity=0;a.gravityScale=1.2;a.rotation=0;t.obstacle.active=!0;Ga()}function Ga(){if(0==I%2&&2<game.rnd.integerInRange(0,4)){var a=
sa(Phaser.ArrayUtils.getRandomItem(W),N,O);a.reset(game.rnd.integerInRange(100,game.world.width-100),-a.height)}a=F[P];Z=-400;for(var c=game.world.centerX,f,b=a.length-1;-1<b;b--){var g=a[b];c=game.world.centerX;f=0;for(var h=[],k=0;k<g.length;k++){var d=g[k];if("empty"==d.substring(0,5))d=d.substring(5,d.length),d=Number(d),c+=d,f+=d;else{var l=d;if("Left"==d.substring(d.length-4,d.length)||"Right"==d.substring(d.length-5,d.length))l="circle";d=sa(l,S,Q);d.friend=null;0<k&&(c+=.5*d.width,f+=.5*d.width);
l=d.body;l.velocity.x=0;l.velocity.y=0;l.fixedRotation=!1;l.angularVelocity=0;l.gravityScale=.5;l.rotation=0;l.enabled=!1;l.reset(c,Z);"bar"==d.tag&&(l.fixedRotation=!0);h[h.length]=d;c+=.5*d.width+25;k<g.length-1&&(f+=.5*d.width+25)}}h.forEach(function(a){a.body.x-=.5*f;if(200>Math.abs(a.body.x-game.world.centerX)){a:{var b=H+60;for(var c=0;c<J.length;c++){var d=J.children[c];if(d.score<b&&d.score>=H&&d.active&&d.score>lastScore){b=d;break a}}b=void 0}b&&(b.x=0,b.y=0,b.alpha=1,a.addChild(b),a.friend=
b)}});Z-=150}}function sa(a,c,f){for(var b=null,g=0;g<c.length;g++){var h=c.children[g];if(!h.active&&h.tag==a){h.alpha=1;c.remove(h);f.add(h);h.active=!0;b=h;break}}return b}function Ea(){x.forEach(function(a){a.barsGroup.forEach(function(a){a.destroy()})})}function qa(a){"scale"==a?(m.alpha=0,a=game.add.tween(m).to({alpha:1},200,"Linear",!0,0,3),a.onComplete.add(function(){m.scale.setTo(m.originalScale,m.originalScale);m.body.setCircle(.3*m.width)}),p.push(a)):"spike"==a&&(m.alpha=0,y.alpha=0,p.push(game.add.tween(y).to({alpha:1},
200,"Linear",!0,0,3)),a=game.add.tween(m).to({alpha:1},200,"Linear",!0,0,3),a.onComplete.add(function(){y.alpha=0;m.invincible=!1}),p.push(a))}function Ha(){0<y.alpha&&(y.reset(m.body.x,m.body.y),y.angle+=10);O.forEach(function(a){a.y+=8;if(ta(a,m)&&a.active){V("star",m);if("grow"==a.tag){sound.play("powerup");m.alpha=0;p.push(game.add.tween(m).to({alpha:1},200,"Linear",!0,0,4));var c=2.5*m.originalScale;m.scale.setTo(c,c);m.body.setCircle(.3*m.width)}else"spikeItem"==a.tag&&(sound.play("powerup"),
y.reset(m.body.x,m.body.y),y.alpha=1,m.invincible=!0);aa(a,N,O)}a.y>game.world.height+a.height&&a.active&&aa(a,N,O)});L&&A.active&&L.barsGroup.forEach(function(a){a.y=Y?a.y+3:a.y+1;a.y>game.world.height+a.height&&(a.y=.6*-a.height)});ua(t.obstacle);Q.forEach(function(a){ua(a);(a.body.y>game.world.height+a.height||-100>a.body.x||a.body.x>game.world.width+100||a.body.y<.3*-game.world.height&&2<a.body.gravityScale)&&va(a)})}function ua(a){ta(a,m)&&a.active&&m.invincible&&(sound.play("splashMud"),V("ouch",
a),"levelText"!=a.tag&&"bar"!=a.tag?va(a):a.body.x+=game.world.width)}function va(a){aa(a,S,Q);0==Q.length&&B&&fa()}function M(a,c){for(var f=0;f<c.length;f++)c.children[f].alpha=0,f==a&&(c.children[f].alpha=1,c.children[f].active=!0)}function ra(){P++;7<=P&&("Easy"==G?(G="Medium",F=K.mediumLevels,Phaser.ArrayUtils.shuffle(F)):"Medium"==G?(G="Hard",F=K.hardLevels,Phaser.ArrayUtils.shuffle(F)):"Hard"==G&&(G="Hard",F=K.hardLevels,Phaser.ArrayUtils.shuffle(F)),P=0);R.text="Difficulty: "+G+"\nLevel: "+
(P+1)}function Ia(a){sound.stop("gameSong");sound.play("gameLose");B=!1;v=null;game.stage.backgroundColor="#ffffff";a=game.add.tween(z).to({alpha:1},500,Phaser.Easing.Cubic.In,!0,1E3);p[p.length]=a;a.onComplete.add(function(){lastScore=H;gamee.gameOver()})}function Ja(){x=game.add.group();z.add(x);x.list=[];for(var a=0;a<q.length;a++){var c=game.add.group();c.active=!1;c.alpha=0;x.add(c);x.list[x.list.length]=c;var f=this.game.add.bitmapData(this.game.width,this.game.height),b=f.context.createLinearGradient(0,
0,0,game.world.height);b.addColorStop(0,q[a][1]);b.addColorStop(1,q[a][0]);f.context.fillStyle=b;f.context.fillRect(0,0,this.game.width,this.game.height);f=this.game.add.sprite(0,0,f);c.add(f);f=new Phaser.Graphics(game);f.alpha=0;f.beginFill(q[a][2]);f.drawRect(0,0,game.world.width,game.world.height);f.endFill();overlayGroup.add(f);c.startColor=f;var g=game.add.group();c.add(g);f=game.add.group();c.add(f);c.barsGroup=f;if(0==a){b=c.create(game.world.centerX,game.world.height-200,"atlas.game","main_trianle");
b.anchor.setTo(.5,1);b.tint=q[a][2];r(g,game.world.centerX,.23*-game.world.height,16121725);for(var h=game.world.height-100,k=0;2>k;k++){var d=game.add.group();f.add(d);d.y=h;d.initY=d.y;var l=game.world.centerX;c=0;1==k&&(d.alpha=.4);for(b=0;3>b;b++)g=d.create(l,c,"atlas.game","triangle_line"),g.scale.setTo(2,2),g.anchor.setTo(.5,1),1==k&&(g.scale.y*=-1),c-=.75*g.height,l-=100,g.tint=q[a][2],1==b&&(l=game.world.centerX);h-=1.2*game.world.height}}else if(1==a)for(r(g,game.world.centerX-200,game.world.centerY+
50,200,16121725),r(g,game.world.centerX+100,game.world.centerY-100,100,16121725),h=game.world.height-100,k=0;2>k;k++){d=game.add.group();f.add(d);d.y=h;d.initY=d.y;1==k&&(d.alpha=.2);l=game.world.centerX-400;for(b=c=0;6>b;b++){var e=d.create(l,c,"atlas.game","box");e.anchor.setTo(.5,.5);e.scale.setTo(2,2);e.angle=45;e.tint=q[a][2];1==k&&(e.scale.y*=-1);l+=145;c+=165;0==(b+1)%3&&(l=game.world.centerX-90,c=-155)}h-=1.25*game.world.height}else if(2==a)for(r(g,game.world.centerX,game.world.centerY-50,
300,16121725),r(g,game.world.centerX+200,game.world.centerY+100,100,16121725),h=game.world.height-50,k=0;2>k;k++){d=game.add.group();f.add(d);d.y=h;d.initY=d.y;for(b=c=0;3>b;b++)l=d.create(game.world.centerX,c,"atlas.game","gilotina"),l.anchor.setTo(.5,.5),l.origWidth=l.width,l.width=game.world.width,l.scale.y=2,l.tint=q[a][2],c-=120-10*b;1==k&&(d.alpha=.1);h-=1*game.world.height}else if(3==a)for(r(g,game.world.centerX-200,game.world.centerY-200,150,16121725),r(g,game.world.centerX+150,game.world.centerY-
50,100,16121725),h=game.world.height-100,k=0;2>k;k++){d=game.add.group();f.add(d);d.y=h;d.initY=d.y;1==k&&(d.alpha=.5);l=game.world.centerX;for(b=c=0;3>b;b++)e=d.create(l,c,"atlas.game","curved_triangle"),e.anchor.setTo(.5,.5),e.scale.setTo(2,2),e.tint=q[a][2],1==k&&(e.scale.y*=-1),c-=100;h-=1.35*game.world.height}else if(4==a){h=game.world.height-100;for(k=0;2>k;k++){d=game.add.group();f.add(d);d.y=h;d.initY=d.y;l=game.world.centerX;c=0;var m="blue",n=q[a][2];1==k&&(m="yellow",n=q[a][3]);for(b=0;3>
b;b++)e=d.create(l,c,"atlas.game",m),e.anchor.setTo(.5,.5),e.scale.setTo(2,2),e.tint=n,e.width=game.world.width,c-=100;h-=1*game.world.height}r(g,game.world.centerX,game.world.centerY+50,400,11403257);r(g,game.world.centerX,game.world.centerY-250,100,11403257)}else if(5==a)for(r(g,game.world.centerX+200,game.world.centerY+100,150,16121725),r(g,game.world.centerX-200,game.world.centerY-200,50,16121725),h=game.world.height-100,k=0;2>k;k++){d=game.add.group();f.add(d);d.y=h;d.initY=d.y;1==k&&(d.alpha=
.5);l=game.world.centerX-200;for(b=c=0;3>b;b++)e=d.create(l,c,"atlas.game","chair_shape"),e.anchor.setTo(.5,.5),e.scale.setTo(2,2),e.tint=q[a][3],1==k&&(e.scale.y*=-1,e.scale.x*=-1),l+=118,c-=100;h-=1.5*game.world.height}else if(6==a)for(r(g,game.world.centerX-50,game.world.centerY-50,250,7929829),h=game.world.height-200,k=0;2>k;k++){d=game.add.group();f.add(d);d.y=h;d.initY=d.y;1==k&&(d.alpha=.7);l=game.world.centerX;for(b=c=0;3>b;b++)e=d.create(l,c,"atlas.game","wave"),e.width=game.world.width,
e.scale.y=2,e.anchor.setTo(.5,.5),e.tint=16121909,1==k?(e.scale.x*=-1,e.scale.y*=-1):e.tint=q[a][2],c-=75;h-=1.1*game.world.height}else if(7==a){r(g,game.world.width,game.world.height,1.4*game.world.width,7929829);r(g,game.world.centerX-100,game.world.centerY-100,100,7929829);d=game.add.group();d.x=game.world.width;d.y=game.world.height-100;d.initY=d.y;f.add(d);for(b=c=l=0;7>b;b++)e=d.create(l,c,"atlas.game","box"),e.scale.x*=1.6,e.tint=q[a][2],e.anchor.setTo(1,.5),l-=e.width-5,c+=75;h=game.add.group();
h.alpha=.5;h.initY=0;f.add(h);for(b=c=l=0;7>b;b++)e=h.create(l,c,"atlas.game","box"),e.scale.x*=1.6,e.scale.y*=-1,e.tint=q[a][2],e.anchor.setTo(0,.5),l+=e.width-1,c-=75}else if(8==a)for(r(g,game.world.centerX-200,game.world.centerY-50,200,6619231),r(g,game.world.centerX+200,game.world.centerY-50,200,6619231),h=game.world.height-100,k=0;2>k;k++){d=game.add.group();f.add(d);d.y=h;d.initY=d.y;1==k&&(d.alpha=.7);l=game.world.centerX;for(b=c=0;6>b;b++)e=d.create(l,c,"atlas.game","diamond"),e.anchor.setTo(.5,
.5),e.scale.setTo(2,2),e.tint=q[a][3],e.x-=e.width,1==k&&(e.scale.y*=-1),l+=e.width,2==b?(l-=2.5*e.width,c-=.5*e.height):4==b&&(l=game.world.centerX+e.width,c-=.5*e.height);h-=1.5*game.world.height}else if(9==a)for(r(g,game.world.centerX,game.world.centerY+150,500,10682214),h=game.world.height-200,k=0;2>k;k++){d=game.add.group();f.add(d);d.y=h;d.initY=d.y;1==k&&(d.alpha=.4);for(b=c=l=0;4>b;b++)e=d.create(l,c,"atlas.game","small_waves"),e.anchor.setTo(0,.5),e.scale.setTo(2,2),e.tint=q[a][2],d.add(e),
g=d.create(e.x+e.width-1.5,c,"atlas.game","small_waves"),g.anchor.setTo(0,.5),g.scale.setTo(2,2),g.tint=q[a][2],d.add(g),0==(b+1)%2&&(e.x-=75,g.x-=75),1==k&&(e.scale.y*=-1,g.scale.y*=-1),c-=.3*e.height;h-=1.4*game.world.height}else if(10==a)for(r(g,game.world.centerX,game.world.centerY+150,500,63586),r(g,game.world.centerX,game.world.centerY-300,200,63586),h=game.world.height-200,k=0;2>k;k++){d=game.add.group();f.add(d);d.y=h;d.initY=d.y;1==k&&(d.alpha=.3);l=game.world.centerX;for(b=c=0;3>b;b++)e=
d.create(l,c,"atlas.game","triangles"),e.scale.setTo(2,2),e.anchor.setTo(.5,.5),e.tint=q[a][2],1==k&&(e.scale.x*=-1,e.scale.y*=-1),c-=100;h-=1.2*game.world.height}else if(11==a)for(b=c.create(game.world.centerX,game.world.centerY,"atlas.game","earthworm"),b.anchor.setTo(.5,.5),b.scale.setTo(2,2),b.alpha=.2,b.tint=9502739,b=c.create(game.world.centerX+100,game.world.centerY+100,"atlas.game","earthworm"),b.anchor.setTo(.5,.5),b.scale.setTo(2,2),b.alpha=.2,b.tint=9502739,h=game.world.height-100,k=0;2>
k;k++){d=game.add.group();f.add(d);d.y=h;d.initY=d.y;1==k&&(d.alpha=.1);l=game.world.centerX;for(b=c=0;5>b;b++)e=d.create(l,c,"atlas.game","small_waves_2"),e.scale.setTo(2,2),e.anchor.setTo(.5,.5),e.tint=q[a][2],1==k&&(e.scale.x*=-1,e.scale.y*=-1),c-=75;h-=1*game.world.height}else if(12==a){l=game.world.centerX-250;for(b=0;3>b;b++)h=c.create(l,game.world.centerY,"atlas.game","diamond"),h.anchor.setTo(.5,.5),h.alpha=.2,h.tint=16772214,h.scale.setTo(.8,.8),l+=250,1==b&&h.scale.setTo(.8,.8);h=game.world.height-
200;for(k=0;2>k;k++){d=game.add.group();f.add(d);d.y=h;d.initY=d.y;1==k&&(d.alpha=.3);l=game.world.centerX;for(b=c=0;3>b;b++)e=d.create(l,c,"atlas.game","mountains"),e.anchor.setTo(.5,.5),e.scale.setTo(2,2),e.tint=q[a][2],1==k&&(e.scale.x*=-1,e.scale.y*=-1),c-=100;h-=1*game.world.height}}else if(13==a)for(r(g,game.world.centerX,game.world.centerY,110,16772214),r(g,game.world.centerX-225,game.world.centerY-100,110,16772214),r(g,game.world.centerX+225,game.world.centerY-100,110,16772214),h=game.world.height-
350,k=0;2>k;k++){d=game.add.group();f.add(d);d.y=h;d.initY=d.y;1==k&&(d.alpha=.3);l=game.world.centerX;for(b=c=0;2>b;b++)e=d.create(l,c,"atlas.game","planet_system"),e.scale.setTo(2,2),e.anchor.setTo(.5,.5),e.tint=q[a][2],1==b&&e.scale.setTo(1.4,1.4),1==k&&(e.scale.y*=-1),c-=60;h-=.8*game.world.height}else if(14==a)for(r(g,game.world.width,game.world.height,800,16772214),r(g,game.world.centerX-200,game.world.centerY-100,150,16772214),h=game.world.height+100,k=0;2>k;k++){d=game.add.group();f.add(d);
d.y=h;d.initY=d.y;1==k&&(d.alpha=.4);l=game.world.centerX;for(b=c=0;3>b;b++)e=d.create(l,c,"atlas.game","hexagon"),e.scale.setTo(2,2),e.anchor.setTo(.5,.5),e.tint=q[a][2],1==k&&(e.scale.y*=-1),c-=125;h-=1.4*game.world.height}else r(g,game.world.width,game.world.height)}M(v,x);f=x.list[v];f.alpha=1;f.startColor.alpha=1;R=game.add.bitmapText(0,game.world.height-50,"roundsBlack","",20);R.tint=16777215;R.anchor.setTo(0,1);R.alpha=0;overlayGroup.add(R);A=game.add.tileSprite(0,-game.world.height,4*game.world.width,
2*game.world.height,"atlas.game","stars");A.angle=45;z.add(A)}function r(a,c,f,b,g){g=g||16777215;b=b||1.1*game.world.height;var h=game.add.graphics(0,0);h.beginFill(g);h.alpha=.1;h.drawCircle(c,f,b);h.endFill();a.add(h)}function ta(a,c){var f=a.getBounds(),b=c.getBounds();return Phaser.Rectangle.intersects(f,b)}function V(a,c,f){f=f||0;a:{for(var b=0;b<T.length;b++){var g=T.children[b];if(g.tag==a){g.used=!0;g.alpha=1;"text"==a&&(T.remove(g),ha.add(g));a=g;break a}}a=void 0}a&&(a.x=c.world.x+f,a.y=
c.world.y,a.scale.setTo(1,1),a.start(!0,1500,null,6),a.setAlpha(1,0,2E3,Phaser.Easing.Cubic.In))}function ba(a,c){for(var f=0;f<c;f++){if("text"==a){var b=game.add.bitmapText(0,0,"roundsBlack","0",50);b.anchor.setTo(.5,.5)}else b=game.add.emitter(0,0,100),b.makeParticles("atlas.game",a),b.minParticleSpeed.setTo(-400,-400),b.maxParticleSpeed.setTo(400,400),b.minParticleScale=.6,b.maxParticleScale=1.5,b.gravity=0,b.angularDrag=30;T.add(b);b.alpha=0;b.tag=a;b.used=!1;b.scale.setTo(1,1)}}function Ka(){gamee.emitter.addEventListener("pause",
function(a){game.paused=!0;a.detail.callback()});gamee.emitter.addEventListener("resume",function(a){ca&&(sound.play("gameSong",{loop:!0,volume:.5}),ca=!1);game.paused=!1;a.detail.callback()});gamee.emitter.addEventListener("mute",function(a){sound.stop("gameSong");sound.setSound(!1);game.sound.mute=!0;a.detail.callback()});gamee.emitter.addEventListener("unmute",function(a){sound.setSound(!0);ca=!0;game.sound.mute=!1;a.detail.callback()});gamee.emitter.addEventListener("start",function(a){game.paused=
!1;La();wa();sceneloader.socialRequest(Ma,game,10);ca=!1;H=0;Z=-200;canSound=!0;P=ia=ja=I=0;G="Easy";F=K.easyLevels;Phaser.ArrayUtils.shuffle(F);C=[];v||(v=game.rnd.integerInRange(0,q.length-1));L=null;Y=!1;R.text="Difficulty: "+G+"\nLevel: "+(P+1);ka&&sceneloader.showTutorial()?Na():(w.globe.alpha=0,w.barrier.alpha=0,oa());a.detail.callback()})}function wa(){x.forEach(function(a){a.alpha=0;a.active=!1;a.startColor.alpha=0});M(v,x);t.active=!1;t.obstacle.active=!1;da.y=0;y.alpha=0;y.angle=0;n.scale.setTo(n.origScale,
n.origScale);n.alpha=1;n.angle=0;n.x=game.world.centerX;n.y=.8*game.world.height;n.col.reset(n.x,n.y+3);m.body.x=n.x;m.body.y=n.y-300;m.scale.setTo(m.originalScale,m.originalScale);m.alpha=1;m.invincible=!1;xa();ya(S,Q);ya(N,O);sound.play("gameSong",{loop:!0,volume:.5})}function ya(a,c){for(;0<c.length;)aa(c.children[0],a,c)}function aa(a,c,f){if(a.body){var b=a.body;b.gravityScale=0;b.setZeroVelocity();b.setZeroRotation();b.x=-game.world.width;b.kill()}a.friend&&(a.friend.active=!1,a.friend.alpha=
0,J.add(a.friend),a.friend=null);a.active=!1;a.alpha=0;f.remove(a);c.add(a)}function Na(){v||(v=Phaser.ArrayUtils.getRandomItem(za));game.stage.backgroundColor=q[v][0];x.list[v].startColor.alpha=1;m.alpha=0;n.alpha=0;var a=w.hand,c=w.barrier,f=w.obstacle,b=w.globe;c.y=game.world.centerY;a.alpha=0;f.angle=0;b.angle=5;b.tween=game.add.tween(b).to({angle:-5},750,"Linear",!0,0,-1);b.tween.yoyo(!0,0);f.reset(game.world.centerX,-200);M(0,b);var g=game.add.tween(f).to({y:c.y-250},2E3,"Linear",!0);p.push(g);
g.onComplete.add(function(){Aa(b,100);M(1,b);a.y=c.y+15;g=game.add.tween(a).to({alpha:1},200,"Linear",!0,0,4);p.push(g);g.onComplete.add(function(){p.push(game.add.tween(c).to({y:c.y-150},500,"Linear",!0));p.push(game.add.tween(f).to({y:f.y+50},500,"Linear",!0));g=game.add.tween(a).to({y:c.y-125},500,"Linear",!0);p.push(g);g.onComplete.add(function(){Aa(b,100);M(2,b);sound.play("magic");sound.play("drum1");V("ouch",c);g=game.add.tween(f).to({x:-200,y:f.y-250,angle:f.angle-270},1E3,"Linear",!0);p.push(g);
E.push(game.time.events.add(2300,function(){b.tween.stop();m.alpha=1;n.alpha=1;ka=!1;w.alpha=0;gamee.gameSave("tutorialDone");D.alpha=1;oa()}))})})})}function Aa(a,c){sound.play("cut");var f=game.add.tween(a.scale).to({x:.6*a.scale.x,y:.6*a.scale.y},c,"Linear",!0,0,0);f.yoyo(!0,0);p.push(f)}function La(){p.forEach(function(a){a&&game.tweens.remove(a)});E.forEach(function(a){game.time.events.remove(a)});p=[];E=[]}function Ma(){C=sceneloader.getSocialInfo();for(var a=0;a<C.length&&J.length!=a;a++){var c=
J.children[a];c.alpha=0;c.active=!0;c.score=C[a].highScore;c.name=C[a].name;c.userID=C[a].userID;var f=C[a].name;if(game.cache.checkImageKey(f)){var b=c.create(0,0,f);Ba(90,b);b.anchor.setTo(.5,.5);c.friend=b;b.mask=c.maskUsed}c.remove(c.bubble);c.add(c.bubble)}C&&C.player&&(a=C.player,u.alpha=0,u.score=a.highScore,u.playerName=a.name,game.cache.checkImageKey(a.name)&&(b=u.create(0,0,f),Ba(90,b),b.anchor.setTo(.5,.5),u.friend=b,b.mask=u.maskUsed),u.remove(u.bubble),u.add(u.bubble));u.friend&&p.push(game.add.tween(u).to({alpha:1},
500,"Linear",!0))}function Ba(a,c){c.width=c.width*a/c.height;for(c.height=a;90>c.width;)c.width+=.1*c.width,c.height+=.1*c.height}function Oa(){U=game.add.group();z.add(U);U.x=100;U.y=100;U.alpha=0;var a=game.add.bitmapText(.7*u.width,0,"roundsBlack","",20);a.tint=0;a.anchor.setTo(0,.5);U.add(a)}function Pa(){J=game.add.group();da.add(J);la=game.add.group();z.add(la);for(var a=0,c=0;15>c;c++)J.add(ma(a)),la.add(ma(a,!0)),a++,4==a&&(a=0);u=ma(a);z.add(u);u.x=2;u.y=4;n.addChild(u)}function ma(a,c){var f=
game.add.group();f.x=0;f.y=0;f.alpha=0;f.active=!1;f.friend=null;var b=game.add.graphics(0,0);b.beginFill(16777215);b.drawCircle(0,0,90);b.alpha=0;b.endFill();c&&(f.scale.setTo(.85,.85),f.origScale=f.scale.x,b.scale.setTo(f.scale.x,f.scale.y));f.add(b);f.maskUsed=b;var g=f.create(0,0,"atlas.game","avatar");g.anchor.setTo(.5,.5);g.mask=b;f.avatar=g;b=f.create(0,0,"atlas.game","social_frame");b.tint=[378561,15539833,15817252,14278689][a];b.anchor.setTo(.5,.5);b.alpha=0;f.bubble=b;return f}function Qa(){n=
overlayGroup.create(0,0,"atlas.game","balloon");n.alpha=0;n.anchor.setTo(.5,.3);n.scale.setTo(.8,.8);n.origScale=n.scale.x;n.events.onInputDown.add(Ra);var a=z.create(0,-3,"atlas.game","circle");a.anchor.setTo(.5,.5);a.scale.setTo(2,2);a.tint=0;a.alpha=0;n.col=a;game.physics.box2d.enable(a);a.body.setCircle(.5*a.width);a.body.kinematic=!0;a.body.setCollisionCategory=2;a.tag="balloon"}function Ra(){B&&(v++,wa(),ra(),fa(!0))}function xa(){game.physics.box2d.enable(m);m.body.setCircle(.3*m.width);m.body.collideWorldBounds=
!0;game.input.onDown.add(Sa,this);game.input.addMoveCallback(Ta,this);game.input.onUp.add(Ua,this)}function Sa(){B&&(ja=game.input.activePointer.x-m.x,ia=game.input.activePointer.y-m.y,game.physics.box2d.mouseDragStart({x:m.x,y:m.y}))}function Ta(){B&&game.physics.box2d.mouseDragMove({x:game.input.x-ja,y:game.input.y-ia})}function Ua(){game.physics.box2d.mouseDragEnd()}function Va(){X=[];for(var a,c=0;c<ea.length;c++){X[c]=0;var f=ea[c];a=[K.easyLevels,K.mediumLevels,K.hardLevels];for(var b=0;b<a.length;b++)for(var g=
0;g<a[b].length;g++){for(var h=a[b][g],k=0,d=0;d<h.length;d++)for(var l=0;l<h[d].length;l++)f==h[d][l]&&k++;X[c]<k&&(X[c]=k)}}S=game.add.group();z.add(S);Q=game.add.group();overlayGroup.add(Q);for(a=0;a<ea.length;a++)for(c=0;c<X[a];c++)f=b=ea[a],"bar"==b&&(b="square"),b=S.create(-500,0,"atlas.game",b),b.anchor.setTo(.5,.5),b.active=!1,b.tag=f,game.physics.box2d.enable(b),g=b.width,h=b.height,"circle"==f?b.body.setCircle(.5*g):"triangle"==f?b.body.setPolygon([.5*-g,.5*h,0,.5*-h,.5*g,.5*h]):"rhombus"==
f?b.body.setPolygon([.5*-g,0,0,.5*-h,.5*g,0,0,.5*h]):"cross"==f&&b.body.setPolygon([.2*-g,.5*h,.2*-g,.2*h,.5*-g,.2*h,.5*-g,.2*-h,.2*-g,.2*-h,.2*-g,.5*-h,.2*g,.5*-h,.2*g,.2*-h,.5*g,.2*-h,.5*g,.2*h,.2*g,.2*h,.2*g,.5*h]),"bar"==f&&(b.tint=0,b.body.mass=1E21),b.body.setCollisionCategory(2),b.body.kill(),b.body.setCategoryContactCallback(2,na,this),b.body.collideWorldBounds=!1;m.body.setCategoryContactCallback(2,na,this)}function na(a,c){!a.sprite.tag&&canSound&&B&&(sound.play("drum"+game.rnd.integerInRange(1,
2)),canSound=!1,E.push(game.time.events.add(250,function(){canSound=!0})));c.sprite.tag&&"bar"!=c.sprite.tag&&(c.gravityScale=3);"balloon"==c.sprite.tag&&B&&(V("ouch",n),sound.play("explode"),p.push(game.add.tween(n.scale).to({x:3,y:3},300,Phaser.Easing.Bounce.InOut,!0)),p.push(game.add.tween(n).to({alpha:0,angle:n.angle+20},300,"Linear",!0)),c.kill(),Ia())}function Wa(){t=game.add.bitmapText(0,0,"roundsBlack","0",100);t.anchor.setTo(.5,.5);t.alpha=0;overlayGroup.add(t);var a=overlayGroup.create(-500,
0,"atlas.game","square");a.anchor.setTo(.5,.5);a.scale.setTo(.4,.7);a.alpha=0;game.physics.box2d.enable(a);a.body.setRectangle(t.width,t.height,0,-10);a.body.kinematic=!1;a.body.collideWorldBounds=!1;a.body.setCollisionCategory(2);a.body.setCategoryContactCallback(2,na,this);a.tag="levelText";a.body.kill();t.obstacle=a}function Xa(){N=game.add.group();overlayGroup.add(N);O=game.add.group();overlayGroup.add(O);W=["grow","spikeItem"];for(var a=0;a<W.length;a++){var c=N.create(0,0,"atlas.game",W[a]);
c.anchor.setTo(.5,.5);c.alpha=0;c.active=!1;c.tag=W[a]}}function Ya(){w=game.add.group();overlayGroup.add(w);var a=w.create(game.world.centerX,game.world.centerY+100,"atlas.game","hand");a.alpha=0;a.scale.setTo(.7,.7);a.anchor.setTo(.4,.2);w.hand=a;a=game.add.group();a.x=game.world.centerX;a.y=game.world.height-150;a.scale.setTo(.8,.8);w.add(a);w.globe=a;for(var c=1;4>c;c++)a.create(0,0,"atlas.game","balloon"+c).anchor.setTo(.5,.5);M(0,a);a=w.create(game.world.centerX,game.world.centerY,"atlas.game",
"circleBarrier");a.anchor.setTo(.5,.5);a.scale.setTo(.7,.7);w.barrier=a;a=w.create(game.world.centerX,-200,"atlas.game","square");a.anchor.setTo(.5,.5);w.obstacle=a}assets={atlases:[{name:"atlas.game",json:"images/game/atlas.json",image:"images/game/atlas.png"}],images:[],sounds:[{name:"cut",file:soundsPath+"cut.mp3"},{name:"magic",file:soundsPath+"magic.mp3"},{name:"gameLose",file:soundsPath+"gameLose.mp3"},{name:"drum1",file:soundsPath+"drum1.mp3"},{name:"drum2",file:soundsPath+"drum2.mp3"},{name:"explode",
file:soundsPath+"fireExplosion.mp3"},{name:"powerup",file:soundsPath+"powerup.mp3"},{name:"splashMud",file:soundsPath+"splashMud.mp3"},{name:"gameSong",file:soundsPath+"songs/space_music.mp3"}]};var da,J,la,u,U,z=null,B,T,ha,I,H,C,p,E,n,m,ja,ia,S,Q,y,Z,t,K,x,A,R,G,P,F,N,O,W,v,L,ca,X=[],Y,w,ka,D,za=[0,2,4,7,9,11],ea="square circle triangle rhombus rectangle bar cross".split(" "),q=[["#ca0092","#ffda20",13238418,16767520],["#ffda20","#7500ba",16767520,7667898],["#7500ba","#fabb02",7667898,16431874],
["#fabb02","#4a61ff",16431874,4874751],["#4a61ff","#fb9902",4874751,16488706],["#fb9902","#4cffd8",16488706,5046232],["#4cffd8","#f60035",5046232,16121909],["#f60035","#353789",16121909,3487625],["#353789","#ff4f53",3487625,16731987],["#ff4f53","#00f862",16731987,63586],["#00f862","#910013",63586,9502739],["#910013","#ffe786",9502739,16770950],["#ffe786","#860052",16770950,8781906],["#860052","#fefe31",8781906,16711217],["#fefe31","#ca0092",16711217,13238418]];return{assets:assets,name:"gameScene",
update:function(){A&&(A.tilePosition.x+=1.5,A.tilePosition.y+=1.5);m.body.setZeroVelocity();if(t.active){var a=t.obstacle;t.reset(a.body.x,a.body.y);t.angle=a.angle}B&&Ha()},preload:function(){game.stage.disableVisibilityChange=!1;game.load.bitmapFont("roundsBlack","images/game/font/roundsBlack.png","images/game/font/roundsBlack.fnt")},create:function(a){v=Phaser.ArrayUtils.getRandomItem(za);K=levels.getLevels();game.physics.startSystem(Phaser.Physics.BOX2D);game.physics.box2d.gravity.y=150;game.physics.box2d.restitution=
.2;game.physics.box2d.setBoundsToWorld();lastScore=0;ka=!0;game.stage.backgroundColor="#ffffff";p=[];E=[];z=game.add.group();overlayGroup=game.add.group();Ja();da=game.add.group();z.add(da);Qa();y=overlayGroup.create(0,0,"atlas.game","spike");y.anchor.setTo(.5,.5);y.alpha=0;m=overlayGroup.create(game.world.centerX,game.world.centerY,"atlas.game","circleBarrier");m.alpha=0;m.scale.setTo(.7,.7);m.originalScale=m.scale.x;m.anchor.setTo(.5,.5);xa();Va();Xa();Wa();D=new Phaser.Graphics(game);D.alpha=0;
D.beginFill(16777215);D.drawRect(0,0,game.world.width,game.world.height);D.endFill();overlayGroup.add(D);Ya();z.add(overlayGroup);Pa();Oa();game.onPause.add(function(){game.sound.mute=!0},this);game.onResume.add(function(){game.sound.mute=!1},this);Ka();T=game.add.group();z.add(T);ha=game.add.group();z.add(ha);ba("star",1);ba("wrong",1);ba("ouch",1);ba("text",2);sound.decode(assets.sounds);gamee.gameReady()}}}();