var Gamee;!function(t){var e=function(){function t(e,i){void 0===i&&(i=!1),this._game=null,this._gameeController=null,this._indices={right:1,up:2,left:4,down:8,A:16,B:32,button:64},this._pressesCache=0,this._isDown=0,this._justDown=0,this._justUp=0,this._gameRunning=!1,this._score=0,void 0!==window.gamee&&("Touch"!==e?(this._gameeController=window.gamee.controller.requestController(e,{enableKeyboard:i}),this.keyHandlers()):(this._gameeController=window.gamee.controller.requestController("Touch"),this.touchHandlers())),this.eventHandlers(),t._instance=this}return Object.defineProperty(t,"instance",{get:function(){return null===t._instance,t._instance},enumerable:!0,configurable:!0}),t.prototype.setGame=function(t){this._game=t},Object.defineProperty(t.prototype,"gameRunning",{get:function(){return this._gameRunning},enumerable:!0,configurable:!0}),t.prototype.keyHandlers=function(){var t=this;this._gameeController.on("keydown",function(e){t._pressesCache|=t._indices[e.button];var i=t._game.state.getCurrentState();"function"==typeof i.onGameeButtonDown&&i.onGameeButtonDown(e.button)}),this._gameeController.on("keyup",function(e){t._pressesCache&=~t._indices[e.button];var i=t._game.state.getCurrentState();"function"==typeof i.onGameeButtonUp&&i.onGameeButtonUp(e.button)})},t.prototype.processKeys=function(){var t=this._isDown;this._isDown=this._pressesCache;var e=t^this._isDown;this._justDown=e&this._isDown,this._justUp=e&~this._isDown},t.prototype.clearKeys=function(){this._pressesCache=0,this._isDown=0,this._justDown=0,this._justUp=0},t.prototype.isDown=function(t){return(this._isDown&this._indices[t])>0},t.prototype.justDown=function(t){return(this._justDown&this._indices[t])>0},Object.defineProperty(t.prototype,"anyIsDown",{get:function(){return this._isDown>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anyJustDown",{get:function(){return this._justDown>0},enumerable:!0,configurable:!0}),t.prototype.isUp=function(t){return!this.isDown(t)},t.prototype.justUp=function(t){return(this._justUp&this._indices[t])>0},t.prototype.touchHandlers=function(){var t=this;this._gameeController.on("touchstart",function(e){var i=t._game.state.getCurrentState();"function"==typeof i.onGameeTouchStart&&i.onGameeTouchStart(e)}),this._gameeController.on("touchend",function(e){var i=t._game.state.getCurrentState();"function"==typeof i.onGameeTouchEnd&&i.onGameeTouchEnd(e)}),this._gameeController.on("touchmove",function(e){var i=t._game.state.getCurrentState();"function"==typeof i.onGameeTouchMove&&i.onGameeTouchMove(e)}),this._gameeController.on("touchleave",function(e){var i=t._game.state.getCurrentState();"function"==typeof i.onGameeTouchLeave&&i.onGameeTouchLeave(e)}),this._gameeController.on("touchcancel",function(e){var i=t._game.state.getCurrentState();"function"==typeof i.onGameeTouchCancel&&i.onGameeTouchCancel(e)})},t.prototype.eventHandlers=function(){var t=this;window.gamee.onPause=function(){t.onPause()},window.gamee.onUnpause=function(){t.onUnpause()},window.gamee.onRestart=function(){t.onRestart()},window.gamee.onMute=function(){t._game.onMute()},window.gamee.onUnmute=function(){t._game.onUnmute()}},t.prototype.onPause=function(){var t=this._game.state.getCurrentState();"function"==typeof t.onGameePause&&t.onGameePause()},t.prototype.onUnpause=function(){var t=this._game.state.getCurrentState();"function"==typeof t.onGameeUnpause&&t.onGameeUnpause()},t.prototype.onRestart=function(){var t=this._game.state.getCurrentState();"function"==typeof t.onGameeRestart&&t.onGameeRestart()},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},set:function(t){this._score=t,window.gamee.score=t},enumerable:!0,configurable:!0}),t.prototype.addScore=function(t){this.score+=t},t.prototype.gameStart=function(){this._gameRunning||(window.gamee.gameStart(),this._gameRunning=!0)},t.prototype.gameOver=function(){this._gameRunning&&(window.gamee.gameOver(),this._gameRunning=!1)},t._instance=null,t}();t.Gamee=e}(Gamee||(Gamee={}));var Log;!function(t){var e=function(){function t(){}return t.msg=function(e){t.messages.push(e)},t.messages=[],t}();t.Log=e}(Log||(Log={}));var Helper;!function(t){var e=function(){function t(){}return t.randomizeArray=function(t,e,i,s){void 0===i&&(i=!1),void 0===s&&(s=!1);var n=i?e.slice():e;return Phaser.ArrayUtils.shuffle(n),s?n.slice(0,t):n},t.sort=function(e,i,s,n){if(void 0===s&&(s=0),void 0===n&&(n=e.length),n>s){for(var a,o=s,r=s+1;n>=r;r++)i(e[s],e[r])>0&&(a=e[++o],e[o]=e[r],e[r]=a);a=e[s],e[s]=e[o],e[o]=a,t.sort(e,i,s,o-1),t.sort(e,i,o+1,n)}},t}();t.ArrayUtils=e}(Helper||(Helper={}));var MeteoricPlus;!function(t){var e;!function(t){function e(t,e,i){var s=t*Math.PI*2*e,n=t*(2*Math.PI*i+Math.PI/2);return Math.sin(s)*Math.cos(n)}function i(t,e,i){var s=t*Math.PI*2*e,n=-t*i;return Math.sin(s)*Math.exp(n)}function s(t){return-3*t*t+4*t}function n(t){return-(s(1-t)-1)}function a(t){return Math.sin(2*t*Math.PI)}function o(t){return Math.sin(t*Math.PI)}function r(t,e){return Math.sin(2*t*Math.PI*e)}t.wiggle=e,t.sinWithExpDecay=i,t.pop5=s,t.pop5rev=n,t.sin=a,t.halfSin=o,t.sinWithPeriod=r}(e=t.Easing||(t.Easing={}))}(MeteoricPlus||(MeteoricPlus={}));var Helper;!function(t){var e=function(){function t(){}return t.create=function(e,i,s,n,a,o,r,l,h,u){return void 0===o&&(o=0),void 0===r&&(r=0),void 0===l&&(l=0),void 0===h&&(h=0),void 0===u&&(u=!1),t._image=new Phaser.Image(e,0,0,n),"string"==typeof a?t._frame=e.cache.getFrameByName(n,a):t._frame=e.cache.getFrameByIndex(n,a),t.calculateNineImage(i,s,o,r,l,h,u),t._nineImage=new Phaser.BitmapData(e,"NineImage"+t._textureKey++,t._width,t._height),t.renderNineImage(),t._nineImage},t.calculateNineImage=function(e,i,s,n,a,o,r){var l=t._frame;if(t._centralWidth=l.width-n-o,t._centralHeight=l.height-s-a,r)t._horizontalRepeats=e,t._verticalRepeats=i,t._width=n+o+t._centralWidth*e,t._height=s+a+t._centralHeight*i,t._lastWidth=0,t._lastHeight=0;else{var h=e-n-o;t._horizontalRepeats=Math.floor(h/t._centralWidth),t._lastWidth=h%t._centralWidth;var u=i-s-a;t._verticalRepeats=Math.floor(u/t._centralHeight),t._lastHeight=u%t._centralHeight,t._width=e,t._height=i}t._leftWidth=n,t._rightWidth=o,t._topHeight=s,t._bottomHeight=a},t.renderNineImage=function(){var e=t._frame.y,i=0;t._topHeight>0&&(t.renderNineImageRow(t._image,e,i,t._topHeight),e+=t._topHeight,i+=t._topHeight);for(var s=0;s<t._verticalRepeats;s++)t.renderNineImageRow(t._image,e,i,t._centralHeight),i+=t._centralHeight;t._lastHeight>0&&(t.renderNineImageRow(t._image,e,i,t._lastHeight),i+=t._lastHeight),e+=t._centralHeight,t._bottomHeight>0&&t.renderNineImageRow(t._image,e,i,t._bottomHeight)},t.renderNineImageRow=function(e,i,s,n){var a=t._frame.x,o=0;t._leftWidth>0&&(t._nineImage.copy(e,a,i,t._leftWidth,n,o,s),o+=t._leftWidth,a+=t._leftWidth);for(var r=0;r<t._horizontalRepeats;r++)t._nineImage.copy(e,a,i,t._centralWidth,n,o,s),o+=t._centralWidth;t._lastWidth>0&&(t._nineImage.copy(e,a,i,t._lastWidth,n,o,s),o+=t._lastWidth),a+=t._centralWidth,t._rightWidth>0&&t._nineImage.copy(e,a,i,t._rightWidth,n,o,s)},t._textureKey=0,t}();t.NineImage=e}(Helper||(Helper={}));var Helper;!function(t){var e;!function(t){t[t.UNDEFINED=-1]="UNDEFINED",t[t.SPACE=1]="SPACE",t[t.NEWLINE=2]="NEWLINE",t[t.CHARACTER=3]="CHARACTER"}(e||(e={}));var i=function(){function t(){}return t.hasNext=function(){return t.textPosition<t.text.length},t.getChar=function(){return t.text.charAt(t.textPosition++)},t.peekChar=function(){return t.text.charAt(t.textPosition)},t.getPosition=function(){return t.textPosition},t.setPosition=function(e){t.textPosition=e},t.getCharAdvance=function(e,i){var s=t.fontData.chars[e],n=s.xAdvance;return i>0&&s.kerning[i]&&(n+=s.kerning[i]),n},t.getCharType=function(t){return" "===t?e.SPACE:/(?:\r\n|\r|\n)/.test(t)?e.NEWLINE:e.CHARACTER},t.wrapText=function(i,s,n,a,o,r){t.text=s,t.setPosition(0),t.fontData=i.cache.getBitmapFont(o).font,void 0===r&&(r=t.fontData.size);var l=r/t.fontData.size,h=t.fontData.lineHeight*l,u=n/l,c=[],p=[],_=[],m=0,d=!0,f=0,g=0;c[m]=g,_[f++]=0;for(var v=a;t.hasNext();){for(var y=0,P=0,E=-1,S=e.UNDEFINED,T=e.UNDEFINED,C=u,M=-1;t.hasNext();){g=t.getPosition();var A=t.getChar();S=t.getCharType(A);var I=A.charCodeAt(0);if(S===e.SPACE)T!==e.SPACE&&(P=y),++y,C-=t.getCharAdvance(I,M);else if(S===e.CHARACTER){if(T!==e.CHARACTER&&(E=g),C-=t.getCharAdvance(I,M),0>C)break;++y}else if(S===e.NEWLINE){var b=!1;if(t.hasNext()&&(b=!0,P=y,E=t.getPosition(),g=E,C=-1,S=e.CHARACTER),b)break}T=S,M=I}v-=h,0>v&&(_[f++]=m),0>C&&S===e.CHARACTER?(0!==P?p[m]=P:p[m]=y,d=!1,0>v&&(d=!0,v=a-h),0!==P?(c[++m]=E,t.setPosition(E)):(c[++m]=g,t.setPosition(g))):t.hasNext()||(S===e.CHARACTER?p[m]=y:S===e.SPACE&&(p[m]=P))}_[f]=m+1;for(var x=[],w=1;f>=w;w++){for(var O=_[w-1],G=_[w],U=[],N=O;G>N;N++)U.push(t.text.substr(c[N],p[N]));x.push(U.join("\n"))}return x},t}();t.TextWrapper=i}(Helper||(Helper={}));var Particles;!function(t){var e=function(){function e(t,i){this.maxVelocity=e.MAX_VELOCITY,this._delay=0,this._velocity=new Phaser.Point(0,0),this._angularVelocity=0,this._friction=0,this._angularDrag=0,this._gravity=0,this._alpha=1,this._scaleChange=0,this._alphaChange=0,this._game=t}return Object.defineProperty(e.prototype,"visual",{get:function(){return this._visual},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"on",{set:function(t){this._on=t,this._visual.exists=t,this._visual.visible=t},enumerable:!0,configurable:!0}),e.prototype.remove=function(){var t=this._visual.parent;null!==t&&(t instanceof Phaser.Group?t.remove(this._visual):t.removeChild(this._visual),t=null)},e.prototype.bringToTop=function(){var t=this._visual.parent;t instanceof Phaser.Group&&t.bringToTop(this._visual)},e.prototype.sendToBack=function(){var t=this._visual.parent;t instanceof Phaser.Group&&t.sendToBack(this._visual)},Object.defineProperty(e.prototype,"textureKey",{set:function(t){this._textureKey=t},enumerable:!0,configurable:!0}),e.prototype.setScaleChange=function(t,e){void 0===e&&(e=0),this._scaleChangeType=t,this._scaleChange=e},Object.defineProperty(e.prototype,"delay",{set:function(t){this._delay=t,this.on=0===t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{set:function(t){this._alpha=t,this._visual.alpha=Phaser.Math.clamp(t,0,1)},enumerable:!0,configurable:!0}),e.prototype.setAlphaChange=function(t,e){void 0===e&&(e=0),this._alphaChangeType=t,this._alphaChange=e},e.prototype.setPhysics=function(t,e,i,s,n,a){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),void 0===n&&(n=0),void 0===a&&(a=0),this._velocity.setTo(t,e),this._angularVelocity=i,this._friction=s,this._angularDrag=n,this._gravity=a,this._simplePhysics=0===a&&0===s&&0===n},e.prototype.setFrame=function(t){},e.prototype.onEmit=function(t){t.add(this._visual)},e.prototype.onKill=function(t){},e.prototype.update=function(e){void 0===e&&(e=!0);var i=this._game.time.physicsElapsed;if(this._delay>0){if((this._delay-=i)>0)return!0;this.on=!0}if(this.lifetime>0&&(this.lifetime-=i)<=0)return!1;if((0!==this._velocity.x||0!==this._velocity.y)&&(this._visual.x+=this._velocity.x*i,this._visual.y+=this._velocity.y*i),0!==this._angularVelocity&&(this._visual.angle+=this._angularVelocity*i),this._simplePhysics||(this._velocity.x+=-this._friction*this._velocity.x*i,this._velocity.y+=(this._gravity-this._friction*this._velocity.y)*i,this._angularVelocity+=-this._angularDrag*this._angularVelocity*i),!e)return!0;if(this._scaleChangeType!=t.eParameterChangeType.NO_CHANGE)switch(this._scaleChangeType){case t.eParameterChangeType.IN_TIME:(this._visual.scale.x+=this._scaleChange*i)<0&&(this._visual.scale.x=0,this._scaleChange<0&&(this._scaleChangeType=t.eParameterChangeType.NO_CHANGE)),(this._visual.scale.y+=this._scaleChange*i)<0&&(this._visual.scale.y=0,this._scaleChange<0&&(this._scaleChangeType=t.eParameterChangeType.NO_CHANGE))}if(this._alphaChangeType!=t.eParameterChangeType.NO_CHANGE)switch(this._alphaChangeType){case t.eParameterChangeType.IN_TIME:this._alpha+=this._alphaChange*i,this._alpha<0?(this._visual.alpha=0,this._alphaChange<0&&(this._alphaChangeType=t.eParameterChangeType.NO_CHANGE)):this._alpha>1?(this._visual.alpha=1,this._alphaChange>0&&(this._alphaChangeType=t.eParameterChangeType.NO_CHANGE)):this._visual.alpha=this._alpha}return!0},e.MAX_VELOCITY=1e3,e}();t.Particle=e}(Particles||(Particles={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Particles;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.setFrame=function(t){var e=this._visual;"string"==typeof t?e.frameName=t:e.frame=t},e.prototype.onCreate=function(t){var e=new Phaser.Sprite(this._game,0,0,this._textureKey);e.anchor.setTo(.5,.5),this._visual=e},e}(t.Particle);t.SpriteParticle=e}(Particles||(Particles={}));var Particles;!function(t){var e=function(t){function e(e,i){t.call(this,e,i),(void 0===i||null!==i)&&(this._anims=i[0])}return __extends(e,t),e.prototype.onCreate=function(e){t.prototype.onCreate.call(this,e);for(var i=this._visual,s=0;s<this._anims.length;s++){var n=this._anims[s],a=i.animations.add(n.name,n.frames,n.frameRate,n.loop);!n.loop&&n.killOnComplete&&(a.killOnComplete=!0)}},e.prototype.update=function(e){void 0===e&&(e=!0);var i=this._delay,s=t.prototype.update.call(this,e);return i>0&&this._delay<=0&&this._visual.animations.currentAnim.play(),s},e.prototype.setFrame=function(t){this.setAnim(t)},e.prototype.setAnim=function(t){var e=this._visual;e.animations.stop(null,!0),this._delay<=0?e.animations.play(t):(e.animations.currentAnim=e.animations.getAnimation(t),e.frame=e.animations.currentAnim._frames[0])},e.prototype.setRandomAnim=function(){var t=(this._visual,this._anims[this._game.rnd.integerInRange(0,this._anims.length-1)].name);this.setAnim(t)},e}(t.SpriteParticle);t.AnimatedParticle=e}(Particles||(Particles={}));var Particles;!function(t){var e=function(){function e(e){this.area=new Phaser.Point(0,0),this.gravity=0,this.minLifetime=1,this.maxLifetime=1,this.delay=0,this.minScale=1,this.maxScale=1,this.scaleChange=0,this.scaleChangeType=t.eParameterChangeType.NO_CHANGE,this.minAngle=0,this.maxAngle=0,this.minSpeedX=0,this.maxSpeedX=0,this.minSpeedY=0,this.maxSpeedY=0,this.friction=0,this.minAngularSpeed=0,this.maxAngularSpeed=0,this.angularDrag=0,this.minAlpha=1,this.maxAlpha=1,this.alphaChange=0,this.alphaChangeType=t.eParameterChangeType.NO_CHANGE,this.frames=null,this._minAdvScale=new Phaser.Point(1,1),this._maxAdvScale=new Phaser.Point(1,1),this._game=e}return e.readParams=function(t,i){var s={};for(var n in i){var a=new e(t);e.doReadParams(a,i,n),s[n]=a}return s},e.doReadParams=function(t,i,s){var n=i[s];if("undefined"!=typeof n.parent&&null!==n.parent){var a=n.parent;e.doReadParams(t,i,a)}for(var o in n)"parent"!==o&&("undefined"==typeof t[o],t[o]=n[o])},e.prototype.clear=function(){this.gravity=0,this.setXSpeed(0,0),this.setYSpeed(0,0),this.setAngularSpeed(0)},e.prototype.randomFrame=function(){var t=null;return null!==this.frames&&(t=Array.isArray(this.frames)?"string"==typeof this.frames[0]?this._game.rnd.pick(this.frames):this._game.rnd.pick(this.frames):this.frames),t},e.prototype.setXSpeed=function(t,e){t=t||0,e=e||0,this.minSpeedX=t,this.maxSpeedX=e},e.prototype.setYSpeed=function(t,e){t=t||0,e=e||0,this.minSpeedY=t,this.maxSpeedY=e},e.prototype.setAngularSpeed=function(t,e){t=t||0,e=e||0,this.minAngularSpeed=t,this.maxAngularSpeed=e},e.prototype.setAlpha=function(t,e){void 0===t&&(t=1),void 0===e&&(e=1),this.minAlpha=t,this.maxAlpha=e},e.prototype.setAlphaChange=function(e,i,s){switch(void 0===i&&(i=0),void 0===s&&(s=0),this.alphaChangeType=e,e){case t.eParameterChangeType.NO_CHANGE:this.alphaChange=0;break;case t.eParameterChangeType.IN_TIME:0===s&&(s=1),this.alphaChange=i/s}},e.prototype.setScale=function(t,e){t=t||0,e=e||0,this.minScale=t,this.maxScale=e},Object.defineProperty(e.prototype,"advScaleMin",{get:function(){return this._minAdvScale},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"advScaleMax",{get:function(){return this._maxAdvScale},enumerable:!0,configurable:!0}),e.prototype.setAdvScale=function(t,e,i,s){void 0===t&&(t=1),void 0===e&&(e=1),void 0===i&&(i=1),void 0===s&&(s=1),this._minAdvScale.setTo(t,i),this._maxAdvScale.setTo(e,s)},e.prototype.setScaleChange=function(e,i,s){switch(void 0===i&&(i=0),void 0===s&&(s=0),this.scaleChangeType=e,e){case t.eParameterChangeType.NO_CHANGE:this.scaleChange=0;break;case t.eParameterChangeType.IN_TIME:0===s&&(s=1),this.scaleChange=i/s}},e.prototype.setAngle=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.minAngle=t,this.maxAngle=e},e}();t.ParticleParams=e}(Particles||(Particles={}));var Particles;!function(t){var e;!function(t){t[t.NONE=0]="NONE",t[t.FLOW=1]="FLOW",t[t.EXPLODE=2]="EXPLODE"}(e||(e={})),function(t){t[t.NO_CHANGE=0]="NO_CHANGE",t[t.IN_TIME=1]="IN_TIME"}(t.eParameterChangeType||(t.eParameterChangeType={}));var i=t.eParameterChangeType,s=function(s){function n(i,a,o,r){s.call(this,i,null),this._maxParticles=n.MAX_PARTICELES,this.emitPoint=new Phaser.Point(0,0),this.emitObject=null,this.particleClass=t.SpriteParticle,this.particleBringToTop=!1,this.particleSendToBack=!1,this.frequency=100,this.forceEmit=!1,this._alternativeParams=null,this._on=!1,this._mode=e.NONE,this._flowQuantity=0,this._flowTotal=0,this._flowCounter=0,this._particlesPool=[],this._counterPool=0,this._particlesUsed=[],this._counterUsed=0,this._timer=0,this._emitPoint=new Phaser.Point(0,0),this._params=new t.ParticleParams(i),this.position.setTo(a,o),this._maxParticles=r}return __extends(n,s),Object.defineProperty(n.prototype,"params",{set:function(t){this._params=t},enumerable:!0,configurable:!0}),n.prototype.clear=function(){this._params.clear()},n.prototype.update=function(){if(this._on&&this.game.time.time>=this._timer&&(this._timer=this.game.time.time+this.frequency*this.game.time.slowMotion,this._mode===e.FLOW))if(-1!==this._flowTotal&&this._flowCounter>=this._flowTotal)this.on=!1;else for(var t=Math.max(1,this._flowQuantity),i=0;t>i&&!(this.emitParticle(this.forceEmit)&&(this._flowCounter++,-1!==this._flowTotal&&this._flowCounter>=this._flowTotal));i++);for(var i=this._counterUsed-1;i>=0;i--){var s=this._particlesUsed[i];s.update()||(s.on=!1,s.remove(),s.onKill(this),this._particlesUsed[i]=this._particlesUsed[--this._counterUsed],this._particlesPool[this._counterPool++]=s)}},n.prototype.makeParticles=function(t,e,i,s){(void 0===i||i>this._maxParticles)&&(i=this._maxParticles),void 0!==e&&(this._params.frames=e);for(var n=0;i>n;n++){var a=new this.particleClass(this.game,s);a.textureKey=t,a.onCreate(this),a.on=!1,this._particlesPool[this._counterPool++]=a}},Object.defineProperty(n.prototype,"on",{set:function(t){this._on=t,this.exists=t,this.visible=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"count",{get:function(){return this._counterUsed},enumerable:!0,configurable:!0}),n.prototype.explode=function(t,i,s){this._mode=e.EXPLODE,this.on=!0,this.emitParticles(t,i,s)},n.prototype.flow=function(t,i,s,n,a,o){this._mode=e.FLOW,this.on=!0,(void 0===i||0===i)&&(i=1),void 0===s&&(s=-1),void 0===n&&(n=!0),i>this._maxParticles&&(i=this._maxParticles),this.frequency=t,this._flowCounter=0,this._flowQuantity=i,this._flowTotal=s,n&&(this.emitParticles(i,a,o),this._flowCounter+=i,this._timer=this.game.time.time+t*this.game.time.slowMotion)},n.prototype.stopFlow=function(){this._mode=e.NONE},n.prototype.killAllParticles=function(t){for(void 0===t&&(t=!0);this._counterUsed>0;){var e=this._particlesUsed[--this._counterUsed];e.remove(),t||e.onKill(this),this._particlesPool[this._counterPool++]=e}},n.prototype.emitParticles=function(t,e,i){for(var s=0;t>s;s++){var n=this.emitParticle(this.forceEmit);if(null===n)break;void 0!==e&&null!==e&&e.call(i,n)}},n.prototype.emitParticle=function(t,e){if(void 0===t&&(t=!1),void 0===e&&(e=!1),0===this._counterPool){if(!t)return null;var s=this._particlesUsed[0];this._particlesUsed[0]=this._particlesUsed[--this._counterUsed],s.remove(),s.onKill(this),this._particlesPool[this._counterPool++]=s}var n=this._particlesPool[--this._counterPool];this._particlesUsed[this._counterUsed++]=n,n.on=!0;var a=null!==this._alternativeParams?this._alternativeParams:this._params;if(this.randomEmitPoint(this._emitPoint,a),n.visual.position.set(this._emitPoint.x,this._emitPoint.y),n.visual.angle=0,e)n.lifetime=-1,n.visual.scale.set(1,1),n.setScaleChange(i.NO_CHANGE),n.visual.angle=0,n.alpha=1,n.setAlphaChange(i.NO_CHANGE),n.setPhysics();else{if(n.lifetime=this.game.rnd.realInRange(a.minLifetime,a.maxLifetime),n.delay=a.delay,1!==a.minScale||1!==a.maxScale){var o=this.game.rnd.realInRange(a.minScale,a.maxScale);n.visual.scale.set(o,o)}else a.advScaleMin.x!==a.advScaleMax.x||a.advScaleMin.y!==a.advScaleMax.y?n.visual.scale.set(this.game.rnd.realInRange(a.advScaleMin.x,a.advScaleMax.x),this.game.rnd.realInRange(a.advScaleMin.y,a.advScaleMax.y)):n.visual.scale.set(1,1);n.setScaleChange(a.scaleChangeType,a.scaleChange),n.visual.angle=a.minAngle===a.maxAngle?a.minAngle:this.game.rnd.realInRange(a.minAngle,a.maxAngle),n.alpha=this.game.rnd.realInRange(a.minAlpha,a.maxAlpha),n.setAlphaChange(a.alphaChangeType,a.alphaChange),n.setPhysics(this.game.rnd.realInRange(a.minSpeedX,a.maxSpeedX),this.game.rnd.realInRange(a.minSpeedY,a.maxSpeedY),this.game.rnd.realInRange(a.minAngularSpeed,a.maxAngularSpeed),a.friction,a.angularDrag,a.gravity),null!==a.frames&&n.setFrame(a.randomFrame())}return n.onEmit(this),this.particleBringToTop?n.bringToTop():this.particleSendToBack&&n.sendToBack(),n},n.prototype.destroy=function(){t.ParticlesManager.instance.remove(this),s.prototype.destroy.call(this,!0,!1)},n.prototype.randomEmitPoint=function(t,e){return e.area instanceof Phaser.Point?t.setTo(0,0):e.area.random(t),t.x+=this.emitPoint.x,t.y+=this.emitPoint.y,null!==this.emitObject&&(t.x+=this.emitObject.x,t.y+=this.emitObject.y),t},Object.defineProperty(n.prototype,"area",{set:function(t){this._params.area=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"gravity",{set:function(t){this._params.gravity=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"friction",{set:function(t){this._params.friction=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"angularDrag",{set:function(t){this._params.angularDrag=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"minScale",{set:function(t){this._params.minScale=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxScale",{set:function(t){this._params.maxScale=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"minAngle",{set:function(t){this._params.minAngle=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxAngle",{set:function(t){this._params.maxAngle=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"delay",{set:function(t){this._params.delay=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"lifetime",{set:function(t){this._params.minLifetime=this._params.maxLifetime=t},enumerable:!0,configurable:!0}),n.prototype.setXSpeed=function(t,e){this._params.setXSpeed(t,e)},n.prototype.setYSpeed=function(t,e){this._params.setYSpeed(t,e)},n.prototype.setAngularSpeed=function(t,e){this._params.setAngularSpeed(t,e)},n.prototype.setAlpha=function(t,e){this._params.setAlpha(t,e)},n.prototype.setAlphaChange=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0),this._params.setAlphaChange(t,e,i)},n.prototype.setScale=function(t,e){this._params.setScale(t,e)},n.prototype.setAdvScale=function(t,e,i,s){this._params.setAdvScale(t,e,i,s)},n.prototype.setScaleChange=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0),this._params.setScaleChange(t,e,i)},n.prototype.setAngle=function(t,e){this._params.setAngle(t,e)},n.prototype.emitAt=function(t,e){this.emitPoint.setTo(t,e)},n.prototype.emitAtObject=function(t){t.center?this.emitPoint.setTo(t.center.x,t.center.y):this.emitPoint.setTo(t.x,t.y)},n.MAX_PARTICELES=16,n}(Phaser.Group);t.ParticlesEmitter=s}(Particles||(Particles={}));var Particles;!function(t){var e=function(){function t(t,e,i,s){void 0===i&&(i=null),void 0===s&&(s=null),this._emitter=null,this._game=t,this._emitter=e,this._animEmitter=i,this._params=s}return t.prototype.emit=function(t,e,i,s,n){for(this._emitter.emitAt(t,e),null!==this._animEmitter&&this._animEmitter.emitAt(t,e);null!==i;){var a=i.animated?this._animEmitter:this._emitter;if(null===this._params&&null!==i.paramsName,null!==this._params){var o=this._params[i.paramsName];"undefined"==typeof o||(a.params=o)}a.explode(this._game.rnd.integerInRange(i.countMin,i.countMax),s,n),i=i.next}},t}();t.ParticleChain=e}(Particles||(Particles={}));var Particles;!function(t){var e=function(){function t(){this._emitters=[],this._emittersCount=0}return Object.defineProperty(t,"instance",{get:function(){return null===t._instance&&(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.add=function(t){this._emitters[this._emittersCount++]=t},t.prototype.remove=function(t){for(var e=this._emittersCount-1;e>=0&&this._emitters[e]!==t;e--);-1!==e&&(this._emitters[e]=this._emitters[--this._emittersCount])},t.prototype.update=function(){for(var t=0;t<this._emittersCount;t++){var e=this._emitters[t];e.exists&&e.update()}},t._instance=null,t}();t.ParticlesManager=e}(Particles||(Particles={}));var MeteoricPlus;!function(t){var e=function(){function t(){}return t.INITIAL_TYPES_COUNT=3,t.MAX_TYPES_COUNT=6,t.INITIAL_BLOCKS_COUNT=16,t.MATCH_LENGTH=2,t.MOVES_FOR_TRASH=12,t.SUNS_FOR_COLOR=7,t.MAX_SCORE_STREAK=5,t.MOVE_DURATION=.1,t.MERGE_DURATION=.4,t.SUN_EXPLODE_TIME=1,t.TITLES=["Streak!","Amazing!","Spacetacular!","GAME OVER"],t.TITLE_MILESTONE_1=3,t.TITLE_MILESTONE_2=5,t.TITLE_MILESTONE_3=7,t}();t.Gameplay=e}(MeteoricPlus||(MeteoricPlus={}));var MeteoricPlus;!function(t){var e=function(){function t(t,e,i){void 0===i&&(i=null),this.name="<no name>",this.debug=0,this._newFunction=null,this._count=0,this._pool=[],this._canGrow=!0,this._poolSize=0,this._classType=t,this._newFunction=i;for(var s=0;e>s;s++){var n=this.newItem();this._pool[this._count++]=n}this._poolSize=e}return t.prototype.createItem=function(){return 0===this._count?((this.debug&t.DEBUG_ALLOCATION)>0,this._canGrow?this.newItem():null):((this.debug&t.DEBUG_CREATE)>0,this._pool[--this._count])},t.prototype.destroyItem=function(e){(this.debug&t.DEBUG_DESTROY)>0,this._pool[this._count++]=e},Object.defineProperty(t.prototype,"newFunction",{set:function(t){this._newFunction=t},enumerable:!0,configurable:!0}),t.prototype.newItem=function(){return null!==this._newFunction?this._newFunction():new this._classType},Object.defineProperty(t.prototype,"canGrow",{set:function(t){this._canGrow=t},enumerable:!0,configurable:!0}),t.DEBUG_ALLOCATION=1,t.DEBUG_CREATE=2,t.DEBUG_DESTROY=4,t.DEBUG_ALL=7,t}();t.Pool=e}(MeteoricPlus||(MeteoricPlus={}));var MeteoricPlus;!function(t){var e=function(t){function e(e,i,s,n,a){t.call(this,e,i,s,n),void 0!==a&&this.setAnchoredFrame(a)}return __extends(e,t),e.prototype.setAnchoredFrame=function(t){if("string"==typeof this.key){var e=null;"string"==typeof t?(this.frameName=t,e=this.game.cache.getFrameByName(this.key,t)):(this.frame=t,e=this.game.cache.getFrameByIndex(this.key,t)),void 0!==e.anchorX&&void 0!==e.anchorY&&this.anchor.setTo(e.anchorX,e.anchorY)}},e}(Phaser.Sprite);t.AnchoredSprite=e}(MeteoricPlus||(MeteoricPlus={}));var MeteoricPlus;!function(t){var e=function(e){function i(s){e.call(this,s,null),this._oldPosition=new Phaser.Point,this._targetPosition=new Phaser.Point,this._under=new Phaser.Sprite(s,0,0,"Sprites",0),this._under.anchor.set(.5,.5),this._sprite=s.add.sprite(0,0,"Sprites",0,this),this._sprite.anchor.set(.5,.5),this._over=new Phaser.Sprite(s,0,0,"Sprites",0),this._over.anchor.set(.5,.5),this._mergeTween1=s.add.tween(this.scale).to({x:1.15},i.TWEEN_TIME,t.Easing.halfSin,!1),this._mergeTween2=s.add.tween(this.scale).to({y:.9},i.TWEEN_TIME,t.Easing.halfSin,!1),this._popTween=s.add.tween(this.scale).to({x:1,y:1},i.TWEEN_TIME,t.Easing.pop5,!1)}return __extends(i,e),i.prototype.clear=function(){this._under.parent===this&&this.remove(this._under),this._over.parent===this&&this.remove(this._over)},i.prototype.bounce=function(){this._mergeTween1.start(),this._mergeTween2.start()},i.prototype.pop=function(){this.scale.set(.5,.5),this._popTween.start()},i.prototype.setVisual=function(){var e=this._sprite;this.scale.set(1,1),this._under.scale.set(1,1),this._over.scale.set(1,1);var i=!0,s=!0;this.type<=2?e.frameName=t.BlockTypes.SPRITE_DEFS[this.type][this.value]:3===this.type?(e.frameName=t.BlockTypes.SUN,this._over.exists=this._over.visible=!0,this._over.frameName="slunecni_zare",this._over.parent!==this&&(this.add(this._over),this.bringToTop(this._over)),i=!1):4===this.type?e.frameName=t.BlockTypes.SPACESHIP_TYPES[this.value]:5===this.type&&(e.frameName=t.BlockTypes.BLACKHOLE_TYPES[0]),i&&this._over.parent===this&&this.remove(this._over),s&&this._under.parent===this&&this.remove(this._under)},i.prototype.getVisualFrame=function(){return this._sprite.frameName},i.prototype.setValues=function(t,e,s,n){this.gridX=t,this.gridY=e,this.value=s,this.type=n,this.destroyOnMerge=!1,this.bounceOnMerge=!1,this._moveTime=0,this.position.set(this.gridX*i.BLOCK_SIZE+i.BLOCK_SIZE/2,this.gridY*i.BLOCK_SIZE+i.BLOCK_SIZE/2)},i.prototype.setNewPosition=function(e,s){var n=this.gridX,a=this.gridY;this.gridX=e,this.gridY=s,this._oldPosition.copyFrom(this.position),this._targetPosition.set(this.gridX*i.BLOCK_SIZE+i.BLOCK_SIZE/2,this.gridY*i.BLOCK_SIZE+i.BLOCK_SIZE/2),this._moveTime=Math.max(Math.abs(n-e),Math.abs(a-s))*t.Gameplay.MOVE_DURATION,this._moveTimeTotal=this._moveTime},Object.defineProperty(i.prototype,"moveTime",{get:function(){return this._moveTime},set:function(t){this._moveTime=t,this._moveTimeTotal=t},enumerable:!0,configurable:!0}),i.prototype.updatePosition=function(t){if(0===this._moveTime)return!1;this._moveTime=Math.max(this._moveTime-t,0);var e=this._moveTime/this._moveTimeTotal;return this.position.set(Phaser.Math.linear(this._targetPosition.x,this._oldPosition.x,e),Phaser.Math.linear(this._targetPosition.y,this._oldPosition.y,e)),!0},i.prototype.updateEffects=function(t){3===this.type&&this._over.scale.set(t,t)},i.prototype.clearMatchCount=function(){this.matchCount=0},Object.defineProperty(i.prototype,"isBasic",{get:function(){return this.type<=3},enumerable:!0,configurable:!0}),i.prototype.equals=function(t){return this.value===t.value&&this.type===t.type},i.BLOCK_SIZE=128,i.TWEEN_TIME=200,i}(Phaser.Group);t.Block=e}(MeteoricPlus||(MeteoricPlus={}));var MeteoricPlus;!function(t){var e=function(){function t(){this.blocks=[],this.length=0}return t.prototype.clear=function(){this.length=0},t.prototype.add=function(t){this.blocks[this.length++]=t},t}();t.BlockChain=e}(MeteoricPlus||(MeteoricPlus={}));var MeteoricPlus;!function(t){var e=function(){function t(){}return t.DEBRIS_TYPES=["bordel_A","bordel_B","bordel_C","bordel_D","bordel_E","bordel_F"],t.ASTEROID_TYPES=["asteroid_A","asteroid_B","asteroid_C","asteroid_D","asteroid_E","asteroid_F"],t.PLANET_TYPES=["planeta_A","planeta_B","planeta_C","planeta_D","planeta_E","planeta_F"],t.SUN="slunce",t.SPACESHIP_TYPES=["satelit","sputnik","ufo"],t.BLACKHOLE_TYPES=["cerna_dira"],t.SPRITE_DEFS=[t.DEBRIS_TYPES,t.ASTEROID_TYPES,t.PLANET_TYPES,t.SUN,t.SPACESHIP_TYPES,t.BLACKHOLE_TYPES],t}();t.BlockTypes=e}(MeteoricPlus||(MeteoricPlus={}));var MeteoricPlus;!function(t){var e=function(e){function i(s,n,a){e.call(this,s,n),this.onGameOver=new Phaser.Signal,this.onAddScore=new Phaser.Signal,this._clearCells=[],this._foundChains=[],this._mergeBlocks=[],this._sunsToExplode=[],this._hlpPoint=new Phaser.Point,this._emitters=a,this._blocksPool=new t.Pool(t.Block,i.WIDTH*i.HEIGHT,function(){return new t.Block(s)}),this._blocks=this.createEmptyBoard(),
this.reset()}return __extends(i,e),i.prototype.reset=function(){this._emitters.reset(),this.randomizeTypes();for(var e=0;e<i.HEIGHT;e++)for(var s=0;s<i.WIDTH;s++){var n=this._blocks[e][s];null!==n&&(n.clear(),this._blocksPool.destroyItem(n),this._blocks[e][s]=null)}this._planetsCount=t.Gameplay.INITIAL_TYPES_COUNT,this._sunsExploded=0,this._boardMoves=0,this._matchesCount=0;for(var a=0;a<t.Gameplay.INITIAL_BLOCKS_COUNT;a++)this.spawnBlock(!1,!0,!1);this._state=1},i.prototype.update=function(){var t=this.game.time.time%i.SUNSHINE_SPEED/i.SUNSHINE_SPEED,e=Math.sin(Math.PI*t);e=1-.1*e;for(var s=0;s<i.HEIGHT;s++)for(var n=0;n<i.WIDTH;n++){var a=this._blocks[s][n];null!==a&&a.updateEffects(e)}},i.prototype.updateBoard=function(){switch(this._state){case 1:break;case 2:this.updateMove()||(this._state=3);break;case 3:var e=this.findGroups();(this._moved||e>0)&&this.increaseMoves(),0===e?(this._moved&&(this._matchesCount=0),this._moved?this._state=6:this._state=1):(this.removeChains(),this._state=4);break;case 4:this.updateMerge()||(this._sunsToExplodeCount>0?(this._waitCounter=this.explodeSuns(),this._state=5):this._state=6);break;case 5:(this._waitCounter-=this.game.time.physicsElapsed)<=0&&(this._state=6);break;case 6:this.spawnBlock(!0,!0,this._boardMoves%t.Gameplay.MOVES_FOR_TRASH===0),this.possibleMoves()?this._state=1:(this.game.time.events.add(500,function(){this.explodeAll(),this.onGameOver.dispatch()},this),this._state=7);break;case 7:}},i.prototype.createEmptyBoard=function(){for(var t=[],e=0;e<i.HEIGHT;e++){for(var s=[],n=0;n<i.WIDTH;n++)s[n]=null;t[e]=s}return t},i.prototype.possibleMoves=function(){for(var t=0;t<i.HEIGHT;t++)for(var e=0;e<i.WIDTH;e++){var s=this._blocks[t][e];if(null!==s&&s.type<4){var n=e<i.WIDTH-1?this._blocks[t][e+1]:null,a=t<i.HEIGHT-1?this._blocks[t+1][e]:null;if(null!==n&&n.equals(s)||null!==a&&a.equals(s))return!0}else if(null===s)return!0}return!1},i.prototype.randomizeTypes=function(){for(var t=[],e=0;e<i.BLOCK_TYPES;e++)t[e]=e;this._blockTypes=Helper.ArrayUtils.randomizeArray(i.BLOCK_TYPES,t)},i.prototype.getRandomClearCell=function(){this._clearCellsCount=0;for(var t=0;t<i.HEIGHT;t++)for(var e=0;e<i.WIDTH;e++)null===this._blocks[t][e]&&(this._clearCells[this._clearCellsCount++]=256*t+e);if(0===this._clearCellsCount)return this._hlpPoint.set(-1,-1),this._hlpPoint;var s=this._clearCells[this.game.rnd.integerInRange(0,this._clearCellsCount-1)];return this._hlpPoint.set(255&s,Math.floor(s/256)),this._hlpPoint},i.prototype.spawnBlock=function(e,i,s){var n=this.getRandomClearCell();if(-1===n.x)return this.game.time.events.add(500,function(){this.explodeAll(),this.onGameOver.dispatch()},this),null;var a=n.x,o=n.y,r=this._blocksPool.createItem();if(this.add(r),this._blocks[o][a]=r,r.clear(),s)r.setValues(a,o,this.game.rnd.integerInRange(0,t.BlockTypes.SPACESHIP_TYPES.length-1),4);else if(r.setValues(a,o,this._blockTypes[this.game.rnd.integerInRange(0,this._planetsCount-1)],this.game.rnd.integerInRange(1,e?1:2)),i){this._foundChainsCount=0;var l=this.getFreeChain();for(this.clearMatchCount(),l.clear();this.findGroupRecursively(a,o,r,l)>=t.Gameplay.MATCH_LENGTH;)this.clearMatchCount(),l.clear(),r.value=this._blockTypes[this.game.rnd.integerInRange(0,this._planetsCount-1)],r.type=this.game.rnd.integerInRange(1,e?1:2)}return r.setVisual(),e&&r.pop(),r},i.prototype.getFreeChain=function(){this._foundChainsCount>=this._foundChains.length&&(this._foundChains[this._foundChainsCount]=new t.BlockChain);var e=this._foundChains[this._foundChainsCount++];return e.clear(),e},i.prototype.increaseMoves=function(){++this._boardMoves,this._planetsCount=this._sunsExploded<t.Gameplay.SUNS_FOR_COLOR?t.Gameplay.INITIAL_TYPES_COUNT:t.Gameplay.INITIAL_TYPES_COUNT+1},i.prototype.moveBoard=function(t){if(1===this._state){this._moved=!1,this._moveDir=t;var e=!1;if(0===t)for(var s=0;s<i.HEIGHT;s++)for(var n=1;n<i.WIDTH;n++){var a=this.moveBlock(n,s,-1,0);e=e||a}else if(1===t)for(var n=0;n<i.WIDTH;n++)for(var s=1;s<i.HEIGHT;s++){var a=this.moveBlock(n,s,0,-1);e=e||a}else if(2===t)for(var s=0;s<i.HEIGHT;s++)for(var n=i.WIDTH-2;n>=0;n--){var a=this.moveBlock(n,s,1,0);e=e||a}else if(3===t)for(var n=0;n<i.WIDTH;n++)for(var s=i.HEIGHT-2;s>=0;s--){var a=this.moveBlock(n,s,0,1);e=e||a}e&&(this._moved=!0,Utils.AudioUtils.playSound("Fall")),this._state=2}},i.prototype.moveBlock=function(t,e,i,s){var n=this._blocks[e][t];if(null!==n){this._blocks[e][t]=null;for(var a=t,o=e;this.isOnBoard(a+i,o+s)&&null===this._blocks[o+s][a+i];)a+=i,o+=s;return this._blocks[o][a]=n,a!==t||o!==e?(n.setNewPosition(a,o),!0):!1}},i.prototype.isOnBoard=function(t,e){return t>=0&&t<i.WIDTH&&e>=0&&e<i.HEIGHT},i.prototype.updateMove=function(){for(var t=!1,e=this.game.time.physicsElapsed,s=!1,n=0;n<i.HEIGHT;n++)for(var a=0;a<i.WIDTH;a++){var o=this._blocks[n][a];if(null!==o){var r=o.moveTime,l=o.updatePosition(e);t=t||l,!s&&r>0&&0===o.moveTime&&(0===o.type?Utils.AudioUtils.playSound("TrashImpact"):Utils.AudioUtils.playSound("Impact"),s=!0)}}return t},i.prototype.updateMerge=function(){for(var e=this.game.time.physicsElapsed,i=this._mergeBlocksCount-1;i>=0;i--){var s=this._mergeBlocks[i];s.updatePosition(e)||(this._mergeBlocks[i]=this._mergeBlocks[--this._mergeBlocksCount],s.bounceOnMerge&&s.bounce(),s.destroyOnMerge?(this.remove(s),s.clear(),this._blocksPool.destroyItem(s)):(++this._matchesCount,this._emitters.streak(s,this._matchesCount),Utils.AudioUtils.playSound("Streak"),this._matchesCount===t.Gameplay.TITLE_MILESTONE_1?(this._emitters.title(t.Gameplay.TITLES[0]),Utils.AudioUtils.playSound("SmallCheer")):this._matchesCount===t.Gameplay.TITLE_MILESTONE_2?(this._emitters.title(t.Gameplay.TITLES[1]),Utils.AudioUtils.playSound("SmallCheer")):this._matchesCount===t.Gameplay.TITLE_MILESTONE_3&&(this._emitters.title(t.Gameplay.TITLES[2]),Utils.AudioUtils.playSound("BigCheer")),s.type<=2?(++s.type,s.value=3!==s.type?s.value:0,s.setVisual()):3===s.type&&(s.sunLevel=1,this._sunsToExplode[this._sunsToExplodeCount++]=s)))}return this._mergeBlocksCount>0},i.prototype.iterateBlocks=function(t){for(var e=0;e<i.HEIGHT;e++)for(var s=0;s<i.WIDTH;s++){var n=this._blocks[e][s];null!==n&&t(n)}},i.prototype.clearMatchCount=function(){this.iterateBlocks(function(t){t.clearMatchCount()})},i.prototype.findGroups=function(){this._foundChainsCount=0,this.clearMatchCount();for(var e=this.getFreeChain(),s=0;s<i.HEIGHT;s++)for(var n=0;n<i.WIDTH;n++){var a=this._blocks[s][n];if(null!==a&&a.isBasic&&0===a.matchCount)if(this.findGroupRecursively(n,s,a,e)>=t.Gameplay.MATCH_LENGTH){var o=10;2===a.type?o=20:3===a.type&&(o=30),o*=Math.min(this._matchesCount+1,t.Gameplay.MAX_SCORE_STREAK),this.onAddScore.dispatch(o),e=this.getFreeChain()}else{for(var r=0;r<e.length;r++)e.blocks[r].matchCount=0;e.clear()}}return e.length<t.Gameplay.MATCH_LENGTH&&--this._foundChainsCount,this._foundChainsCount},i.prototype.findGroupRecursively=function(t,e,s,n){if(0>t||t>=i.WIDTH||0>e||e>=i.HEIGHT)return n.length;var a=this._blocks[e][t];return null!==a&&0===a.matchCount&&a.equals(s)&&(n.add(a),a.matchCount=1,0===this._moveDir||2===this._moveDir?(this.findGroupRecursively(t-1,e,a,n),this.findGroupRecursively(t+1,e,a,n)):(1===this._moveDir||3===this._moveDir)&&(this.findGroupRecursively(t,e-1,a,n),this.findGroupRecursively(t,e+1,a,n))),n.length},i.prototype.removeChains=function(){var e=!1;this._mergeBlocksCount=0,this._sunsToExplodeCount=0;for(var i=0;i<this._foundChainsCount;i++)for(var s=this._foundChains[i],n=this.getChainMainBlock(s),a=0;a<s.length;a++){var o=s.blocks[a];1===o.type?Utils.AudioUtils.playSound("MatchAsteroid"):2===o.type?Utils.AudioUtils.playSound("MatchPlanet"):3===o.type&&Utils.AudioUtils.playSound("MatchSun"),o===n&&this.explodeSpaceships(o),o!==n?(o.destroyOnMerge=!0,this._blocks[o.gridY][o.gridX]=null):o.bounceOnMerge=!0,o.setNewPosition(n.gridX,n.gridY),o.moveTime=t.Gameplay.MERGE_DURATION,this._mergeBlocks[this._mergeBlocksCount++]=o,e=!0}return e},i.prototype.getChainMainBlock=function(t){for(var e=t.blocks[0],i=0;i<t.length;i++){var s=t.blocks[i];0===this._moveDir?s.gridX<e.gridX&&(e=s):1===this._moveDir?s.gridY<e.gridY&&(e=s):2===this._moveDir?s.gridX>e.gridX&&(e=s):3===this._moveDir&&s.gridY>e.gridY&&(e=s)}return e},i.prototype.explodeSpaceships=function(t){this.explodeSpaceship(t.gridX,t.gridY+1),this.explodeSpaceship(t.gridX-1,t.gridY),this.explodeSpaceship(t.gridX+1,t.gridY),this.explodeSpaceship(t.gridX,t.gridY-1)},i.prototype.explodeSpaceship=function(t,e){if(!(0>t||t>=i.WIDTH||0>e||e>=i.HEIGHT)){var s=this._blocks[e][t];null!==s&&4===s.type&&(this._emitters.debris(s,1),this._blocks[e][t]=null,this.remove(s),s.clear(),this._blocksPool.destroyItem(s))}},i.prototype.isSunOnList=function(t){for(var e=0;e<this._sunsToExplodeCount;e++)if(this._sunsToExplode[e]===t)return!0;return!1},i.prototype.explodeSuns=function(){for(var e=t.Gameplay.SUN_EXPLODE_TIME+t.Gameplay.SUN_EXPLODE_TIME/2,s=0;s<this._sunsToExplodeCount;s++){var n=this._sunsToExplode[s];this._emitters.sunExplosion(n),Utils.AudioUtils.playSound("Explosion"),++this._sunsExploded;for(var a=n.gridX,o=n.gridY,r=o-1;o+1>=r;r++)if(!(0>r||r>=i.HEIGHT))for(var l=a-1;a+1>=l;l++)if(!(0>l||l>=i.WIDTH||l!==a&&r!==o)){var h=this._blocks[r][l];if(null!==h){var u=!1;(l!==a||r!==o)&&(3!==h.type?this._emitters.debris(h,n.sunLevel):this.isSunOnList(h)||(h.sunLevel=n.sunLevel+1,this._sunsToExplode[this._sunsToExplodeCount++]=h,u=!0,e=t.Gameplay.SUN_EXPLODE_TIME*h.sunLevel+t.Gameplay.SUN_EXPLODE_TIME/2)),u||(this._blocks[r][l]=null,this.remove(h),h.clear(),this._blocksPool.destroyItem(h))}}}return e},i.prototype.explodeAll=function(){Utils.AudioUtils.playSound("Explosion"),Utils.AudioUtils.playSound("Explosion"),this._emitters.simpleSunExplosion(320,320),this._emitters.title(t.Gameplay.TITLES[3]);for(var e=this._hlpPoint,s=0;s<i.HEIGHT;s++)for(var n=0;n<i.WIDTH;n++){var a=this._blocks[s][n];if(null!==a){e.set(a.x-320,a.y-320);var o=900-e.getMagnitude();e.normalize(),e.add(this.game.rnd.realInRange(-.1,.1),this.game.rnd.realInRange(-.1,.1)),e.setMagnitude(o),this._emitters.debrisExplosion(a,e.x,e.y),this._blocks[s][n]=null,this.remove(a),a.clear(),this._blocksPool.destroyItem(a)}}},i.WIDTH=5,i.HEIGHT=5,i.BLOCK_TYPES=6,i.SUNSHINE_SPEED=2e3,i}(Phaser.Group);t.Board=e}(MeteoricPlus||(MeteoricPlus={}));var MeteoricPlus;!function(t){var e=function(e){function i(s,n){e.call(this,s,n);var a=new Particles.ParticlesEmitter(s,0,0,i.DEBRIS_PARTICLES);a.gravity=2e3,a.lifetime=5,a.setXSpeed(-50,50),a.setYSpeed(-400,-600),a.setAngularSpeed(-45,45),a.makeParticles("Sprites",null,i.DEBRIS_PARTICLES),this.add(a),this._debris=a,a=new Particles.ParticlesEmitter(s,0,0,i.DEBRIS_PARTICLES),a.particleClass=Particles.AnimatedParticle,a.lifetime=.75,a.makeParticles("Sprites",null,i.DEBRIS_PARTICLES,[i.ANIM]),this.add(a),this._explosions=a,a=new Particles.ParticlesEmitter(s,0,0,i.STREAK_PARTICLES),a.particleClass=t.TextParticle,a.lifetime=i.STREAK_LIFETIME,a.setYSpeed(-100,-100),a.delay=i.STREAK_DELAY,a.makeParticles("",null,i.STREAK_PARTICLES,[64]),a.setAlphaChange(Particles.eParameterChangeType.IN_TIME,-1,i.STREAK_LIFETIME),a.setScaleChange(Particles.eParameterChangeType.IN_TIME,1,i.STREAK_LIFETIME),this.add(a),this._streaks=a,this._title=new t.Title(s),this._title.position.set(s.width/2,s.height/2),this.add(this._title)}return __extends(i,e),i.prototype.reset=function(){this._debris.killAllParticles(),this._explosions.killAllParticles()},i.prototype.sunExplosion=function(e){this._explosions.emitAtObject(e);var i=this._explosions.emitParticle();null!==i&&(i.lifetime=t.Gameplay.SUN_EXPLODE_TIME,i.delay=(e.sunLevel-1)*t.Gameplay.SUN_EXPLODE_TIME/2,i.setAnim("explosion"),i.on=!0)},i.prototype.debris=function(e,i){this._debris.emitAtObject(e);var s=this._debris.emitParticle();null!==s&&(s.lifetime=t.Gameplay.SUN_EXPLODE_TIME,s.setFrame(e.getVisualFrame()),s.delay=(i-1)*t.Gameplay.SUN_EXPLODE_TIME/2+t.Gameplay.SUN_EXPLODE_TIME/2,s.on=!0)},i.prototype.simpleSunExplosion=function(e,i){this._explosions.emitAt(e,i);var s=this._explosions.emitParticle();null!==s&&(s.lifetime=t.Gameplay.SUN_EXPLODE_TIME,s.delay=0,s.setAnim("explosion2"),s.on=!0)},i.prototype.debrisExplosion=function(t,e,i){this._debris.emitAtObject(t);var s=this._debris.emitParticle();null!==s&&(s.lifetime=2,s.setFrame(t.getVisualFrame()),s.delay=.2,s.on=!0,s.setPhysics(e,i,this.game.rnd.integerInRange(-45,45),0,0,2e3))},i.prototype.streak=function(t,e){this._streaks.emitAtObject(t);var i=this._streaks.emitParticle();null!==i&&(i.on=!0,i.text=e+"x")},i.prototype.title=function(t){this._title.text=t,this._title.tween()},i.DEBRIS_PARTICLES=80,i.EXPLOSION_PARTICLES=8,i.STREAK_PARTICLES=8,i.STREAK_DELAY=.6,i.STREAK_LIFETIME=.3,i.ANIM=[{name:"explosion",frameRate:10,loop:!1,killOnComplete:!0,frames:["explosion00","explosion01","explosion02","explosion03","explosion04","explosion05","explosion06","explosion07","explosion08","explosion09"]},{name:"explosion2",frameRate:10,loop:!1,killOnComplete:!0,frames:["explosion03","explosion04","explosion05","explosion06","explosion07","explosion08","explosion09"]}],i}(Phaser.Group);t.Emitters=e}(MeteoricPlus||(MeteoricPlus={}));var MeteoricPlus;!function(t){var e=function(t){function e(e,i){t.call(this,e,i);var s=new Phaser.BitmapText(this._game,0,0,"Font","",i[0],"center");s.anchor.setTo(.5,.5),this._visual=s,this._text=s}return __extends(e,t),e.prototype.onCreate=function(){},Object.defineProperty(e.prototype,"text",{set:function(t){this._text.text=t},enumerable:!0,configurable:!0}),e.prototype.update=function(e){void 0===e&&(e=!0);var i=this._game.time.physicsElapsed;this._visual.y+=this._velocity.y*i;var s=this._velocity.y;this._velocity.y=0;var n=t.prototype.update.call(this,e);return this._velocity.y=s,n},e}(Particles.Particle);t.TextParticle=e}(MeteoricPlus||(MeteoricPlus={}));var MeteoricPlus;!function(t){var e=function(t){function e(i){t.call(this,i,0,0,"Font","",80),this.anchor.set(.5,.5),this.pivot.set(0,-25);this._tweenScale=i.add.tween(this.scale).to({x:1,y:1},e.TWEEN_TIME,Phaser.Easing.Bounce.Out,!1),this._tweenAlpha=i.add.tween(this).to({alpha:1},e.TWEEN_TIME+200,Phaser.Easing.Linear.None,!1),this._tweenAlpha2=i.add.tween(this).to({alpha:0},400,Phaser.Easing.Quintic.Out,!1,e.TWEEN_DELAY+e.TWEEN_TIME),this._tweenAlpha2.onComplete.add(function(){this.exists=!1,this.visible=!1},this)}return __extends(e,t),e.prototype.tween=function(){(this._tweenScale.isRunning||this._tweenAlpha.isRunning||this._tweenAlpha2.isRunning)&&(this._tweenScale.stopAndRemoveFromUpdateQueue(),this._tweenAlpha.stopAndRemoveFromUpdateQueue(),this._tweenAlpha2.stopAndRemoveFromUpdateQueue()),this.alpha=1,this._tweenAlpha2.start(),this.scale.set(4,4),this.alpha=0,this.exists=!0,this.visible=!0,this._tweenScale.start(),this._tweenAlpha.start()},e.TWEEN_DELAY=1e3,e.TWEEN_TIME=700,e}(Phaser.BitmapText);t.Title=e}(MeteoricPlus||(MeteoricPlus={}));var MeteoricPlus;!function(t){var e=function(t){function e(){t.call(this),this._ignoreNextResize=!1}return __extends(e,t),e.prototype.init=function(){this.input.maxPointers=1,this.stage.disableVisibilityChange=!0;var t=Utils.ScreenUtils.screenMetrics;this.game.device.desktop?(this.scale.scaleMode=Phaser.ScaleManager.USER_SCALE,this.scale.setMinMax(.25*this.game.width,.25*this.game.height,2.5*this.game.width,2.5*this.game.height),this.scale.setUserScale(t.scaleX,t.scaleY),this.scale.pageAlignHorizontally=!0,this.scale.pageAlignVertically=!0,this.scale.setResizeCallback(this.gameResized,this)):(this.scale.scaleMode=Phaser.ScaleManager.USER_SCALE,this.scale.setUserScale(t.scaleX,t.scaleY),this.scale.pageAlignHorizontally=!0,this.scale.pageAlignVertically=!0,this.scale.forceOrientation(!0,!1),this.scale.setResizeCallback(this.gameResized,this),this.scale.onOrientationChange.add(this.orientationChange,this)),this.orientationChange(this.scale,"",!0)},e.prototype.create=function(){this.game.state.start("Preloader",!0,!1)},e.prototype.gameResized=function(t,e){},e.prototype.orientationChange=function(t,e,i){},e}(Phaser.State);t.Boot=e}(MeteoricPlus||(MeteoricPlus={}));var MeteoricPlus;!function(t){var e=function(e){function i(){e.call(this),this._restartCounter=2}return __extends(i,e),i.prototype.create=function(){this._once=!1,this._pressed=!1,this.world.setBounds(-320,-320,320,320),this.camera.focusOnXY(0,0),this.stage.backgroundColor=3158064;var t=this.add.image(0,0,"Tut");t.anchor.setTo(.5,.5),t.inputEnabled=!0,t.events.onInputUp.add(function(){this._pressed=!0},this),this._cursorKeys=this.game.input.keyboard.createCursorKeys()},i.prototype.onGameeRestart=function(){--this._restartCounter<=0&&(this._pressed=!0,Utils.AudioUtils.playSound("Fall"))},i.prototype.onGameeButtonDown=function(t){this._pressed=!0,Utils.AudioUtils.playSound("Fall")},i.prototype.update=function(){this._once||((this._cursorKeys.left.justDown||this._cursorKeys.right.justDown||this._cursorKeys.up.justDown||this._cursorKeys.down.justDown)&&(this._pressed=!0),this._pressed&&(this._once=!0,t.Global.GAMEE&&Gamee.Gamee.instance.gameStart(),this.game.state.start("Play")))},i}(Phaser.State);t.Menu=e}(MeteoricPlus||(MeteoricPlus={}));var MeteoricPlus;!function(t){var e=function(e){function i(){e.call(this),this._ready=!1}return __extends(i,e),i.prototype.preload=function(){var t="assets/",t="assets/";this.game.device.ie||Phaser.Device.isAndroidStockBrowser()?(this.load.audio("Explosion","assets/sfx/Explosion.mp3"),this.load.audio("Fall","assets/sfx/Fall.mp3"),this.load.audio("Impact","assets/sfx/Impact.mp3"),this.load.audio("MatchAsteroid","assets/sfx/MatchAsteroid.mp3"),this.load.audio("MatchPlanet","assets/sfx/MatchPlanet.mp3"),this.load.audio("MatchSun","assets/sfx/MatchSun.mp3"),this.load.audio("SmallCheer","assets/sfx/SmallCheer.mp3"),this.load.audio("TrashImpact","assets/sfx/TrashImpact.mp3"),this.load.audio("GameOver","assets/sfx/GameOver.mp3"),this.load.audio("BigCheer","assets/sfx/BigCheer.mp3")):this.load.audio("SFX",["assets/sfx/sfx.ogg","assets/sfx/sfx.m4a"]),this.load.image("Bg",t+"bg.jpg"),this.load.image("Tut",t+"tut.jpg"),this.load.atlas("Sprites",t+"Sprites.png",t+"Sprites.json"),this.load.bitmapFont("Font",t+"font.png",t+"font.xml"),this.load.json("Config",t+"config.json")},i.prototype.loadUpdate=function(){this.setLoadingText(this.load.progress)},i.prototype.create=function(){this.readConfig();var t=0;if(this.game.device.ie||Phaser.Device.isAndroidStockBrowser()){t=.02,Utils.AudioUtils.setSounds(null);var e=this.add.audio("Explosion");e.allowMultiple=!0,Utils.AudioUtils.addSound("Explosion",e),e=this.add.audio("Fall"),e.allowMultiple=!0,Utils.AudioUtils.addSound("Fall",e),e=this.add.audio("Impact"),e.allowMultiple=!0,Utils.AudioUtils.addSound("Impact",e),e=this.add.audio("MatchAsteroid"),e.allowMultiple=!0,Utils.AudioUtils.addSound("MatchAsteroid",e),e=this.add.audio("MatchPlanet"),e.allowMultiple=!0,Utils.AudioUtils.addSound("MatchPlanet",e),e=this.add.audio("MatchSun"),e.allowMultiple=!0,Utils.AudioUtils.addSound("MatchSun",e),e=this.add.audio("SmallCheer"),e.allowMultiple=!0,Utils.AudioUtils.addSound("SmallCheer",e),e=this.add.audio("TrashImpact"),e.allowMultiple=!0,Utils.AudioUtils.addSound("TrashImpact",e),e=this.add.audio("GameOver"),e.allowMultiple=!0,Utils.AudioUtils.addSound("GameOver",e),e=this.add.audio("BigCheer"),e.allowMultiple=!0,Utils.AudioUtils.addSound("BigCheer",e)}else{this.game.device.iOS&&(t=.1);var i=this.add.audio("SFX");Utils.AudioUtils.setSounds(i),i.allowMultiple=!0,i.addMarker("Explosion",0,1.6678),i.addMarker("Fall",3-t,.0515+t),i.addMarker("Impact",5-t,.4462+t),i.addMarker("MatchAsteroid",7-t,.7817+t),i.addMarker("MatchPlanet",9-t,.8493+t),i.addMarker("MatchSun",11-t,1.0562+t),i.addMarker("SmallCheer",14-t,1.8016+t),i.addMarker("TrashImpact",17-t,.3941+t),i.addMarker("GameOver",19-t,3.3717+t),i.addMarker("BigCheer",24-t,3.5449+t)}},i.prototype.readConfig=function(){var e=this.game.cache.getJSON("Config");void 0!==e.INITIAL_TYPES_COUNT&&(t.Gameplay.INITIAL_TYPES_COUNT=e.INITIAL_TYPES_COUNT),void 0!==e.INITIAL_BLOCKS_COUNT&&(t.Gameplay.INITIAL_BLOCKS_COUNT=e.INITIAL_BLOCKS_COUNT),void 0!==e.MOVES_FOR_TRASH&&(t.Gameplay.MOVES_FOR_TRASH=e.MOVES_FOR_TRASH),void 0!==e.SUNS_FOR_COLOR&&(t.Gameplay.SUNS_FOR_COLOR=e.SUNS_FOR_COLOR)},i.prototype.update=function(){this._ready===!1&&(this._ready=!0,this.game.state.start("Menu"))},i.prototype.setLoadingText=function(t){},i}(Phaser.State);t.Preloader=e}(MeteoricPlus||(MeteoricPlus={}));var MeteoricPlus;!function(t){var e=function(e){function i(){e.call(this),this._gameOver=!1,this._runFromRestart=!1}return __extends(i,e),i.prototype.create=function(){this.camera.bounds=null,this.stage.backgroundColor=12632319,this._cursorKeys=this.game.input.keyboard.createCursorKeys(),this.add.image(0,0,"Bg"),this._emitters=new t.Emitters(this.game,this.world),this._board=new t.Board(this.game,this.world,this._emitters),this.world.bringToTop(this._emitters),this._board.onGameOver.add(this.setGameOver,this),this._board.onAddScore.add(this.onAddScore,this),this.reset()},i.prototype.onGameePause=function(){this.game.paused=!0},i.prototype.onGameeUnpause=function(){this.game.paused=!1},i.prototype.onGameeRestart=function(){t.Global.game.paused=!1,this.reset(),Gamee.Gamee.instance.gameStart(),Utils.AudioUtils.playSound("Fall")},i.prototype.onGameeButtonDown=function(t){var e=Gamee.Gamee.instance;e.gameRunning?"left"===t?this._keyLeft=!0:"up"===t?this._keyUp=!0:"right"===t?this._keyRight=!0:"down"===t&&(this._keyDown=!0):this._runFromRestart||(e.gameStart(),Utils.AudioUtils.playSound("Fall"))},i.prototype.onGameeButtonUp=function(t){var e=Gamee.Gamee.instance;e.gameRunning},i.prototype.reset=function(){this._gameOver=!1,this._startTime=this.game.time.time,this._keyLeft=this._keyUp=this._keyRight=this._keyDown=!1,this._score=0,t.Global.GAMEE&&(Gamee.Gamee.instance.score=0),Utils.AudioUtils.playSound("Fall"),this._board.reset()},i.prototype.update=function(){this._gameOver||(this._cursorKeys.left.justDown||this._keyLeft?this._board.moveBoard(0):this._cursorKeys.up.justDown||this._keyUp?this._board.moveBoard(1):this._cursorKeys.right.justDown||this._keyRight?this._board.moveBoard(2):(this._cursorKeys.down.justDown||this._keyDown)&&this._board.moveBoard(3),this._keyLeft=this._keyUp=this._keyRight=this._keyDown=!1,this._board.updateBoard())},i.prototype.setGameOver=function(){this._gameOver||(this._gameOver=!0,this.time.events.add(500,function(){Utils.AudioUtils.playSound("GameOver")},this),this.time.events.add(2e3,function(){t.Global.GAMEE?(this._runFromRestart=!0,Gamee.Gamee.instance.gameOver()):this.reset()},this))},i.prototype.onAddScore=function(e){this._score+=e,t.Global.GAMEE&&(Gamee.Gamee.instance.score=this._score)},i}(Phaser.State);t.Play=e}(MeteoricPlus||(MeteoricPlus={}));var Utils;!function(t){var e=function(){function t(){}return t.setSounds=function(e,i){void 0===i&&(i=null),t._sfx=e,t._sfxIds=i},t.addSound=function(e,i){t._sfxs[e]=i},t.playSound=function(e){var i;i="number"==typeof e?t._sfxIds[e]:e,MeteoricPlus.Global.soundOn&&(null!==t._sfx?t._sfx.play(i):void 0!==t._sfxs[i]&&t._sfxs[i].play())},Object.defineProperty(t,"currentMusic",{get:function(){return t._currentMusic},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isMusicPlaying",{get:function(){if(null===this._currentMusic||0===this._currentMusic.length)return!1;var e=t._music[t._currentMusic];return e.isPlaying},enumerable:!0,configurable:!0}),t.addMusic=function(e,i){t._music[e]=i},t.playMusic=function(e,i){if(void 0===i&&(i=!0),t._currentMusic!==e&&(null!==t._currentMusic&&t._currentMusic.length>0&&t.stopMusic(),e in t._music&&MeteoricPlus.Global.musicOn)){t._currentMusic=e;var s=t._music[e];s.loop=i,s.play(),i||s.onStop.addOnce(function(){t.onFinished.dispatch(e)},this)}},t.stopMusic=function(){if(null!==t._currentMusic&&t._currentMusic.length>0){var e=t._music[t._currentMusic];e.isPlaying&&e.stop(),t._currentMusic=""}},t.pauseMusic=function(){if(null!==t._currentMusic&&t._currentMusic.length>0){var e=t._music[t._currentMusic];e.isPlaying&&e.pause()}},t.resumeMusic=function(){if(null!==t._currentMusic&&t._currentMusic.length>0){var e=t._music[t._currentMusic];e.paused&&e.resume()}},t._sfx=null,t._sfxs={},t._music={},t._currentMusic="",t.onFinished=new Phaser.Signal,t}();t.AudioUtils=e}(Utils||(Utils={}));var Utils;!function(t){var e=function(){function t(){}return t.supported=function(){var t=MeteoricPlus.Global.game;return t.scale.compatibility.supportsFullScreen},t.isFullscreen=function(){return MeteoricPlus.Global.game.scale.isFullScreen},t.changeFullscreen=function(){var e=MeteoricPlus.Global.game;t._fullscreen?e.scale.stopFullScreen():e.scale.startFullScreen(!1,!1)},t.onEnterFullscreen=function(){t._fullscreen=!0,null!==t._listener&&t._listener.call(t._listenerContext,!0)},t.onLeaveFullscreen=function(){t._fullscreen=!1,null!==t._listener&&t._listener.call(t._listenerContext,!1)},t.setListener=function(e,i){t._listener=e,t._listenerContext=i},t.removeListener=function(){t._listener=null,t._listenerContext=null},t._fullscreen=!1,t._listener=null,t._listenerContext=null,t}();t.FullscreenUtils=e}(Utils||(Utils={}));var Utils;!function(t){var e=function(){function t(){}return t.ChangeAnimationPhaserJSONData=function(t){Phaser.AnimationParser.myCallback=t,Phaser.AnimationParser.JSONData=function(t,e){if(e.frames){for(var i=new Phaser.FrameData,s=e.frames,n=0;n<s.length;n++){var a=i.addFrame(new Phaser.Frame(n,s[n].frame.x,s[n].frame.y,s[n].frame.w,s[n].frame.h,s[n].filename));s[n].trimmed&&a.setTrim(s[n].trimmed,s[n].sourceSize.w,s[n].sourceSize.h,s[n].spriteSourceSize.x,s[n].spriteSourceSize.y,s[n].spriteSourceSize.w,s[n].spriteSourceSize.h),Phaser.AnimationParser.myCallback(a,s[n])}return i}}},t.AdjustTweenFunctions=function(){Phaser.TweenManager.prototype.removeFromUpdateQueue=function(t){var e=this._tweens.indexOf(t);-1!==e?this._tweens.splice(e,1):(e=this._add.indexOf(t),-1!==e&&this._add.splice(e,1))},Phaser.Tween.prototype.stopAndRemoveFromUpdateQueue=function(t){var e=this,i=e.stop(t);return e.manager.removeFromUpdateQueue(e),e.pendingDelete=!1,i}},t}();t.PhaserUtils=e}(Utils||(Utils={}));var Utils;!function(t){var e=function(){function t(){}return t}();t.ScreenMetrics=e,function(t){t[t.PORTRAIT=0]="PORTRAIT",t[t.LANDSCAPE=1]="LANDSCAPE"}(t.Orientation||(t.Orientation={}));var i=t.Orientation,s=function(){function t(){}return t.calculateScreenMetrics=function(t,s,n,a,o){void 0===n&&(n=i.LANDSCAPE);var r,l;r=window.innerWidth,l=window.innerHeight,r=Math.min(r,1.5*t),l=Math.min(l,1.5*s);var h=n===i.LANDSCAPE?t/s:t/s,u=r/l,c=0,p=0,_=0,m=0;u>h?(m=s,_=2*Math.ceil(m*u/2),_=Math.min(_,a),c=(_-t)/2,p=0):(_=t,m=2*Math.ceil(_/u/2),m=Math.min(m,o),c=0,p=(m-s)/2);var d=r/_,f=l/m;return this.screenMetrics=new e,this.screenMetrics.windowWidth=r,this.screenMetrics.windowHeight=l,this.screenMetrics.defaultGameWidth=t,this.screenMetrics.defaultGameHeight=s,this.screenMetrics.maxGameWidth=a,this.screenMetrics.maxGameHeight=o,this.screenMetrics.gameWidth=_,this.screenMetrics.gameHeight=m,this.screenMetrics.scaleX=d,this.screenMetrics.scaleY=f,this.screenMetrics.offsetX=c,this.screenMetrics.offsetY=p,this.screenMetrics},t}();t.ScreenUtils=s}(Utils||(Utils={}));var Utils;!function(t){var e=function(){function t(){}return t}(),i=function(){function t(){}return t.save=function(){if(t.localStorageSupported()){var i=new e;i.musicOn=MeteoricPlus.Global.musicOn,i.soundOn=MeteoricPlus.Global.soundOn,i.currentLanguage=MeteoricPlus.Global.currentLanguage;var s=JSON.stringify(i);localStorage.setItem("meteoricplus_save",s)}},t.load=function(){if(t.localStorageSupported()){var e=JSON.parse(localStorage.getItem("meteoricplus_save"));return null===e||void 0===e?!1:(MeteoricPlus.Global.musicOn=e.musicOn,MeteoricPlus.Global.soundOn=e.soundOn,MeteoricPlus.Global.currentLanguage=e.currentLanguage,!0)}},t.localStorageSupported=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}},t}();t.StorageUtils=i}(Utils||(Utils={}));var Utils;!function(t){var e=function(){function t(){}return t.padNumber=function(t,e,i){void 0===i&&(i="0");var s=t+"";return s.length>=e?s:new Array(e-s.length+1).join(i)+s},t}();t.StringUtils=e}(Utils||(Utils={}));var Utils;!function(t){var e=function(){function t(){}return t.isAndroidStockBrowser=function(){var t=navigator.userAgent,e=/Android/.test(t),i=/Chrome/.test(t);return e&&!i},t}();t.SystemUtils=e}(Utils||(Utils={}));var Utils;!function(t){var e=function(){function t(){}return t.setTexts=function(e){t._texts=e},t.getText=function(e){if(null===t._texts)return"Texts not set";var i=t._texts;if(void 0===i[e])return"";var s=i[e][MeteoricPlus.Global.currentLanguage];return void 0===s&&(MeteoricPlus.Global.currentLanguage="en",s=i[e][MeteoricPlus.Global.currentLanguage]),s},t.game=null,t._texts=null,t}();t.TextUtils=e}(Utils||(Utils={}));var MeteoricPlus;!function(t){var e=function(){function t(){}return t.GAMEE=!0,t.game=null,t.paralax=!0,t.GAME_WIDTH=640,t.GAME_HEIGHT=640,t.MAX_GAME_WIDTH=640,t.MAX_GAME_HEIGHT=640,t.scaleX=1,t.scaleY=1,t.correctOrientation=!1,t.musicOn=!0,t.soundOn=!0,t.showLanguages=!1,t.supportedLanguages=["en"],t.currentLanguage="en",t}();t.Global=e}(MeteoricPlus||(MeteoricPlus={}));var PhaserGlobal={stopFocus:!0};window.onload=function(){var t=new MeteoricPlus.Game;if(MeteoricPlus.Global.game=t,MeteoricPlus.Global.GAMEE){var e=new Gamee.Gamee("FourArrows",!0);e.setGame(t)}};var MeteoricPlus;!function(t){var e=function(e){function i(){var s=(window.innerWidth,window.innerHeight,Utils.ScreenUtils.calculateScreenMetrics(t.Global.GAME_WIDTH,t.Global.GAME_HEIGHT,Utils.Orientation.PORTRAIT,t.Global.MAX_GAME_WIDTH,t.Global.MAX_GAME_HEIGHT)),n=Phaser.AUTO;e.call(this,{width:s.gameWidth,height:s.gameHeight,renderer:n,parent:"content",transparent:!1,antialias:!0,physicsConfig:null,preserveDrawingBuffer:!0}),i.game=this,Utils.PhaserUtils.ChangeAnimationPhaserJSONData(this.additionalFrameProperties),Utils.PhaserUtils.AdjustTweenFunctions(),this.state.add("Boot",t.Boot),this.state.add("Preloader",t.Preloader),this.state.add("Menu",t.Menu),this.state.add("Play",t.Play),this.state.add("Test",t.Play),this.state.start("Boot")}return __extends(i,e),i.prototype.onMute=function(){Utils.AudioUtils.stopMusic(),t.Global.soundOn=!1,t.Global.musicOn=!1},i.prototype.onUnmute=function(){t.Global.soundOn=!0,t.Global.musicOn=!0},i.prototype.additionalFrameProperties=function(t,e){e.anchor&&(t.anchorX=e.anchor.w,t.anchorY=e.anchor.h),e.nextitem&&(t.nextItemX=e.nextitem.w,t.nextItemY=e.nextitem.h)},i}(Phaser.Game);t.Game=e}(MeteoricPlus||(MeteoricPlus={}));
