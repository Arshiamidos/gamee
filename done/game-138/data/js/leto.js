var Leto;!function(t){var e=function(){function t(){}return t.GAMEE=!0,t.game=null,t.paralax=!0,t.GAME_WIDTH=640,t.GAME_HEIGHT=640,t.MAX_GAME_WIDTH=640,t.MAX_GAME_HEIGHT=640,t.scaleX=1,t.scaleY=1,t.correctOrientation=!1,t.musicOn=!0,t.soundOn=!0,t.showLanguages=!1,t.supportedLanguages=["en"],t.currentLanguage="en",t}();t.Global=e}(Leto||(Leto={}));var PhaserGlobal={stopFocus:!0};window.onload=function(){var t=new Gamee.Gamee("OneButton",!0),e=new Leto.Game;Leto.Global.game=e,t.setGame(e)};var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Leto;!function(t){var e=function(e){function i(){var n=(window.innerWidth,window.innerHeight,Utils.ScreenUtils.calculateScreenMetrics(t.Global.GAME_WIDTH,t.Global.GAME_HEIGHT,Utils.Orientation.PORTRAIT,t.Global.MAX_GAME_WIDTH,t.Global.MAX_GAME_HEIGHT)),r=Phaser.AUTO;e.call(this,{width:n.gameWidth,height:n.gameHeight,renderer:r,parent:"content",transparent:!1,antialias:!0,physicsConfig:null,preserveDrawingBuffer:!0}),i.game=this,Utils.PhaserUtils.ChangeAnimationPhaserJSONData(this.additionalFrameProperties),Utils.PhaserUtils.AdjustTweenFunctions(),this.state.add("Boot",t.Boot),this.state.add("Preloader",t.Preloader),this.state.add("Menu",t.Menu),this.state.add("Play",t.Play),this.state.add("Test",t.Play),this.state.start("Boot")}return __extends(i,e),i.prototype.onMute=function(){Utils.AudioUtils.stopMusic(),t.Global.soundOn=!1,t.Global.musicOn=!1},i.prototype.onUnmute=function(){t.Global.soundOn=!0,t.Global.musicOn=!0},i.prototype.additionalFrameProperties=function(t,e){e.anchor&&(t.anchorX=e.anchor.w,t.anchorY=e.anchor.h),e.nextitem&&(t.nextItemX=e.nextitem.w,t.nextItemY=e.nextitem.h)},i}(Phaser.Game);t.Game=e}(Leto||(Leto={}));var Helper;!function(t){var e=function(){function t(){}return t.randomizeArray=function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1);var r=i?e.slice():e;return Phaser.ArrayUtils.shuffle(r),n?r.slice(0,t):r},t.sort=function(e,i,n,r){if(void 0===n&&(n=0),void 0===r&&(r=e.length),r>n){for(var s,o=n,a=n+1;r>=a;a++)i(e[n],e[a])>0&&(s=e[++o],e[o]=e[a],e[a]=s);s=e[n],e[n]=e[o],e[o]=s,t.sort(e,i,n,o-1),t.sort(e,i,o+1,r)}},t}();t.ArrayUtils=e}(Helper||(Helper={}));var Leto;!function(t){var e;!function(t){function e(t,e,i){var n=t*Math.PI*2*e,r=t*(2*Math.PI*i+Math.PI/2);return Math.sin(n)*Math.cos(r)}function i(t,e,i){var n=t*Math.PI*2*e,r=-t*i;return Math.sin(n)*Math.exp(r)}function n(t){return-2*t*t+3*t}function r(t){return-(n(1-t)-1)}function s(t){return Math.sin(2*t*Math.PI)}function o(t){return Math.sin(t*Math.PI)}function a(t,e){return Math.sin(2*t*Math.PI*e)}t.wiggle=e,t.sinWithExpDecay=i,t.pop5=n,t.pop5rev=r,t.sin=s,t.halfSin=o,t.sinWithPeriod=a}(e=t.Easing||(t.Easing={}))}(Leto||(Leto={}));var Helper;!function(t){var e=function(){function t(){}return t.create=function(e,i,n,r,s,o,a,h,l,p){return void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),void 0===l&&(l=0),void 0===p&&(p=!1),t._image=new Phaser.Image(e,0,0,r),"string"==typeof s?t._frame=e.cache.getFrameByName(r,s):t._frame=e.cache.getFrameByIndex(r,s),t.calculateNineImage(i,n,o,a,h,l,p),t._nineImage=new Phaser.BitmapData(e,"NineImage"+t._textureKey++,t._width,t._height),t.renderNineImage(),t._nineImage},t.calculateNineImage=function(e,i,n,r,s,o,a){var h=t._frame;if(t._centralWidth=h.width-r-o,t._centralHeight=h.height-n-s,a)t._horizontalRepeats=e,t._verticalRepeats=i,t._width=r+o+t._centralWidth*e,t._height=n+s+t._centralHeight*i,t._lastWidth=0,t._lastHeight=0;else{var l=e-r-o;t._horizontalRepeats=Math.floor(l/t._centralWidth),t._lastWidth=l%t._centralWidth;var p=i-n-s;t._verticalRepeats=Math.floor(p/t._centralHeight),t._lastHeight=p%t._centralHeight,t._width=e,t._height=i}t._leftWidth=r,t._rightWidth=o,t._topHeight=n,t._bottomHeight=s},t.renderNineImage=function(){var e=t._frame.y,i=0;t._topHeight>0&&(t.renderNineImageRow(t._image,e,i,t._topHeight),e+=t._topHeight,i+=t._topHeight);for(var n=0;n<t._verticalRepeats;n++)t.renderNineImageRow(t._image,e,i,t._centralHeight),i+=t._centralHeight;t._lastHeight>0&&(t.renderNineImageRow(t._image,e,i,t._lastHeight),i+=t._lastHeight),e+=t._centralHeight,t._bottomHeight>0&&t.renderNineImageRow(t._image,e,i,t._bottomHeight)},t.renderNineImageRow=function(e,i,n,r){var s=t._frame.x,o=0;t._leftWidth>0&&(t._nineImage.copy(e,s,i,t._leftWidth,r,o,n),o+=t._leftWidth,s+=t._leftWidth);for(var a=0;a<t._horizontalRepeats;a++)t._nineImage.copy(e,s,i,t._centralWidth,r,o,n),o+=t._centralWidth;t._lastWidth>0&&(t._nineImage.copy(e,s,i,t._lastWidth,r,o,n),o+=t._lastWidth),s+=t._centralWidth,t._rightWidth>0&&t._nineImage.copy(e,s,i,t._rightWidth,r,o,n)},t._textureKey=0,t}();t.NineImage=e}(Helper||(Helper={}));var Helper;!function(t){var e;!function(t){t[t.UNDEFINED=-1]="UNDEFINED",t[t.SPACE=1]="SPACE",t[t.NEWLINE=2]="NEWLINE",t[t.CHARACTER=3]="CHARACTER"}(e||(e={}));var i=function(){function t(){}return t.hasNext=function(){return t.textPosition<t.text.length},t.getChar=function(){return t.text.charAt(t.textPosition++)},t.peekChar=function(){return t.text.charAt(t.textPosition)},t.getPosition=function(){return t.textPosition},t.setPosition=function(e){t.textPosition=e},t.getCharAdvance=function(e,i){var n=t.fontData.chars[e],r=n.xAdvance;return i>0&&n.kerning[i]&&(r+=n.kerning[i]),r},t.getCharType=function(t){return" "===t?e.SPACE:/(?:\r\n|\r|\n)/.test(t)?e.NEWLINE:e.CHARACTER},t.wrapText=function(i,n,r,s,o,a){t.text=n,t.setPosition(0),t.fontData=i.cache.getBitmapFont(o).font,void 0===a&&(a=t.fontData.size);var h=a/t.fontData.size,l=t.fontData.lineHeight*h,p=r/h,u=[],c=[],_=[],f=0,m=!0,d=0,g=0;u[f]=g,_[d++]=0;for(var y=s;t.hasNext();){for(var T=0,v=0,b=-1,P=e.UNDEFINED,E=e.UNDEFINED,I=p,S=-1;t.hasNext();){g=t.getPosition();var A=t.getChar();P=t.getCharType(A);var N=A.charCodeAt(0);if(P===e.SPACE)E!==e.SPACE&&(v=T),++T,I-=t.getCharAdvance(N,S);else if(P===e.CHARACTER){if(E!==e.CHARACTER&&(b=g),I-=t.getCharAdvance(N,S),0>I)break;++T}else if(P===e.NEWLINE){var O=!1;if(t.hasNext()&&(O=!0,v=T,b=t.getPosition(),g=b,I=-1,P=e.CHARACTER),O)break}E=P,S=N}y-=l,0>y&&(_[d++]=f),0>I&&P===e.CHARACTER?(0!==v?c[f]=v:c[f]=T,m=!1,0>y&&(m=!0,y=s-l),0!==v?(u[++f]=b,t.setPosition(b)):(u[++f]=g,t.setPosition(g))):t.hasNext()||(P===e.CHARACTER?c[f]=T:P===e.SPACE&&(c[f]=v))}_[d]=f+1;for(var M=[],L=1;d>=L;L++){for(var R=_[L-1],C=_[L],G=[],F=R;C>F;F++)G.push(t.text.substr(u[F],c[F]));M.push(G.join("\n"))}return M},t}();t.TextWrapper=i}(Helper||(Helper={}));var Log;!function(t){var e=function(){function t(){}return t.msg=function(e){t.messages.push(e)},t.messages=[],t}();t.Log=e}(Log||(Log={}));var Leto;!function(t){var e=function(){function t(){}return t.PLATFORM=[["PlatformL","PlatformM","PlatformR"]],t.BLOCK=[["BlockTL","BlockTM","BlockTR"],["Block1L","Block1M","Block1R"],["Block2L","Block2M","Block2R"],["BlockBL","BlockBM","BlockBR"]],t.GROUND_0=[["GroundL","GroundM","GroundR"]],t.GROUND_1=[["BlockTL","BlockTM","BlockTR"],["Ground2L","Ground2M","Ground2R"]],t.SPIKE_PATTERNS=[[],[],[],[],[],[4],[12],[28,20],[24,36],[56,108,68]],t.SPIKE_ANIM=["Spikes0","Spikes1","Spikes2","Spikes3","Spikes2","Spikes1"],t.BONUS_JUMP_ANIM=["srdce1","srdce2","srdce3","srdce4","srdce5","srdce6","srdce7"],t}();t.BlockDefs=e}(Leto||(Leto={}));var Gamee;!function(t){var e=function(){function t(e,i){void 0===i&&(i=!1),this._game=null,this._gameeController=null,this._indices={right:1,up:2,left:4,down:8,A:16,B:32,button:64},this._pressesCache=0,this._isDown=0,this._justDown=0,this._justUp=0,this._gameRunning=!1,this._score=0,void 0!==window.gamee&&("Touch"!==e?(this._gameeController=window.gamee.controller.requestController(e,{enableKeyboard:i}),this.keyHandlers()):(this._gameeController=window.gamee.controller.requestController("Touch"),this.touchHandlers())),this.eventHandlers(),t._instance=this}return Object.defineProperty(t,"instance",{get:function(){return null===t._instance,t._instance},enumerable:!0,configurable:!0}),t.prototype.setGame=function(t){this._game=t},Object.defineProperty(t.prototype,"gameRunning",{get:function(){return this._gameRunning},enumerable:!0,configurable:!0}),t.prototype.keyHandlers=function(){var t=this;this._gameeController.on("keydown",function(e){t._pressesCache|=t._indices[e.button];var i=t._game.state.getCurrentState();"function"==typeof i.onGameeButtonDown&&i.onGameeButtonDown(e.button)}),this._gameeController.on("keyup",function(e){t._pressesCache&=~t._indices[e.button];var i=t._game.state.getCurrentState();"function"==typeof i.onGameeButtonUp&&i.onGameeButtonUp(e.button)})},t.prototype.processKeys=function(){var t=this._isDown;this._isDown=this._pressesCache;var e=t^this._isDown;this._justDown=e&this._isDown,this._justUp=e&~this._isDown},t.prototype.clearKeys=function(){this._pressesCache=0,this._isDown=0,this._justDown=0,this._justUp=0},t.prototype.isDown=function(t){return(this._isDown&this._indices[t])>0},t.prototype.justDown=function(t){return(this._justDown&this._indices[t])>0},Object.defineProperty(t.prototype,"anyIsDown",{get:function(){return this._isDown>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anyJustDown",{get:function(){return this._justDown>0},enumerable:!0,configurable:!0}),t.prototype.isUp=function(t){return!this.isDown(t)},t.prototype.justUp=function(t){return(this._justUp&this._indices[t])>0},t.prototype.touchHandlers=function(){var t=this;this._gameeController.on("touchstart",function(e){var i=t._game.state.getCurrentState();"function"==typeof i.onGameeTouchStart&&i.onGameeTouchStart(e)}),this._gameeController.on("touchend",function(e){var i=t._game.state.getCurrentState();"function"==typeof i.onGameeTouchEnd&&i.onGameeTouchEnd(e)}),this._gameeController.on("touchmove",function(e){var i=t._game.state.getCurrentState();"function"==typeof i.onGameeTouchMove&&i.onGameeTouchMove(e)}),this._gameeController.on("touchleave",function(e){var i=t._game.state.getCurrentState();"function"==typeof i.onGameeTouchLeave&&i.onGameeTouchLeave(e)}),this._gameeController.on("touchcancel",function(e){var i=t._game.state.getCurrentState();"function"==typeof i.onGameeTouchCancel&&i.onGameeTouchCancel(e)})},t.prototype.eventHandlers=function(){var t=this;window.gamee.onPause=function(){t.onPause()},window.gamee.onUnpause=function(){t.onUnpause()},window.gamee.onRestart=function(){t.onRestart()},window.gamee.onMute=function(){t._game.onMute()},window.gamee.onUnmute=function(){t._game.onUnmute()}},t.prototype.onPause=function(){var t=this._game.state.getCurrentState();"function"==typeof t.onGameePause&&t.onGameePause()},t.prototype.onUnpause=function(){var t=this._game.state.getCurrentState();"function"==typeof t.onGameeUnpause&&t.onGameeUnpause()},t.prototype.onRestart=function(){var t=this._game.state.getCurrentState();"function"==typeof t.onGameeRestart&&t.onGameeRestart()},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},set:function(t){this._score=t,window.gamee.score=t},enumerable:!0,configurable:!0}),t.prototype.addScore=function(t){this.score+=t},t.prototype.gameStart=function(){this._gameRunning,window.gamee.gameStart(),this._gameRunning=!0},t.prototype.gameOver=function(){!this._gameRunning,window.gamee.gameOver(),this._gameRunning=!1},t._instance=null,t}();t.Gamee=e}(Gamee||(Gamee={}));var Leto;!function(t){var e=function(){function t(){}return t.GRID_SIZE=64,t.GRID_STEPS=4,t.UBOUND=2,t.LBOUND=8,t.GRAVITY=2400,t.HEIGHT_MIN=.75*t.GRID_SIZE,t.HEIGHT_MAX=2.9*t.GRID_SIZE,t.HEIGHT_STEPS=4,t.VELOCITY_X=300,t.GIRL_TIME=10,t.JUMP_PROB_MIN=15,t.JUMP_PROB_MAX=30,t.JUMP_PROB_START_TILES=50,t.JUMP_PROB_STEP_TILES=16,t.JUMPS_COUNT_MIN=1,t.JUMPS_COUNT_MAX=3,t.JUMPS_COUNT_START_TILES=50,t.JUMPS_COUNT_STEP_TILES=100,t.SPIKES_PROB_MIN=10,t.SPIKES_PROB_MAX=25,t.SPIKES_PROB_START_TILES=40,t.SPIKES_PROB_STEP_TILES=10,t.PLATFORM_LENGTH_MIN=2,t.PLATFORM_LENGTH_MAX=5,t.PLATFORM_LENGTH_DECREASER_MAX=-2,t.PLATFORM_LENGTH_DECREASER_START_TILES=100,t.PLATFORM_LENGTH_DECREASER_STEP_TILES=50,t.JUMP_LENGTH_DECREASER_MIN=-1,t.JUMP_LENGTH_DECREASER_MAX=0,t.JUMP_LENGTH_DECREASER_START_TILES=0,t.JUMP_LENGTH_DECREASER_STEP_TILES=50,t.HEARTS_TIME=3,t}();t.Gameplay=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(){function t(t,e,i){void 0===i&&(i=null),this.name="<no name>",this.debug=0,this._newFunction=null,this._count=0,this._pool=[],this._canGrow=!0,this._poolSize=0,this._classType=t,this._newFunction=i;for(var n=0;e>n;n++){var r=this.newItem();this._pool[this._count++]=r}this._poolSize=e}return t.prototype.createItem=function(){return 0===this._count?((this.debug&t.DEBUG_ALLOCATION)>0,this._canGrow?this.newItem():null):((this.debug&t.DEBUG_CREATE)>0,this._pool[--this._count])},t.prototype.destroyItem=function(e){(this.debug&t.DEBUG_DESTROY)>0,this._pool[this._count++]=e},Object.defineProperty(t.prototype,"newFunction",{set:function(t){this._newFunction=t},enumerable:!0,configurable:!0}),t.prototype.newItem=function(){return null!==this._newFunction?this._newFunction():new this._classType},Object.defineProperty(t.prototype,"canGrow",{set:function(t){this._canGrow=t},enumerable:!0,configurable:!0}),t.DEBUG_ALLOCATION=1,t.DEBUG_CREATE=2,t.DEBUG_DESTROY=4,t.DEBUG_ALL=7,t}();t.Pool=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(){function e(){}return e.calcVelocities=function(){for(var e=[],i=0;i<=t.Gameplay.HEIGHT_STEPS;i++){var n=t.Gameplay.HEIGHT_MIN+(t.Gameplay.HEIGHT_MAX-t.Gameplay.HEIGHT_MIN)/t.Gameplay.HEIGHT_STEPS*i;e[i]=Math.sqrt(n*t.Gameplay.GRAVITY/.5)}return e},e.calcTables=function(i,n,r){void 0===r&&(r=null);for(var s=new t.JumpTables,o=1;o<i.length;o++)for(var a=t.Gameplay.GRID_SIZE/t.Gameplay.GRID_STEPS/2,h=0;h<t.Gameplay.GRID_STEPS;h++){var l=e.calcTableCurve(a,o,-i[o],n,r);s.addFreeList(l.freeList),s.addJumps(o,h,l.jumpDefs),a+=t.Gameplay.GRID_SIZE/t.Gameplay.GRID_STEPS}return null!==r&&(r.dirty=!0),s.analyze(),s},e.calcTableCurve=function(e,i,n,r,s){void 0===s&&(s=null);for(var o,a,h=1/60,l=n,p=256,u=e,c=p,_={},f=[],m=[],d=0;d<t.Global.GAME_HEIGHT/t.Gameplay.GRID_SIZE;){l+=t.Gameplay.GRAVITY*h,o=e,a=p,p+=l*h,e+=t.Gameplay.VELOCITY_X*h,null!==s&&s.rect(e,p,2,2,"#FFFFFF");var g=Math.floor(e/t.Gameplay.GRID_SIZE),y=Math.floor((e+0*r.width)/t.Gameplay.GRID_SIZE);if(d=Math.floor((p-c)/t.Gameplay.GRID_SIZE),l>0&&Math.floor(p/t.Gameplay.GRID_SIZE)>Math.floor(a/t.Gameplay.GRID_SIZE)){for(var T=Math.floor(p/t.Gameplay.GRID_SIZE)*t.Gameplay.GRID_SIZE,v=o+(e-o)*(T-a)/(p-a),b=!0,P=g;y>=P;P++){var E=""+(P+(d<<8));if(void 0===_[E]){b=!1;var I=new t.Jump;I.jumpHeightIndex=i,I.startX=u,I.offsetX=P,I.offsetY=d,I.distX=e-u,I.mustBeFree=f,I.mustBeFreeCount=f.length,m.push(I)}}if(null!==s){var S=b?"#FF8080":"#8080FF";s.line(v,T,v+r.width,T,S),s.line(v,T-3,v,T+3,S),s.line(v+r.width,T-3,v+r.width,T+3,S)}}for(var P=g;y>=P;P++){var E=""+(P+(d<<8));void 0===_[E]&&(_[E]=E,f.push(new t.TilePos(P,d)))}}return{freeList:f,jumpDefs:m}},e}();t.VelocityCalculator=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(){function e(t,i){this.maxVelocity=e.MAX_VELOCITY,this._velocity=new Phaser.Point(0,0),this._angularVelocity=0,this._friction=0,this._angularDrag=0,this._gravity=0,this._alpha=1,this._scaleChange=0,this._alphaChange=0,this._game=t}return Object.defineProperty(e.prototype,"visual",{get:function(){return this._visual},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"on",{set:function(t){this._on=t,this._visual.exists=t,this._visual.visible=t},enumerable:!0,configurable:!0}),e.prototype.remove=function(){var t=this._visual.parent;null!==t&&(t instanceof Phaser.Group?t.remove(this._visual):t.removeChild(this._visual),t=null)},e.prototype.bringToTop=function(){var t=this._visual.parent;t instanceof Phaser.Group&&t.bringToTop(this._visual)},e.prototype.sendToBack=function(){var t=this._visual.parent;t instanceof Phaser.Group&&t.sendToBack(this._visual)},Object.defineProperty(e.prototype,"textureKey",{set:function(t){this._textureKey=t},enumerable:!0,configurable:!0}),e.prototype.setScaleChange=function(t,e){void 0===e&&(e=0),this._scaleChangeType=t,this._scaleChange=e},Object.defineProperty(e.prototype,"alpha",{set:function(t){this._alpha=t,this._visual.alpha=Phaser.Math.clamp(t,0,1)},enumerable:!0,configurable:!0}),e.prototype.setAlphaChange=function(t,e){void 0===e&&(e=0),this._alphaChangeType=t,this._alphaChange=e},e.prototype.setPhysics=function(t,e,i,n,r,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===s&&(s=0),this._velocity.setTo(t,e),this._angularVelocity=i,this._friction=n,this._angularDrag=r,this._gravity=s,this._simplePhysics=0===s&&0===n&&0===r},e.prototype.setFrame=function(t){},e.prototype.onEmit=function(t){t.add(this._visual)},e.prototype.onKill=function(t){},e.prototype.update=function(e){void 0===e&&(e=!0);var i=this._game.time.physicsElapsed;if(this.lifetime>0&&(this.lifetime-=i)<=0)return!1;if((0!==this._velocity.x||0!==this._velocity.y)&&(this._visual.x+=this._velocity.x*i,this._visual.y+=this._velocity.y*i),0!==this._angularVelocity&&(this._visual.angle+=this._angularVelocity*i),this._simplePhysics||(this._velocity.x+=-this._friction*this._velocity.x*i,this._velocity.y+=(this._gravity-this._friction*this._velocity.y)*i,this._angularVelocity+=-this._angularDrag*this._angularVelocity*i),!e)return!0;if(this._scaleChangeType!=t.eParameterChangeType.NO_CHANGE)switch(this._scaleChangeType){case t.eParameterChangeType.IN_TIME:(this._visual.scale.x+=this._scaleChange*i)<0&&(this._visual.scale.x=0,this._scaleChange<0&&(this._scaleChangeType=t.eParameterChangeType.NO_CHANGE)),(this._visual.scale.y+=this._scaleChange*i)<0&&(this._visual.scale.y=0,this._scaleChange<0&&(this._scaleChangeType=t.eParameterChangeType.NO_CHANGE))}if(this._alphaChangeType!=t.eParameterChangeType.NO_CHANGE)switch(this._alphaChangeType){case t.eParameterChangeType.IN_TIME:this._alpha+=this._alphaChange*i,this._alpha<0?(this._visual.alpha=0,this._alphaChange<0&&(this._alphaChangeType=t.eParameterChangeType.NO_CHANGE)):this._alpha>1?(this._visual.alpha=1,this._alphaChange>0&&(this._alphaChangeType=t.eParameterChangeType.NO_CHANGE)):this._visual.alpha=this._alpha}return!0},e.MAX_VELOCITY=1e3,e}();t.Particle=e}(Leto||(Leto={}));var Leto;!function(t){var e;!function(t){t[t.NONE=0]="NONE",t[t.FLOW=1]="FLOW",t[t.EXPLODE=2]="EXPLODE"}(e||(e={})),function(t){t[t.NO_CHANGE=0]="NO_CHANGE",t[t.IN_TIME=1]="IN_TIME"}(t.eParameterChangeType||(t.eParameterChangeType={}));var i=t.eParameterChangeType,n=function(n){function r(s,o,a,h){n.call(this,s,null),this._maxParticles=r.MAX_PARTICELES,this.emitPoint=new Phaser.Point(0,0),this.area=new Phaser.Point(0,0),this.emitObject=null,this.gravity=100,this.particleClass=t.SpriteParticle,this.particleBringToTop=!1,this.particleSendToBack=!1,this.frequency=100,this.minLifetime=1,this.maxLifetime=2,this.minParticleScale=1,this.maxParticleScale=1,this.scaleChange=0,this.scaleChangeType=i.NO_CHANGE,this.minParticleSpeed=new Phaser.Point(-100,-100),this.maxParticleSpeed=new Phaser.Point(100,100),this.particleFriction=0,this.minAngularSpeed=-360,this.maxAngularSpeed=360,this.angularDrag=0,this.minParticleAlpha=1,this.maxParticleAlpha=1,this.alphaChange=0,this.alphaChangeType=i.NO_CHANGE,this.forceEmit=!1,this._on=!1,this._mode=e.NONE,this._flowQuantity=0,this._flowTotal=0,this._flowCounter=0,this._particlesPool=[],this._counterPool=0,this._particlesUsed=[],this._counterUsed=0,this._timer=0,this._frames=null,this._emitPoint=new Phaser.Point(0,0),this._minParticleScale=new Phaser.Point(1,1),this._maxParticleScale=new Phaser.Point(1,1),this.position.setTo(o,a),this._maxParticles=h}return __extends(r,n),r.prototype.update=function(){if(this._on&&this.game.time.time>=this._timer&&(this._timer=this.game.time.time+this.frequency*this.game.time.slowMotion,this._mode===e.FLOW))if(-1!==this._flowTotal&&this._flowCounter>=this._flowTotal)this._mode=e.NONE;else for(var t=Math.max(1,this._flowQuantity),i=0;t>i&&!(this.emitParticle(this.forceEmit)&&(this._flowCounter++,-1!==this._flowTotal&&this._flowCounter>=this._flowTotal));i++);for(var i=this._counterUsed-1;i>=0;i--){var n=this._particlesUsed[i];n.update()||(n.on=!1,n.remove(),n.onKill(this),this._particlesUsed[i]=this._particlesUsed[--this._counterUsed],this._particlesPool[this._counterPool++]=n)}},r.prototype.makeParticles=function(t,e,i,n){(void 0===i||i>this._maxParticles)&&(i=this._maxParticles),void 0!==e&&(this._frames=e);for(var r=0;i>r;r++){var s=new this.particleClass(this.game,n);s.textureKey=t,s.onCreate(this),s.on=!1,this._particlesPool[this._counterPool++]=s}},Object.defineProperty(r.prototype,"on",{set:function(t){this._on=t,this.exists=t,this.visible=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"lifetime",{set:function(t){this.minLifetime=this.maxLifetime=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"count",{get:function(){return this._counterUsed},enumerable:!0,configurable:!0}),r.prototype.explode=function(t,i,n){this._mode=e.EXPLODE,this.on=!0,this.emitParticles(t,i,n)},r.prototype.flow=function(t,i,n,r,s,o){this._mode=e.FLOW,this.on=!0,(void 0===i||0===i)&&(i=1),void 0===n&&(n=-1),void 0===r&&(r=!0),i>this._maxParticles&&(i=this._maxParticles),this.frequency=t,this._flowCounter=0,this._flowQuantity=i,this._flowTotal=n,r&&(this.emitParticles(i,s,o),this._flowCounter+=i,this._timer=this.game.time.time+t*this.game.time.slowMotion)},r.prototype.killAllParticles=function(t){for(void 0===t&&(t=!0),this._mode=e.NONE;this._counterUsed>0;){var i=this._particlesUsed[--this._counterUsed];i.remove(),t||i.onKill(this),this._particlesPool[this._counterPool++]=i}},r.prototype.emitParticles=function(t,e,i){for(var n=0;t>n;n++){var r=this.emitParticle(this.forceEmit);if(null===r)break;void 0!==e&&null!==e&&e.call(i,r)}},r.prototype.emitParticle=function(t,e){if(void 0===t&&(t=!1),void 0===e&&(e=!1),0===this._counterPool){if(!t)return null;var n=this._particlesUsed[0];this._particlesUsed[0]=this._particlesUsed[--this._counterUsed],n.remove(),n.onKill(this),this._particlesPool[this._counterPool++]=n}var r=this._particlesPool[--this._counterPool];if(this._particlesUsed[this._counterUsed++]=r,r.on=!0,this.randomEmitPoint(this._emitPoint),r.visual.position.set(this._emitPoint.x,this._emitPoint.y),r.visual.angle=0,e)r.lifetime=-1,r.visual.scale.set(1,1),r.setScaleChange(i.NO_CHANGE),r.alpha=1,r.setAlphaChange(i.NO_CHANGE),r.setPhysics();else{if(r.lifetime=this.game.rnd.realInRange(this.minLifetime,this.maxLifetime),1!==this.minParticleScale||1!==this.maxParticleScale){var s=this.game.rnd.realInRange(this.minParticleScale,this.maxParticleScale);r.visual.scale.set(s,s)}else this._minParticleScale.x!==this._maxParticleScale.x||this._minParticleScale.y!==this._maxParticleScale.y?r.visual.scale.set(this.game.rnd.realInRange(this._minParticleScale.x,this._maxParticleScale.x),this.game.rnd.realInRange(this._minParticleScale.y,this._maxParticleScale.y)):r.visual.scale.set(1,1);r.setScaleChange(this.scaleChangeType,this.scaleChange),r.alpha=this.game.rnd.realInRange(this.minParticleAlpha,this.maxParticleAlpha),r.setAlphaChange(this.alphaChangeType,this.alphaChange),r.setPhysics(this.game.rnd.realInRange(this.minParticleSpeed.x,this.maxParticleSpeed.x),this.game.rnd.realInRange(this.minParticleSpeed.y,this.maxParticleSpeed.y),this.game.rnd.realInRange(this.minAngularSpeed,this.maxAngularSpeed),this.particleFriction,this.angularDrag,this.gravity),null!==this._frames&&r.setFrame(this.randomFrame())}return r.onEmit(this),this.particleBringToTop?r.bringToTop():this.particleSendToBack&&r.sendToBack(),r},r.prototype.destroy=function(){t.ParticlesManager.instance.remove(this),n.prototype.destroy.call(this,!0,!1)},r.prototype.randomFrame=function(){var t=null;return null!==this._frames&&(t=Array.isArray(this._frames)?"string"==typeof this._frames[0]?this.game.rnd.pick(this._frames):this.game.rnd.pick(this._frames):this._frames),t},r.prototype.randomEmitPoint=function(t){return this.area instanceof Phaser.Point?t.setTo(0,0):this.area.random(t),t.x+=this.emitPoint.x,t.y+=this.emitPoint.y,null!==this.emitObject&&(t.x+=this.emitObject.x,t.y+=this.emitObject.y),t},r.prototype.setXSpeed=function(t,e){t=t||0,e=e||0,this.minParticleSpeed.x=t,this.maxParticleSpeed.x=e},r.prototype.setYSpeed=function(t,e){t=t||0,e=e||0,this.minParticleSpeed.y=t,this.maxParticleSpeed.y=e},r.prototype.setAngularSpeed=function(t,e){t=t||0,e=e||0,this.minAngularSpeed=t,this.maxAngularSpeed=e},r.prototype.setAlpha=function(t,e){void 0===t&&(t=1),void 0===e&&(e=1),this.minParticleAlpha=t,this.maxParticleAlpha=e},r.prototype.setAlphaChange=function(t,e,n){switch(void 0===e&&(e=0),void 0===n&&(n=0),this.alphaChangeType=t,t){case i.NO_CHANGE:this.alphaChange=0;break;case i.IN_TIME:0===n&&(n=1),this.alphaChange=e/n}},r.prototype.setScale=function(t,e,i,n){void 0===t&&(t=1),void 0===e&&(e=1),void 0===i&&(i=1),void 0===n&&(n=1),this._minParticleScale.setTo(t,i),this._maxParticleScale.setTo(e,n)},r.prototype.setScaleChange=function(t,e,n){switch(void 0===e&&(e=0),void 0===n&&(n=0),this.scaleChangeType=t,t){case i.NO_CHANGE:this.scaleChange=0;break;case i.IN_TIME:0===n&&(n=1),this.scaleChange=e/n}},r.prototype.emitAt=function(t,e){this.emitPoint.setTo(t,e)},r.prototype.emitAtObject=function(t){t.center?this.emitPoint.setTo(t.center.x,t.center.y):this.emitPoint.setTo(t.x,t.y)},r.MAX_PARTICELES=16,r}(Phaser.Group);t.ParticlesEmitter=n}(Leto||(Leto={}));var Leto;!function(t){var e=function(){function t(){this._emitters=[],this._emittersCount=0}return Object.defineProperty(t,"instance",{get:function(){return null===t._instance&&(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.add=function(t){this._emitters[this._emittersCount++]=t},t.prototype.remove=function(t){for(var e=this._emittersCount-1;e>=0&&this._emitters[e]!==t;e--);-1!==e&&(this._emitters[e]=this._emitters[--this._emittersCount])},t.prototype.update=function(){for(var t=0;t<this._emittersCount;t++){var e=this._emitters[t];e.exists&&e.update()}},t._instance=null,t}();t.ParticlesManager=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.setFrame=function(t){var e=this._visual;"string"==typeof t?e.frameName=t:e.frame=t},e.prototype.onCreate=function(t){var e=new Phaser.Sprite(this._game,0,0,this._textureKey);e.anchor.setTo(.5,.5),this._visual=e},e}(t.Particle);t.SpriteParticle=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(t){function e(e,i,n,r,s){t.call(this,e,i,n,r),void 0!==s&&this.setAnchoredFrame(s)}return __extends(e,t),e.prototype.setAnchoredFrame=function(t){if("string"==typeof this.key){var e=null;"string"==typeof t?(this.frameName=t,e=this.game.cache.getFrameByName(this.key,t)):(this.frame=t,e=this.game.cache.getFrameByIndex(this.key,t)),void 0!==e.anchorX&&void 0!==e.anchorY&&this.anchor.setTo(e.anchorX,e.anchorY)}},e}(Phaser.Sprite);t.AnchoredSprite=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(e){function i(i,n){e.call(this,i,n),this._hills=new t.BgHills(i,this),this._trees=new t.BgTrees(i,this),this._water=new t.BgWater(i,this),this._clouds=new t.Clouds(i,this)}return __extends(i,e),i.prototype.updatePosition=function(e,i){this._hills.updatePosition(e),this._trees.updatePosition(e),this._clouds.updatePosition(e),this._hills.y=Phaser.Math.clamp((-i-32)/2,-24,0),this._trees.y=Phaser.Math.clamp((-i-32)/1.5,-24,0)+32,t.Global.paralax&&(this._water.y=-i)},i}(Phaser.Group);t.Background=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(t){function e(e,i){t.call(this,e,i);var n=e.cache.getFrameByName("Sprites","bg_mountains"),r=e.add.sprite(0,0,"Sprites","bg_mountains",this);r.fixedToCamera=!0,this._hill1Crop=new Phaser.Rectangle(0,0,0,n.height),r.crop(this._hill1Crop,!1),this._hill1=r,r=e.add.sprite(0,0,"Sprites","bg_mountains",this),r.fixedToCamera=!0,this._hill2Crop=new Phaser.Rectangle(0,0,0,n.height),r.crop(this._hill2Crop,!1),this._hill2=r}return __extends(e,t),e.prototype.updatePosition=function(t){t/=4,0>t&&(t+=640);var e=Math.floor(t)%640;this._hill1Crop.x=e,this._hill1Crop.width=640-e,this._hill1.updateCrop(),this._hill2Crop.width=e,this._hill2.cameraOffset.x=640-e,this._hill2.updateCrop()},e}(Phaser.Group);t.BgHills=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(e){function i(i,n){e.call(this,i,n);var r=t.Global.paralax?32:0,s=i.add.sprite(0,i.height+r,"Sprites","voda",this);s.anchor.set(0,1),s.width=i.width,s.height+=r,s.fixedToCamera=!0}return __extends(i,e),i}(Phaser.Group);t.BgWater=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(t){function e(e,i){t.call(this,e,i);var n=e.cache.getFrameByName("Sprites","voda"),r=e.cache.getFrameByName("Sprites","bg_trees"),s=e.add.sprite(0,e.height-n.height,"Sprites","bg_trees",this);s.anchor.y=1,s.fixedToCamera=!0,this._trees1Crop=new Phaser.Rectangle(0,0,0,r.height),s.crop(this._trees1Crop,!1),this._trees1=s,s=e.add.sprite(0,e.height-n.height,"Sprites","bg_trees",this),s.anchor.y=1,s.fixedToCamera=!0,this._trees2Crop=new Phaser.Rectangle(0,0,0,r.height),s.crop(this._trees2Crop,!1),this._trees2=s}return __extends(e,t),e.prototype.updatePosition=function(t){t/=2,0>t&&(t+=640);var e=Math.floor(t)%640;this._trees1Crop.x=e,this._trees1Crop.width=640-e,this._trees1.updateCrop(),this._trees2Crop.width=e,this._trees2.cameraOffset.x=640-e,this._trees2.updateCrop()},e}(Phaser.Group);t.BgTrees=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.init=function(){var t=this.game.camera.x-this.parent.x+this.game.width+this.game.rnd.integerInRange(0,640);this.position.set(t,this.game.rnd.integerInRange(0,e.Y_MAX));var i=0===this.game.rnd.integerInRange(0,1)?-1:1,n=this.game.rnd.realInRange(.5,1.5);this.scale.set(n*i,n),this.anchor.x=1===i?0:1,this._speed=e.SPEED_PX_IN_SEC*n*5,this.frameName="cloud"+this.game.rnd.integerInRange(0,1),this.exists=!0,this.visible=!0},e.prototype.updateCloud=function(){this.position.x+=this._speed*this.game.time.physicsElapsed;var t=this.x-(this.game.camera.x-this.parent.x);(t<-e.SIZE_MAX*Math.abs(this.scale.x)||t>2*this.game.width)&&this.kill()},e.SIZE_MAX=160,e.Y_MAX=100,e.SPEED_PX_IN_SEC=-5,e}(Phaser.Sprite);t.Cloud=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(e){function i(n,r){e.call(this,n,r),this._clouds=[];for(var s=0;s<i.MAX;s++){var o=new t.Cloud(n,0,0,"Sprites");o.kill(),this.add(o),this._clouds[s]=o}}return __extends(i,e),i.prototype.updatePosition=function(t){this.x=t/2;for(var e=0;e<i.MAX;e++){var n=this._clouds[e];n.exists?n.updateCloud():n.init()}},i.MAX=3,i}(Phaser.Group);t.Clouds=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(){function e(t){this._rnd=t}return e.prototype.reset=function(){this._jumpProb=t.Gameplay.JUMP_PROB_MIN,this._jumpsCount=t.Gameplay.JUMPS_COUNT_MIN,this._spikesProb=t.Gameplay.SPIKES_PROB_MIN,this._platformLengthMax=t.Gameplay.PLATFORM_LENGTH_MAX,this._jumpLengthDecrease=t.Gameplay.JUMP_LENGTH_DECREASER_MIN},Object.defineProperty(e.prototype,"jumpProb",{get:function(){return this._rnd.integerInRange(0,99)<this._jumpProb},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"jumpCount",{get:function(){return this._rnd.integerInRange(t.Gameplay.JUMPS_COUNT_MIN,this._jumpsCount)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spikesProb",{get:function(){return this._rnd.integerInRange(0,99)<this._spikesProb},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"platformLength",{get:function(){return this._rnd.integerInRange(t.Gameplay.PLATFORM_LENGTH_MIN,this._platformLengthMax)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"jumpLengthDecrease",{get:function(){return this._jumpLengthDecrease},enumerable:!0,configurable:!0}),e.prototype.update=function(e){this._tile=Math.floor(e);var i=0;e>=t.Gameplay.JUMP_PROB_START_TILES?(i=(e-t.Gameplay.JUMP_PROB_START_TILES)/t.Gameplay.JUMP_PROB_STEP_TILES,
i=Math.max(0,i),this._jumpProb=Math.min(Math.floor(t.Gameplay.JUMP_PROB_MIN+i),t.Gameplay.JUMP_PROB_MAX)):this._jumpProb=0,i=(e-t.Gameplay.JUMPS_COUNT_START_TILES)/t.Gameplay.JUMPS_COUNT_STEP_TILES,i=Math.max(0,i),this._jumpsCount=Math.min(Math.floor(t.Gameplay.JUMPS_COUNT_MIN+i),t.Gameplay.JUMPS_COUNT_MAX),e>=t.Gameplay.SPIKES_PROB_START_TILES?(i=(e-t.Gameplay.SPIKES_PROB_START_TILES)/t.Gameplay.SPIKES_PROB_STEP_TILES,i=Math.max(0,i),this._spikesProb=Math.min(Math.floor(t.Gameplay.SPIKES_PROB_MIN+i),t.Gameplay.SPIKES_PROB_MAX)):this._spikesProb=0,e>=t.Gameplay.PLATFORM_LENGTH_DECREASER_START_TILES?(i=(e-t.Gameplay.PLATFORM_LENGTH_DECREASER_START_TILES)/t.Gameplay.PLATFORM_LENGTH_DECREASER_STEP_TILES,i=Math.max(t.Gameplay.PLATFORM_LENGTH_DECREASER_MAX,-Math.max(0,i)),this._platformLengthMax=Math.floor(t.Gameplay.PLATFORM_LENGTH_MAX+i)):this._platformLengthMax=t.Gameplay.PLATFORM_LENGTH_MAX,e>=t.Gameplay.JUMP_LENGTH_DECREASER_START_TILES?(i=(e-t.Gameplay.JUMP_LENGTH_DECREASER_START_TILES)/t.Gameplay.JUMP_LENGTH_DECREASER_STEP_TILES,i=Math.max(0,Math.floor(i)),this._jumpLengthDecrease=Math.min(t.Gameplay.JUMP_LENGTH_DECREASER_MIN+i,t.Gameplay.JUMP_LENGTH_DECREASER_MAX)):this._platformLengthMax=t.Gameplay.JUMP_LENGTH_DECREASER_MIN},e.prototype.toString=function(){return"[tile: "+this._tile+"], jumpProb: "+this._jumpProb+", jumpCount: "+this._jumpsCount+", spikesProb: "+this._spikesProb+", platformLengthMax: "+this._platformLengthMax},e}();t.Difficulty=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(t){function e(){t.apply(this,arguments),this._flag=0}return __extends(e,t),Object.defineProperty(e.prototype,"flag",{get:function(){return this._flag},set:function(t){this._flag=t},enumerable:!0,configurable:!0}),e}(t.AnchoredSprite);t.FlaggedSprite=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(){function e(e,i){this._tilePos=new t.TilePos(0,0),this._tooCloseBy=0,this._spikesPattern=0,this._rnd=e.rnd,this._jumpTables=i}return Object.defineProperty(e,"lastGeneratedPiece",{get:function(){return e._lastGeneratedPiece},set:function(t){e._lastGeneratedPiece=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tilePos",{get:function(){return this._tilePos},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offsetY",{get:function(){return this._offsetY},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offsetX",{get:function(){return this._offsetX},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"platform",{get:function(){return this._platform},set:function(t){this._platform=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spikesPattern",{get:function(){return this._spikesPattern},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bonusJump",{get:function(){return this._bonusJump},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"girl",{get:function(){return this._girl},set:function(t){this._girl=t},enumerable:!0,configurable:!0}),e.prototype.set=function(t,e,i,n,r){void 0===n&&(n=0),void 0===r&&(r=0),this._tilePos.set(t,e),this._length=i,this._offsetX=n,this._offsetY=r,this._platform=!1,this._tooCloseBy=0,this._spikesPattern=0,this._bonusJump=!1,this._girl=!1},e.prototype.create=function(i,n,r,s,o,a,h){void 0===h&&(h=!1);var l,p=t.Gameplay.UBOUND,u=t.Gameplay.LBOUND,c=this._jumpTables.minY(),_=-c,f=i.y-p;s!==e.UNDEFINED?l=s:(l=this._rnd.integerInRange(0,u-p),l-=f,l=Phaser.Math.clamp(l,c,_));var m=Phaser.Math.clamp(f+l,0,u-p);if(s!==e.UNDEFINED&&m!==f+l)return null;this.tilePos.y=m+p;var d,g=null!==e._lastGeneratedPiece?e._lastGeneratedPiece._tooCloseBy:0;if((o||null!==e._lastGeneratedPiece&&e._lastGeneratedPiece.bonusJump)&&(g=2),r!==e.UNDEFINED)d=r;else{var y=this._jumpTables.maxX(m-f),T=this._jumpTables.minX(m-f);y=o?Math.max(T,y-1):Math.max(T,y+a.jumpLengthDecrease),d=this._rnd.integerInRange(Math.max(T-2+g,1),y),this._tooCloseBy=Math.max(T-d,0)}if(this.tilePos.x=i.x+d,this._offsetY=this.tilePos.y-i.y,this._offsetX=this.tilePos.x-i.x,n===e.UNDEFINED?this._length=a.platformLength:this._length=n,this._girl=h,h)this._spikesPattern=0,this.length=7;else if(null!==e._lastGeneratedPiece&&0===e._lastGeneratedPiece.spikesPattern&&!o&&a.spikesProb){this._length=this._rnd.integerInRange(5,9);var v=t.BlockDefs.SPIKE_PATTERNS[this._length];this._spikesPattern=v[this._rnd.integerInRange(0,v.length-1)]}else this._spikesPattern=0;this._bonusJump=o;var b=100-20*m;return this._platform=this._rnd.integerInRange(0,99)<b,e._lastGeneratedPiece=this,this},e.UNDEFINED=-1e4,e._lastGeneratedPiece=null,e}();t.GenPiece=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(){function t(){this.jumpHeightIndex=0,this.startX=0,this.offsetX=0,this.offsetY=0,this.distX=0,this.mustBeFree=null,this.mustBeFreeCount=0}return t.prototype.toString=function(){return"jumpIdx: "+this.jumpHeightIndex+", startX: "+this.startX+", offsetY: "+this.offsetY+", offsetX: "+this.offsetX+", distX: "+this.distX+", freeCount: "+this.mustBeFreeCount},t}();t.Jump=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(){function t(){this._jumpYMin=0,this._freeLists=[],this._jumpDefs=[],this._jumpYMins=[],this._jumpXMaxs={},this._jumpXMins={}}return t.prototype.minY=function(t){return void 0===t&&(t=-1),-1===t?this._jumpYMin:this._jumpYMins[t]},t.prototype.maxX=function(t){var e=this._jumpXMaxs[t];return e},t.prototype.minX=function(t){var e=this._jumpXMins[t];return e},t.prototype.addFreeList=function(t){this._freeLists.push(t)},t.prototype.addJumps=function(t,e,i){(void 0===this._jumpDefs[t]||null===this._jumpDefs[t])&&(this._jumpDefs[t]=[]),this._jumpDefs[t][e]=i},t.prototype.analyze=function(){this._jumpYMin=0;for(var t=1;t<this._jumpDefs.length;t++){this._jumpYMins[t]=0;for(var e=this._jumpDefs[t][0],i=0;i<e.length;i++){var n=e[i];this._jumpYMins[t]=Math.min(this._jumpYMins[t],n.offsetY)}this._jumpYMin=Math.min(this._jumpYMin,this._jumpYMins[t])}for(var t=1;t<this._jumpDefs.length;t++){this._jumpXMaxs[t]=0,this._jumpXMins[t]=0;for(var e=this._jumpDefs[t][this._jumpDefs[t].length-1],i=0;i<e.length;i++){var n=e[i],r=this._jumpXMaxs[n.offsetY];this._jumpXMaxs[n.offsetY]=void 0!==r?Math.max(r,n.offsetX):n.offsetX}e=this._jumpDefs[t][0];for(var i=0;i<e.length;i++){var n=e[i],s=this._jumpXMins[n.offsetY];this._jumpXMins[n.offsetY]=void 0!==s?Math.max(s,n.offsetX):n.offsetX}}},t}();t.JumpTables=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(e){function i(i,n,r){e.call(this,i),this._lastTile=new t.TilePos(0,0),this._genPiecesQueue=[],this._helpTilePos=new t.TilePos(0,0),this._girlTime=!1,this._heartsTime=!1,this._jumpTables=n,this._parent=r,this._difficulty=new t.Difficulty(i.rnd),this._outerWallsPool=new t.Pool(t.FlaggedSprite,32,function(){var e=new t.FlaggedSprite(i,0,0,"Sprites");e.flag=0,i.physics.enable(e,Phaser.Physics.ARCADE);var n=e.body;return n.allowGravity=!1,n.immovable=!0,n.moves=!1,e}),this._outerWallsPool.name="OUTER",this._innerWallsPool=new t.Pool(t.FlaggedSprite,32,function(){var e=new t.FlaggedSprite(i,0,0,"Sprites");return e.flag=1,e}),this._innerWallsPool.name="INNER",this._objectsPool=new t.Pool(t.FlaggedSprite,16,function(){var e=new t.FlaggedSprite(i,0,0,"Sprites","Spikes0");e.flag=2,i.physics.enable(e,Phaser.Physics.ARCADE);var n=e.body;return n.setSize(40,32,6,10),n.allowGravity=!1,n.immovable=!0,n.moves=!1,e.animations.add("spike",t.BlockDefs.SPIKE_ANIM,4,!0),e.animations.add("bonus_jump",t.BlockDefs.BONUS_JUMP_ANIM,16,!0),e}),this._walls=this.game.add.group(this,"walls"),this._shadow=new Phaser.Sprite(this.game,0,-300,"Sprites","stin"),this._shadow.anchor.set(.5,.5),this.add(this._shadow),this._objects=this.game.add.group(this,"spikes"),this._genPiecesQueueTop=0,this._genPiecesPool=new t.Pool(t.GenPiece,32,function(){var e=new t.GenPiece(i,n);return e}),this.reset()}return __extends(i,e),i.prototype.render=function(){this._walls.forEachExists(function(t){this.game.debug.body(t)},this),this._objects.forEachExists(function(t){this.game.debug.body(t)},this)},Object.defineProperty(i.prototype,"shadow",{get:function(){return this._shadow},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"walls",{get:function(){return this._walls},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"spikes",{get:function(){return this._objects},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"heartsTime",{set:function(t){this._heartsTime=t},enumerable:!0,configurable:!0}),i.prototype.reset=function(){this._difficulty.reset(),this._girlTime=!1,this._heartsTime=!1,this._shadow.visible=!1,this.clearTiles(0,!0);for(var e=null;null!==(e=this.getPieceFromQueue());)this._genPiecesPool.destroyItem(e);this._lastTile.set(0,0),t.GenPiece.lastGeneratedPiece=null,e=this._genPiecesPool.createItem(),e.set(0,5,11),this.putPieceIntoQueue(e),this._state=0,this.generate(0)},Object.defineProperty(i.prototype,"girlTime",{set:function(t){this._girlTime=t},enumerable:!0,configurable:!0}),i.prototype.clearTiles=function(e,i){void 0===i&&(i=!1),e*=t.Gameplay.GRID_SIZE,this._walls.forEachExists(function(t){(t.x-e<=-128||i)&&(t.exists=!1,t.visible=!1,0===t.flag?this._outerWallsPool.destroyItem(t):1===t.flag&&this._innerWallsPool.destroyItem(t))},this),this._objects.forEachExists(function(t){(t.x-e<=-128||i)&&(t.exists=!1,t.visible=!1,this._objectsPool.destroyItem(t))},this)},i.prototype.getObjectOfFlag=function(t){for(var e=0;e<this._objects.length;e++){var i=this._objects.getChildAt(e);if(i.flag===t)return i}return null},i.prototype.addBonus=function(t,e){var i=this._objectsPool.createItem();i.flag=3,i.anchor.set(.5,.5),i.position.set(64*t+32,64*e-32),i.body.setSize(52,52,0,0),i.exists=!0,i.visible=!0,i.animations.play("bonus_jump");var n=this.getObjectOfFlag(3);null!==n&&(i.animations.currentAnim._frameIndex=n.animations.currentAnim._frameIndex,i.animations.currentAnim._timeNextFrame=n.animations.currentAnim._timeNextFrame),null===i.parent&&this._objects.add(i)},i.prototype.removeBonus=function(t){t.exists=!1,t.visible=!1,this._objectsPool.destroyItem(t)},i.prototype.addBlock=function(e,i,n,r,s){var o;o=r?t.BlockDefs.PLATFORM:i===t.Gameplay.LBOUND?t.BlockDefs.GROUND_0:i===t.Gameplay.LBOUND-1?t.BlockDefs.GROUND_1:t.BlockDefs.BLOCK;for(var a=o===t.BlockDefs.BLOCK?t.Gameplay.LBOUND-i:o.length-1,h=0;a>=h;h++){var l=i+h,p=void 0;p=o===t.BlockDefs.BLOCK?h===a?o[3][n]:h>=2?o[2][n]:o[h][n]:o[h][n];var u=1!==n||0===h,c=u?this._outerWallsPool.createItem():this._innerWallsPool.createItem();if(c.setAnchoredFrame(p),c.position.set(64*e,64*l),u){var _=this.game.cache.getFrameByName("Sprites",p),f=c.body,m=Math.floor(c.width*c.anchor.x),d=Math.floor(c.height*c.anchor.y);f.setSize(Math.min(64,_.width-m),Math.min(64,_.height-d),m,d)}if(c.exists=!0,c.visible=!0,null===c.parent&&this._walls.add(c),s&&0===h){var g=this._objectsPool.createItem();g.flag=2,g.setAnchoredFrame("Spikes0"),g.position.set(64*e+32,64*l),g.body.setSize(40,32,6,10),g.exists=!0,g.visible=!0,g.animations.play("spike");var y=this.getObjectOfFlag(2);null!==y&&(g.animations.currentAnim._frameIndex=y.animations.currentAnim._frameIndex,g.animations.currentAnim._timeNextFrame=y.animations.currentAnim._timeNextFrame),null===g.parent&&this._objects.add(g)}}},i.prototype.getPieceFromQueue=function(){if(0===this._genPiecesQueueTop)return null;for(var t=this._genPiecesQueue[0],e=0;e<this._genPiecesQueueTop-1;e++)this._genPiecesQueue[e]=this._genPiecesQueue[e+1];return this._genPiecesQueue[--this._genPiecesQueueTop]=null,t},i.prototype.putPieceIntoQueue=function(t){this._genPiecesQueue[this._genPiecesQueueTop++]=t},i.prototype.generate=function(e){this.clearTiles(e),this._difficulty.update(e);for(var n=t.Global.GAME_WIDTH/t.Gameplay.GRID_SIZE+4;this._lastTile.x-e<n;)switch(this._state){case 0:0===this._genPiecesQueueTop;var r=this.getPieceFromQueue();this._lastTile.copyFrom(r.tilePos),this._platformLength=r.length;for(var s=r.girl,o=0;this._platformLength>0;)1===this._platformLength&&(o=2),r.bonusJump?this.addBonus(this._lastTile.x,this._lastTile.y):(this.addBlock(this._lastTile.x,this._lastTile.y,o,r.platform,(r.spikesPattern>>this._platformLength-1&1)>0),r.girl&&(this._parent.placeGirl(this._lastTile.x+r.length/2,this._lastTile.y),r.girl=!1),this._heartsTime&&!s&&(this._heartsTime=!1,this.addBonus(this._lastTile.x+r.length/2-.5,this._lastTile.y-1))),--this._platformLength>0&&++this._lastTile.x,o=1;this._genPiecesPool.destroyItem(r),0===this._genPiecesQueueTop&&(this._state=1);break;case 1:var a=this.game.rnd.integerInRange(0,99);this._difficulty.jumpProb?this.generateBonusJump():a<i.GEN_RANDOM?this.generateRandomly():a<i.GEN_PATTERN&&this.generatePattern(),this._state=0}},i.prototype.girl=function(){return this._girlTime&&this._parent.girlAvailable()?(this._girlTime=!1,!0):!1},i.prototype.generateRandomly=function(){var e=this._genPiecesPool.createItem();e.create(this._lastTile,t.GenPiece.UNDEFINED,t.GenPiece.UNDEFINED,t.GenPiece.UNDEFINED,!1,this._difficulty,this.girl()),this.putPieceIntoQueue(e)},i.prototype.generatePattern=function(){var e=this._genPiecesQueueTop;this._helpTilePos.copyFrom(this._lastTile);var n=t.GenPiece.UNDEFINED;this.game.rnd.integerInRange(0,99)<i.KEEP_LENGTH&&(n=this.game.rnd.integerInRange(2,5));for(var r=this.game.rnd.integerInRange(0,99)<99,s=2,o=0;s>o;o++){var a=this._genPiecesPool.createItem();a.create(this._helpTilePos,n,t.GenPiece.UNDEFINED,t.GenPiece.UNDEFINED,!1,this._difficulty,this.girl()),this._helpTilePos.copyFrom(a.tilePos),this._helpTilePos.x+=a.length-1,r&&o>0&&(a.platform=this._genPiecesQueue[e].platform),this.putPieceIntoQueue(a)}for(var o=0;1>o;o++)for(var h=0;s>h;h++){var l=this._genPiecesQueue[e+h],a=this._genPiecesPool.createItem();if(!a.create(this._helpTilePos,n,l.offsetX,l.offsetY,!1,this._difficulty))return void this._genPiecesPool.destroyItem(a);this._helpTilePos.copyFrom(a.tilePos),this._helpTilePos.x+=a.length-1,r&&o>0&&(a.platform=l.platform),this.putPieceIntoQueue(a)}},i.prototype.generateBonusJump=function(){for(var e=this._difficulty.jumpCount,i=null,n=0;e>n;n++){var r=this._genPiecesPool.createItem();if(null===i)r.create(this._lastTile,1,t.GenPiece.UNDEFINED,t.GenPiece.UNDEFINED,!0,this._difficulty);else if(null===r.create(i.tilePos,1,i.offsetX,i.offsetY,!0,this._difficulty))return void this._genPiecesPool.destroyItem(r);this.putPieceIntoQueue(r),i=r}},i.GEN_RANDOM=50,i.GEN_PATTERN=i.GEN_RANDOM+50,i.KEEP_LENGTH=75,i}(Phaser.Group);t.Generator=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(t){function e(e,i){t.call(this,e,i),(void 0===i||null!==i)&&(this._parent=i[0])}return __extends(e,t),e.prototype.onEmit=function(t){this._parent.add(this._visual)},e}(t.SpriteParticle);t.OtherParentParticle=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(e){function i(i,n){e.call(this,i,0,0,"Sprites","Hero"),this._playState=n;var r=new Spriter.Loader,s=new Spriter.SpriterXml(i.cache.getXML("PlayerAnim")),o=r.load(s);this._spriterGroup=new Spriter.SpriterGroup(this.game,o,"Sprites","panak","beh",200),this._spriterGroup.position.setTo(0,0),this._spriterGroup.position.set(10,87),this.addChild(this._spriterGroup);var a=new t.ParticlesEmitter(this.game,0,0,32);a.particleClass=t.SplashParticle,a.position.set(15,70),a.lifetime=1.2,a.setXSpeed(-200,200),a.setYSpeed(-500,-200),a.setAngularSpeed(0,0),a.minParticleScale=.5,a.maxParticleScale=2,a.setScaleChange(t.eParameterChangeType.IN_TIME,-1,1.2),a.gravity=800,a.makeParticles("Sprites","Splash"),this._splashEmitter=a,this.addChild(a)}return __extends(i,e),i.prototype.clearParticles=function(){this._splashEmitter.killAllParticles()},i.prototype.animateJump=function(){this._spriterGroup.playAnimationByName("vyskok"),this._spriterGroup.setAnimationSpeedPercent(200),Utils.AudioUtils.playSound("skok")},i.prototype.animateDeath=function(){this._spriterGroup.playAnimationByName("padani voda"),this._spriterGroup.setAnimationSpeedPercent(100),Utils.AudioUtils.playSound("konec")},i.prototype.animateHit=function(){this._spriterGroup.playAnimationByName("zasah"),this._spriterGroup.setAnimationSpeedPercent(200),Utils.AudioUtils.playSound("kolize")},i.prototype.updateAnim=function(t,e,i){i||(t?"beh"!==this._spriterGroup.currentAnimationName&&(this._spriterGroup.playAnimationByName("beh"),this._spriterGroup.setAnimationSpeedPercent(200),Utils.AudioUtils.playSound("dopad")):e>0&&"padani"!==this._spriterGroup.currentAnimationName&&(this._spriterGroup.playAnimationByName("padani"),this._spriterGroup.setAnimationSpeedPercent(100))),this._spriterGroup.updateAnimation(),this._splashEmitter.update()},i.prototype.postUpdate=function(){e.prototype.postUpdate.call(this);var i=this.body,n=t.Global.paralax?17:0;this.y>t.Global.GAME_HEIGHT-140+n&&(this.y=t.Global.GAME_HEIGHT-140+n,i.velocity.set(0,0),i.allowGravity=!1,this._playState.setGameOver(),this.animateDeath(),this._splashEmitter.explode(32))},i}(Phaser.Sprite);t.Player=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.update=function(e){void 0===e&&(e=!0);var i=1-Phaser.Math.clamp(this.lifetime/1.2,0,1),n=Phaser.Math.linear(142,255,i),r=Phaser.Math.linear(229,255,i),s=(n<<16)+(r<<8)+255;return this.visual.tint=s,t.prototype.update.call(this,e)},e}(t.SpriteParticle);t.SplashParticle=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(){function t(t,e){this.set(t,e)}return t.prototype.set=function(t,e){this.x=t,this.y=e},t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},t}();t.TilePos=e}(Leto||(Leto={}));var Spriter;!function(t){var e=function(){function t(){this._items=[],this._itemNames=[]}return t.prototype.add=function(t,e,i){void 0===e&&(e=this._items.length),(void 0===i||null===i)&&(i="item_"+e),this._items[e]=t,this._itemNames[i]=e},t.prototype.getById=function(t){return this._items[t]},t.prototype.getByName=function(t){var e=this._itemNames[t];return"number"==typeof e?this._items[e]:null},Object.defineProperty(t.prototype,"length",{get:function(){return this._items.length},enumerable:!0,configurable:!0}),t}();t.IdNameMap=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(){function t(){this.reset()}return Object.defineProperty(t.prototype,"current",{get:function(){return this._line.at(this._currentIndex)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentIndex",{get:function(){return this._currentIndex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"next",{get:function(){return this._line.at(this._nextIndex)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextIndex",{get:function(){return this._nextIndex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lastTime",{set:function(t){this._lastTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"line",{get:function(){return this._line},set:function(t){this._line=t},enumerable:!0,configurable:!0}),t.prototype.reset=function(){this._lastTime=-1,this._currentIndex=-1,this._nextIndex=0},t.prototype.step=function(t){var e=this._nextIndex,i=this._line.keys[e],n=i.time,r=t<this._lastTime;return!r&&n>this._lastTime&&t>=n||r&&(n>this._lastTime||t>=n)?(this._lastTime=n,this._currentIndex=e,++e>=this._line.keys.length&&(e=0),this._nextIndex=e,i):null},t}();t.LineStepper=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(){function e(){}return e.prototype.load=function(e){this._spriter=new t.Spriter,this._fileType=e.getType();var i=e.getNodes("folder");this.loadFolders(this._spriter,i),i.processed();var n=e.getNodes("tag_list");this.loadTags(this._spriter,n),n.processed();var r=e.getNodes("entity");return this.loadEntities(this._spriter,r),r.processed(),this._spriter},e.prototype.loadFolders=function(t,e){for(var i=0;i<e.length();i++){var n=e.getFolder(i),r=e.getChildNodes(i,"file");this.loadFiles(n,r),r.processed(),t.addFolder(n)}},e.prototype.loadFiles=function(t,e){for(var i=0;i<e.length();i++){var n=e.getFile(i);null!==n&&t.addFile(n)}},e.prototype.loadTags=function(t,e){if(0!==e.length()){for(var i=e.getChildNodes(0,"i"),n=0;n<i.length();n++){var r=i.getTag(n);t.addTag(r)}i.processed()}},e.prototype.loadEntities=function(t,e){for(var i=0;i<e.length();i++){var n=e.getEntity(i),r=e.getChildNodes(i,"obj_info");this.loadObjInfo(n,r),r.processed();var s=e.getChildNodes(i,"character_map");this.loadCharMaps(n,s),s.processed();var o=e.getChildNodes(i,"var_defs");this.loadVariables(n,o),o.processed();var a=e.getChildNodes(i,"animation");this.loadAnimations(n,a),a.processed(),t.addEntity(n)}},e.prototype.loadObjInfo=function(t,e){for(var i=0;i<e.length();i++){var n=e.getObjectInfo(i);t.addObjectInfo(n)}},e.prototype.loadCharMaps=function(t,e){for(var i=0;i<e.length();i++){var n=e.getCharMap(i),r=e.getChildNodes(i,"map");this.loadCharMapEntries(n,r),r.processed(),t.addCharMap(n)}},e.prototype.loadCharMapEntries=function(t,e){for(var i=0;i<e.length();i++)e.getCharMapEntry(i,t,this._spriter)},e.prototype.loadVariables=function(e,i){if(0!==i.length()){var n;n=this._fileType!==t.eFileType.JSON?i.getChildNodes(0,"i"):i;for(var r=0;r<n.length();r++){var s=n.getVariable(r);e.addVariable(s)}this._fileType!==t.eFileType.JSON&&n.processed()}},e.prototype.loadAnimations=function(e,i){for(var n=0;n<i.length();n++){var r=i.getAnimation(n),s=i.getChildNodes(n,"mainline");this.loadMainline(r,s),s.processed();var o=i.getChildNodes(n,"timeline");this.loadTimelines(r,o),o.processed();var a=i.getChildNodes(n,"soundline");this.loadSoundlines(r,a),a.processed();var h=i.getChildNodes(n,"eventline");this.loadEventlines(r,h),h.processed();var l=i.getChildNodes(n,"meta");if(l.length()>0){var p=l.getChildNodes(0,this._fileType!==t.eFileType.JSON?"varline":"valline");this.loadVarlines(e,r,p),p.processed();var u=l.getChildNodes(0,"tagline");this.loadTaglines(r,u),u.processed()}l.processed(),e.addAnimation(r)}},e.prototype.loadMainline=function(e,i){var n=i.getMainline(0);n.type=t.eTimelineType.MAIN_LINE;var r=i.getChildNodes(0,"key");this.loadMainlineKeys(n,r),r.processed(),e.mainline=n},e.prototype.loadMainlineKeys=function(t,e){for(var i=0;i<e.length();i++){for(var n=e.getMainlineKey(i),r=e.getChildNodes(i,"bone_ref"),s=0;s<r.length();s++)n.addBoneRef(r.getRef(s));r.processed();for(var o=e.getChildNodes(i,"object_ref"),a=0;a<o.length();a++)n.addObjectRef(o.getRef(a));o.processed(),t.add(n)}},e.prototype.loadTimelines=function(t,e){for(var i=0;i<e.length();i++){var n=e.getTimeline(i),r=e.getChildNodes(i,"key");this.loadTimelineKeys(n,r),r.processed(),t.addTimeline(n)}},e.prototype.loadTimelineKeys=function(t,e){for(var i=0;i<e.length();i++){var n=e.getTimelineKey(i,this._spriter);t.add(n)}},e.prototype.loadSoundlines=function(e,i){for(var n=0;n<i.length();n++){var r=i.getSoundline(n);r.type=t.eTimelineType.SOUND_LINE;var s=i.getChildNodes(n,"key");this.loadKeys(r,s),s.processed(),e.addLine(r)}},e.prototype.loadKeys=function(t,e){for(var i=0;i<e.length();i++){var n=e.getKey(i);t.add(n)}},e.prototype.loadEventlines=function(e,i){for(var n=0;n<i.length();n++){var r=i.getEventline(n);r.type=t.eTimelineType.EVENT_LINE;var s=i.getChildNodes(n,"key");this.loadKeys(r,s),s.processed(),e.addLine(r)}},e.prototype.loadTaglines=function(e,i){for(var n=0;n<i.length();n++){var r=i.getTagline(n);r.type=t.eTimelineType.TAG_LINE;var s=i.getChildNodes(n,"key");this.loadTagKeys(r,s),s.processed(),e.addLine(r)}},e.prototype.loadTagKeys=function(t,e){for(var i=0;i<e.length();i++){var n=e.getTagKey(i),r=e.getChildNodes(i,"tag"),s=r.getTagChanges(this._spriter);r.processed(),n.tagsOn=s,t.add(n)}},e.prototype.loadVarlines=function(t,e,i){for(var n=0;n<i.length();n++){var r=i.getVarline(n),s=t.getVariableById(r.varDefId).type,o=i.getChildNodes(n,"key");this.loadVariableKeys(r,o,s),o.processed(),e.addLine(r)}},e.prototype.loadVariableKeys=function(t,e,i){for(var n=0;n<e.length();n++){var r=e.getVariableKey(n,i);t.add(r)}},e}();t.Loader=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(){function t(t,e){this._file=t,this._nodeList=e}return t.prototype.length=function(){return this._nodeList.length},t.prototype.processed=function(){this._file.processed()},t.prototype.getChildNodes=function(t,e){return this._file.getNodesForElement(this._nodeList[t],e)},t.prototype.getFolder=function(t){return this._file.getFolder(this._nodeList[t])},t.prototype.getFile=function(t){return this._file.getFile(this._nodeList[t])},t.prototype.getTag=function(t){return this._file.getTag(this._nodeList[t])},t.prototype.getEntity=function(t){return this._file.getEntity(this._nodeList[t])},t.prototype.getObjectInfo=function(t){return this._file.getObjectInfo(this._nodeList[t],t)},t.prototype.getCharMap=function(t){return this._file.getCharMap(this._nodeList[t])},t.prototype.getCharMapEntry=function(t,e,i){this._file.getCharMapEntry(this._nodeList[t],e,i)},t.prototype.getVariable=function(t){return this._file.getVariable(this._nodeList[t])},t.prototype.getAnimation=function(t){return this._file.getAnimation(this._nodeList[t])},t.prototype.getMainline=function(t){return this._file.getBaseline(this._nodeList[t])},t.prototype.getMainlineKey=function(t){return this._file.getMainlineKey(this._nodeList[t])},t.prototype.getRef=function(t){return this._file.getRef(this._nodeList[t])},t.prototype.getTimeline=function(t){return this._file.getTimeline(this._nodeList[t])},t.prototype.getSoundline=function(t){return this._file.getBaseline(this._nodeList[t])},t.prototype.getEventline=function(t){return this._file.getBaseline(this._nodeList[t])},t.prototype.getTagline=function(t){return this._file.getBaseline(this._nodeList[t])},t.prototype.getVarline=function(t){return this._file.getVarline(this._nodeList[t])},t.prototype.getKey=function(t){return this._file.getKey(this._nodeList[t])},t.prototype.getTagKey=function(t){return this._file.getTagKey(this._nodeList[t])},t.prototype.getVariableKey=function(t,e){return this._file.getVariableKey(this._nodeList[t],e)},t.prototype.getTimelineKey=function(t,e){return this._file.getTimelineKey(this._nodeList[t],t,e)},t.prototype.getTagChanges=function(t){for(var e=0,i=0;i<this.length();i++){var n=this._file.getTagChange(this._nodeList[i]);e|=1<<n}return e},t}();t.NodeListBin=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(){function t(t,e){this._file=t,this._nodeList=e,Array.isArray(e)||(e.length=1)}return t.prototype.length=function(){return this._nodeList.length},t.prototype.processed=function(){this._file.processed()},t.prototype.getNode=function(t){return Array.isArray(this._nodeList)?this._nodeList[t]:this._nodeList},t.prototype.getChildNodes=function(t,e){return this._file.getNodesForElement(this.getNode(t),e)},t.prototype.getFolder=function(t){return this._file.getFolder(this.getNode(t))},t.prototype.getFile=function(t){return this._file.getFile(this.getNode(t))},t.prototype.getTag=function(t){return this._file.getTag(this.getNode(t))},t.prototype.getEntity=function(t){return this._file.getEntity(this.getNode(t))},t.prototype.getObjectInfo=function(t){return this._file.getObjectInfo(this.getNode(t),t)},t.prototype.getCharMap=function(t){return this._file.getCharMap(this.getNode(t))},t.prototype.getCharMapEntry=function(t,e,i){this._file.getCharMapEntry(this.getNode(t),e,i)},t.prototype.getVariable=function(t){return this._file.getVariable(this.getNode(t))},t.prototype.getAnimation=function(t){return this._file.getAnimation(this.getNode(t))},t.prototype.getMainline=function(t){return this._file.getBaseline(this.getNode(t))},t.prototype.getMainlineKey=function(t){return this._file.getMainlineKey(this.getNode(t))},t.prototype.getRef=function(t){return this._file.getRef(this.getNode(t))},t.prototype.getTimeline=function(t){return this._file.getTimeline(this.getNode(t))},t.prototype.getSoundline=function(t){return this._file.getBaseline(this.getNode(t))},t.prototype.getEventline=function(t){return this._file.getBaseline(this.getNode(t))},t.prototype.getTagline=function(t){return this._file.getBaseline(this.getNode(t))},t.prototype.getVarline=function(t){return this._file.getVarline(this.getNode(t))},t.prototype.getKey=function(t){return this._file.getKey(this.getNode(t))},t.prototype.getTagKey=function(t){return this._file.getTagKey(this.getNode(t))},t.prototype.getVariableKey=function(t,e){return this._file.getVariableKey(this.getNode(t),e)},t.prototype.getTimelineKey=function(t,e){return this._file.getTimelineKey(this.getNode(t),t,e)},t.prototype.getTagChanges=function(t){for(var e=0,i=0;i<this.length();i++){var n=this._file.getTagChange(this.getNode(i));e|=1<<n}return e},t}();t.NodeListJSON=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(){function t(t,e){this._file=t,this._nodeList=e}return t.prototype.length=function(){return this._nodeList.length},t.prototype.processed=function(){this._file.processed()},t.prototype.getChildNodes=function(t,e){return this._file.getNodesForElement(this._nodeList.item(t),e)},t.prototype.getFolder=function(t){return this._file.getFolder(this._nodeList.item(t))},t.prototype.getFile=function(t){return this._file.getFile(this._nodeList.item(t))},t.prototype.getTag=function(t){return this._file.getTag(this._nodeList.item(t))},t.prototype.getEntity=function(t){return this._file.getEntity(this._nodeList.item(t))},t.prototype.getObjectInfo=function(t){return this._file.getObjectInfo(this._nodeList.item(t),t)},t.prototype.getCharMap=function(t){return this._file.getCharMap(this._nodeList.item(t))},t.prototype.getCharMapEntry=function(t,e,i){this._file.getCharMapEntry(this._nodeList.item(t),e,i)},t.prototype.getVariable=function(t){return this._file.getVariable(this._nodeList.item(t))},t.prototype.getAnimation=function(t){return this._file.getAnimation(this._nodeList.item(t))},t.prototype.getMainline=function(t){return this._file.getBaseline(this._nodeList.item(t))},t.prototype.getMainlineKey=function(t){return this._file.getMainlineKey(this._nodeList.item(t))},t.prototype.getRef=function(t){return this._file.getRef(this._nodeList.item(t))},t.prototype.getTimeline=function(t){return this._file.getTimeline(this._nodeList.item(t))},t.prototype.getSoundline=function(t){return this._file.getBaseline(this._nodeList.item(t))},t.prototype.getEventline=function(t){return this._file.getBaseline(this._nodeList.item(t))},t.prototype.getTagline=function(t){return this._file.getBaseline(this._nodeList.item(t))},t.prototype.getVarline=function(t){return this._file.getVarline(this._nodeList.item(t))},t.prototype.getKey=function(t){return this._file.getKey(this._nodeList.item(t))},t.prototype.getTagKey=function(t){return this._file.getTagKey(this._nodeList.item(t))},t.prototype.getVariableKey=function(t,e){return this._file.getVariableKey(this._nodeList.item(t),e)},t.prototype.getTimelineKey=function(t,e){return this._file.getTimelineKey(this._nodeList.item(t),t,e)},t.prototype.getTagChanges=function(t){for(var e=0,i=0;i<this.length();i++){var n=this._file.getTagChange(this._nodeList.item(i));e|=1<<n}return e},t}();t.NodeListXml=e}(Spriter||(Spriter={}));var Spriter;!function(t){!function(t){t[t.XML=0]="XML",t[t.JSON=1]="JSON",t[t.BIN=2]="BIN"}(t.eFileType||(t.eFileType={}));var e=(t.eFileType,function(){function t(){}return t.prototype.processed=function(){this.popMinDefsStack()},t.prototype.setMinimized=function(t,e){void 0===e&&(e=null),this._minimized=t,this._minDefs=e,t&&(this._minDefsStack=[],null===e)},t.prototype.getFileNameWithoutExtension=function(t){var e=t.split("\\").pop().split("/").pop().split(".")[0];return e},t.prototype.translateElementName=function(t){if(this._minimized){if(this._minDefs.name!==t)return t;null!==this._minDefs.minName&&(t=this._minDefs.minName)}return t},t.prototype.translateChildElementName=function(t){if(this._minimized&&null!==this._minDefs){var e=this._minDefs.childElements;null!==e&&(t=null===e[t]?t:e[t].minName)}return t},t.prototype.translateAttributeName=function(t){if(this._minimized&&null!==this._minDefs){
var e=this._minDefs.attributes;null!==e&&(t=null===e[t]?t:e[t])}return t},t.prototype.setMinDefsToElementName=function(t){if(this._minimized){this._minDefsStack.push(this._minDefs);var e=this._minDefs.childElements[t];this._minDefs=e}},t.prototype.popMinDefsStack=function(){this._minimized&&(this._minDefs=this._minDefsStack.pop())},t}());t.SpriterFile=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(e){function i(t){e.call(this),this._elements={spriter_data:1,folder:2,file:3,entity:4,obj_info:5,frames:6,i:7,animation:8,mainline:9,key:10,bone_ref:11,object_ref:12,timeline:13,bone:14,object:15},this._smallOffset=!1,this._bin=new DataView(t),this._smallOffset=1===this._bin.getUint8(0)}return __extends(i,e),i.prototype.getType=function(){return t.eFileType.BIN},i.prototype.readUint8=function(){return this._bin.getUint8(this._tmpPosition++)},i.prototype.readInt8=function(){return this._bin.getInt8(this._tmpPosition++)},i.prototype.readUint16=function(){var t=this._bin.getUint16(this._tmpPosition,!0);return this._tmpPosition+=2,t},i.prototype.readInt16=function(){var t=this._bin.getInt16(this._tmpPosition,!0);return this._tmpPosition+=2,t},i.prototype.readUint32=function(){var t=this._bin.getUint32(this._tmpPosition,!0);return this._tmpPosition+=4,t},i.prototype.readInt32=function(){var t=this._bin.getInt32(this._tmpPosition,!0);return this._tmpPosition+=4,t},i.prototype.readFixed16_16=function(){var t=this._bin.getInt32(this._tmpPosition,!0);return this._tmpPosition+=4,t/65536},i.prototype.readFixed1_7=function(){var t=255&this._bin.getInt8(this._tmpPosition++);return t/128},i.prototype.readString=function(){for(var t=[],e=this._bin.getUint8(this._tmpPosition++)-1;e>=0;e--)t.push(this._bin.getUint8(this._tmpPosition++));return String.fromCharCode.apply(null,t)},i.prototype.getNodes=function(e){return new t.NodeListBin(this,this.getSubNodesOfElementType(1,this._elements[e]))},i.prototype.getNodesForElement=function(e,i){return new t.NodeListBin(this,this.getSubNodesOfElementType(e,this._elements[i]))},i.prototype.getSubNodesOfElementType=function(t,e){var i=[],n=this._bin.getUint8(t+1);t+=2;for(var r=0;n>r;r++){var s=this._smallOffset?this._bin.getUint16(t+2*r,!0):this._bin.getUint32(t+4*r,!0),o=this._bin.getUint8(t+s);o===e&&i.push(t+s)}return i},i.prototype.getAttribsPosition=function(t){var e=this._bin.getUint8(t+1);return t+2+e*(this._smallOffset?2:4)},i.prototype.getFolder=function(e){this._tmpPosition=this.getAttribsPosition(e);for(var n=0,r="",s=this._bin.getUint8(this._tmpPosition++)-1;s>=0;s--)switch(this._bin.getUint8(this._tmpPosition++)){case i.ATTR_FOLDER_ID:n=this.readUint8();break;case i.ATTR_FOLDER_NAME:r=this.readString()}return new t.Folder(n,r)},i.prototype.getFile=function(e){this._tmpPosition=this.getAttribsPosition(e);for(var n=0,r="",s=0,o=0,a=this._bin.getUint8(this._tmpPosition++)-1;a>=0;a--)switch(this._bin.getUint8(this._tmpPosition++)){case i.ATTR_FILE_ID:n=this.readUint8();break;case i.ATTR_FILE_NAME:r=this.readString();break;case i.ATTR_FILE_PIVOT_X:s=this.readFixed16_16();break;case i.ATTR_FILE_PIVOT_Y:o=this.readFixed16_16();break;case i.ATTR_FILE_WIDTH:case i.ATTR_FILE_HEIGHT:this._tmpPosition+=2}return new t.File(n,this.getFileNameWithoutExtension(r),s,1-o)},i.prototype.getTag=function(t){return null},i.prototype.getEntity=function(e){this._tmpPosition=this.getAttribsPosition(e);for(var n=0,r="",s=this._bin.getUint8(this._tmpPosition++)-1;s>=0;s--)switch(this._bin.getUint8(this._tmpPosition++)){case i.ATTR_ENTITY_ID:n=this.readUint8();break;case i.ATTR_ENTITY_NAME:r=this.readString()}return new t.Entity(n,r)},i.prototype.getObjectInfo=function(e,n){this._tmpPosition=this.getAttribsPosition(e);for(var r="",s=t.eObjectType.SPRITE,o=0,a=0,h=this._bin.getUint8(this._tmpPosition++)-1;h>=0;h--)switch(this._bin.getUint8(this._tmpPosition++)){case i.ATTR_OBJ_INFO_NAME:r=this.readString();break;case i.ATTR_OBJ_INFO_TYPE:1===this.readUint8()&&(s=t.eObjectType.BONE);break;case i.ATTR_OBJ_INFO_WIDTH:o=this.readFixed16_16();break;case i.ATTR_OBJ_INFO_HEIGHT:a=this.readFixed16_16()}return new t.ObjectInfo(n,r,s,o,a,0,0)},i.prototype.getCharMap=function(t){return null},i.prototype.getCharMapEntry=function(t,e,i){return null},i.prototype.getVariable=function(t){return null},i.prototype.getAnimation=function(e){this._tmpPosition=this.getAttribsPosition(e);for(var n=0,r="",s=0,o=t.eAnimationLooping.LOOPING,a=this._bin.getUint8(this._tmpPosition++)-1;a>=0;a--)switch(this._bin.getUint8(this._tmpPosition++)){case i.ATTR_ANIMATION_ID:n=this.readUint8();break;case i.ATTR_ANIMATION_NAME:r=this.readString();break;case i.ATTR_ANIMATION_LENGTH:s=this.readUint32();break;case i.ATTR_ANIMATION_INTERVAL:this._tmpPosition+=2;break;case i.ATTR_ANIMATION_LOOPING:o=1===this.readUint8()?t.eAnimationLooping.LOOPING:t.eAnimationLooping.NO_LOOPING}return new t.Animation(n,r,s,o)},i.prototype.getMainlineKey=function(e){this._tmpPosition=this.getAttribsPosition(e);for(var n=0,r=0,s=this._bin.getUint8(this._tmpPosition++)-1;s>=0;s--)switch(this._bin.getUint8(this._tmpPosition++)){case i.ATTR_MAINLINE_KEY_ID:n=this.readUint8();break;case i.ATTR_MAINLINE_KEY_TIME:r=this.readUint32()}return new t.KeyMainline(n,r)},i.prototype.getRef=function(e){this._tmpPosition=this.getAttribsPosition(e);for(var n=0,r=-1,s=0,o=0,a=0,h=this._bin.getUint8(this._tmpPosition++)-1;h>=0;h--)switch(this._bin.getUint8(this._tmpPosition++)){case i.ATTR_BONE_REF_ID:case i.ATTR_OBJ_REF_ID:n=this.readUint8();break;case i.ATTR_BONE_REF_PARENT:case i.ATTR_OBJ_REF_PARENT:r=this.readUint8();break;case i.ATTR_BONE_REF_TIMELINE:case i.ATTR_OBJ_REF_TIMELINE:s=this.readUint8();break;case i.ATTR_BONE_REF_KEY:case i.ATTR_OBJ_REF_KEY:o=this.readUint8();break;case i.ATTR_OBJ_REF_Z:a=this.readUint8();break;case i.ATTR_OBJ_REF_NAME:this.readString();break;case i.ATTR_OBJ_REF_FOLDER:case i.ATTR_OBJ_REF_FILE:++this._tmpPosition;break;case i.ATTR_OBJ_REF_ABS_X:case i.ATTR_OBJ_REF_ABS_Y:case i.ATTR_OBJ_REF_ABS_PIVOT_X:case i.ATTR_OBJ_REF_ABS_PIVOT_Y:case i.ATTR_OBJ_REF_ABS_SCALE_X:case i.ATTR_OBJ_REF_ABS_SCALE_Y:case i.ATTR_OBJ_REF_ANGLE:this._tmpPosition+=4;break;case i.ATTR_OBJ_REF_ALPHA:++this._tmpPosition}return new t.Ref(n,r,s,o,a)},i.prototype.getTimeline=function(e){this._tmpPosition=this.getAttribsPosition(e);for(var n=0,r="",s=0,o=t.eObjectType.SPRITE,a=this._bin.getUint8(this._tmpPosition++)-1;a>=0;a--)switch(this._bin.getUint8(this._tmpPosition++)){case i.ATTR_TIMELINE_ID:n=this.readUint8();break;case i.ATTR_TIMELINE_NAME:r=this.readString();break;case i.ATTR_TIMELINE_OBJ:s=this.readUint8();break;case i.ATTR_TIMELINE_OBJ_TYPE:1===this.readUint8()&&(o=t.eObjectType.BONE)}return new t.Timeline(n,r,o,s)},i.prototype.getBaseline=function(t){return null},i.prototype.getVarline=function(t){return null},i.prototype.getKey=function(t){return null},i.prototype.getTagKey=function(t){return null},i.prototype.getVariableKey=function(t,e){return null},i.prototype.getTimelineKey=function(e,n,r){this._tmpPosition=this.getAttribsPosition(e);for(var s=0,o=1,a=t.eCurveType.LINEAR,h=0,l=0,p=0,u=0,c=this._bin.getUint8(this._tmpPosition++)-1;c>=0;c--)switch(this._bin.getUint8(this._tmpPosition++)){case i.ATTR_TIMELINE_KEY_ID:++this._tmpPosition;break;case i.ATTR_TIMELINE_KEY_TIME:s=this.readUint32();break;case i.ATTR_TIMELINE_KEY_SPIN:o=this.readInt8();break;case i.ATTR_TIMELINE_KEY_CURVE:a=this.readUint8();break;case i.ATTR_TIMELINE_KEY_C1:h=this.readFixed1_7();break;case i.ATTR_TIMELINE_KEY_C2:l=this.readFixed1_7()}e+=2;var _=e+(this._smallOffset?this._bin.getUint16(e,!0):this._bin.getUint32(e,!0)),f=this._bin.getUint8(_),m=null,d=!1;14===f?m=new t.KeyBone(n,s,o):15===f&&(m=new t.KeyObject(n,s,o),d=!0),a!==t.eCurveType.LINEAR&&m.setCurve(a,h,l,p,u),this._tmpPosition=this.getAttribsPosition(_);var g=m.info;g.x=0,g.y=0,g.scaleX=1,g.scaleY=1,g.angle=0,g.alpha=1;for(var y=0,T=!1,v=0,b=!1,P=0,E=0,c=this._bin.getUint8(this._tmpPosition++)-1;c>=0;c--)switch(this._bin.getUint8(this._tmpPosition++)){case i.ATTR_BONE_X:case i.ATTR_OBJ_X:g.x=this.readFixed16_16();break;case i.ATTR_BONE_Y:case i.ATTR_OBJ_Y:g.y=-this.readFixed16_16();break;case i.ATTR_BONE_ANGLE:case i.ATTR_OBJ_ANGLE:g.angle=360-this.readFixed16_16();break;case i.ATTR_BONE_SCALE_X:case i.ATTR_OBJ_SCALE_X:g.scaleX=this.readFixed16_16();break;case i.ATTR_BONE_SCALE_Y:case i.ATTR_OBJ_SCALE_Y:g.scaleY=this.readFixed16_16();break;case i.ATTR_OBJ_FOLDER:P=this.readUint8();break;case i.ATTR_OBJ_FILE:E=this.readUint8();break;case i.ATTR_OBJ_PIVOT_X:y=this.readFixed16_16(),T=!0;break;case i.ATTR_OBJ_PIVOT_Y:v=this.readFixed16_16(),b=!0;break;case i.ATTR_OBJ_ALPHA:g.alpha=this.readFixed1_7()}if(d){m.setFolderAndFile(P,E);var I=r.getFolderById(P).getFileById(E);g.pivotX=T?y:I.pivotX,g.pivotY=1-(b?v:1-I.pivotY)}return m},i.prototype.getTagChange=function(t){return null},i.ATTR_VERSION=0,i.ATTR_GENERATOR=1,i.ATTR_GENERATOR_VERSION=2,i.ATTR_FOLDER_ID=0,i.ATTR_FOLDER_NAME=1,i.ATTR_FILE_ID=0,i.ATTR_FILE_NAME=1,i.ATTR_FILE_WIDTH=2,i.ATTR_FILE_HEIGHT=3,i.ATTR_FILE_PIVOT_X=4,i.ATTR_FILE_PIVOT_Y=5,i.ATTR_ENTITY_ID=0,i.ATTR_ENTITY_NAME=1,i.ATTR_OBJ_INFO_NAME=0,i.ATTR_OBJ_INFO_TYPE=1,i.ATTR_OBJ_INFO_WIDTH=2,i.ATTR_OBJ_INFO_HEIGHT=3,i.ATTR_FRAMES_I_FOLDER=0,i.ATTR_FRAMES_I_FILE=1,i.ATTR_ANIMATION_ID=0,i.ATTR_ANIMATION_NAME=1,i.ATTR_ANIMATION_LENGTH=2,i.ATTR_ANIMATION_INTERVAL=3,i.ATTR_ANIMATION_LOOPING=4,i.ATTR_MAINLINE_KEY_ID=0,i.ATTR_MAINLINE_KEY_TIME=1,i.ATTR_BONE_REF_ID=0,i.ATTR_BONE_REF_PARENT=1,i.ATTR_BONE_REF_TIMELINE=2,i.ATTR_BONE_REF_KEY=3,i.ATTR_OBJ_REF_ID=4,i.ATTR_OBJ_REF_PARENT=5,i.ATTR_OBJ_REF_TIMELINE=6,i.ATTR_OBJ_REF_KEY=7,i.ATTR_OBJ_REF_NAME=8,i.ATTR_OBJ_REF_Z=9,i.ATTR_OBJ_REF_FOLDER=10,i.ATTR_OBJ_REF_FILE=11,i.ATTR_OBJ_REF_ABS_X=12,i.ATTR_OBJ_REF_ABS_Y=13,i.ATTR_OBJ_REF_ABS_PIVOT_X=14,i.ATTR_OBJ_REF_ABS_PIVOT_Y=15,i.ATTR_OBJ_REF_ABS_SCALE_X=16,i.ATTR_OBJ_REF_ABS_SCALE_Y=17,i.ATTR_OBJ_REF_ANGLE=18,i.ATTR_OBJ_REF_ALPHA=19,i.ATTR_TIMELINE_ID=0,i.ATTR_TIMELINE_NAME=1,i.ATTR_TIMELINE_OBJ=2,i.ATTR_TIMELINE_OBJ_TYPE=3,i.ATTR_TIMELINE_KEY_ID=0,i.ATTR_TIMELINE_KEY_TIME=1,i.ATTR_TIMELINE_KEY_SPIN=2,i.ATTR_TIMELINE_KEY_CURVE=3,i.ATTR_TIMELINE_KEY_C1=4,i.ATTR_TIMELINE_KEY_C2=5,i.ATTR_BONE_X=0,i.ATTR_BONE_Y=1,i.ATTR_BONE_ANGLE=2,i.ATTR_BONE_SCALE_X=3,i.ATTR_BONE_SCALE_Y=4,i.ATTR_OBJ_FOLDER=5,i.ATTR_OBJ_FILE=6,i.ATTR_OBJ_X=7,i.ATTR_OBJ_Y=8,i.ATTR_OBJ_SCALE_X=9,i.ATTR_OBJ_SCALE_Y=10,i.ATTR_OBJ_PIVOT_X=11,i.ATTR_OBJ_PIVOT_Y=12,i.ATTR_OBJ_ANGLE=13,i.ATTR_OBJ_ALPHA=14,i}(t.SpriterFile);t.SpriterBin=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(e){function i(t,i){void 0===i&&(i=null),e.call(this),this._json=t;var n=void 0!==t.min;this.setMinimized(n,i)}return __extends(i,e),i.prototype.getType=function(){return t.eFileType.JSON},i.prototype.parseInt=function(t,e,i){void 0===i&&(i=0);var n=t[this.translateAttributeName(e)];return void 0===n?i:"number"==typeof n?n:parseInt(n)},i.prototype.parseFloat=function(t,e,i){void 0===i&&(i=0);var n=t[this.translateAttributeName(e)];return void 0===n?i:"number"==typeof n?n:parseFloat(n)},i.prototype.parseBoolean=function(t,e,i){void 0===i&&(i=!1);var n=t[this.translateAttributeName(e)];return void 0===n?i:"boolean"==typeof n?n:"true"===n},i.prototype.parseString=function(t,e,i){void 0===i&&(i="");var n=t[this.translateAttributeName(e)];return void 0===n?i:n},i.prototype.getNodes=function(e){this.setMinDefsToElementName(e);var i=this.translateElementName(e);return new t.NodeListJSON(this,void 0!==this._json[i]?this._json[i]:[])},i.prototype.getNodesForElement=function(e,i){this.setMinDefsToElementName(i);var n=this.translateElementName(i);return new t.NodeListJSON(this,void 0!==e[n]?e[n]:[])},i.prototype.getFolder=function(e){return new t.Folder(this.parseInt(e,"id"),this.parseString(e,"name"))},i.prototype.getFile=function(e){return void 0!==e.type&&"sound"===e.type?null:new t.File(this.parseInt(e,"id"),this.getFileNameWithoutExtension(this.parseString(e,"name")),this.parseFloat(e,"pivot_x"),1-this.parseFloat(e,"pivot_y"))},i.prototype.getTag=function(t){return null},i.prototype.getEntity=function(e){return new t.Entity(this.parseInt(e,"id"),this.parseString(e,"name"))},i.prototype.getObjectInfo=function(e,i){return new t.ObjectInfo(i,this.parseString(e,"name"),t.Types.getObjectTypeForName(this.parseString(e,"type")),this.parseFloat(e,"w"),this.parseFloat(e,"h"),this.parseFloat(e,"pivot_x"),this.parseFloat(e,"pivot_y"))},i.prototype.getCharMap=function(e){return new t.CharMap(this.parseInt(e,"id"),this.parseString(e,"name"))},i.prototype.getCharMapEntry=function(t,e,i){var n=i.getFolderById(this.parseInt(t,"folder")).getFileById(this.parseInt(t,"file")).name,r=null;void 0!==t.target_folder&&void 0!==t.target_file&&(r=i.getFolderById(this.parseInt(t,"target_folder")).getFileById(this.parseInt(t,"target_file"))),e.put(n,r)},i.prototype.getVariable=function(e){var i=t.Types.getVariableTypeForName(this.parseString(e,"type"));return new t.Variable(this.parseInt(e,"id"),this.parseString(e,"name"),i,i===t.eVariableType.STRING?this.parseString(e,"default"):this.parseFloat(e,"default",0))},i.prototype.getAnimation=function(e){return new t.Animation(this.parseInt(e,"id"),this.parseString(e,"name"),this.parseFloat(e,"length"),this.parseBoolean(e,"looping",!0)===!0?t.eAnimationLooping.LOOPING:t.eAnimationLooping.NO_LOOPING)},i.prototype.getMainlineKey=function(e){return new t.KeyMainline(this.parseInt(e,"id"),this.parseFloat(e,"time"))},i.prototype.getRef=function(e){return new t.Ref(this.parseInt(e,"id"),this.parseInt(e,"parent",-1),this.parseInt(e,"timeline"),this.parseInt(e,"key"),this.parseInt(e,"z_index"))},i.prototype.getTimeline=function(e){return new t.Timeline(this.parseInt(e,"id"),this.parseString(e,"name"),t.Types.getObjectTypeForName(this.parseString(e,"object_type","sprite")),this.parseInt(e,"obj",-1))},i.prototype.getBaseline=function(e){return new t.Baseline(this.parseInt(e,"id"),this.parseString(e,"name",null))},i.prototype.getVarline=function(e){return new t.Varline(this.parseInt(e,"id"),this.parseInt(e,"def"))},i.prototype.getKey=function(e){return new t.Key(this.parseInt(e,"id"),this.parseInt(e,"time"))},i.prototype.getTagKey=function(e){return new t.KeyTag(this.parseInt(e,"id"),this.parseInt(e,"time"))},i.prototype.getVariableKey=function(e,i){return new t.KeyVariable(this.parseInt(e,"id"),this.parseInt(e,"time"),i===t.eVariableType.STRING?this.parseString(e,"val"):this.parseFloat(e,"val"))},i.prototype.getTimelineKey=function(e,i,n){var r=this.parseInt(e,"time"),s=this.parseInt(e,"spin",1),o=this.parseString(e,"curve_type","linear"),a=this.parseFloat(e,"c1",0),h=this.parseFloat(e,"c2",0),l=this.parseFloat(e,"c3",0),p=this.parseFloat(e,"c4",0),u=this.translateChildElementName("bone"),c=this.translateChildElementName("object"),_=null,f=null,m=!1;void 0!==e[u]?(f=e[u],_=new t.KeyBone(i,r,s),this.setMinDefsToElementName("bone")):void 0!==e[c]&&(f=e[c],_=new t.KeyObject(i,r,s),this.setMinDefsToElementName("object"),m=!0),"linear"!==o&&_.setCurve(t.Types.getCurveTypeForName(o),a,h,l,p);var d=_.info;if(d.x=this.parseFloat(f,"x"),d.y=-this.parseFloat(f,"y"),d.scaleX=this.parseFloat(f,"scale_x",1),d.scaleY=this.parseFloat(f,"scale_y",1),d.angle=360-this.parseFloat(f,"angle"),d.alpha=this.parseFloat(f,"a",1),m){var g=this.parseInt(f,"folder"),y=this.parseInt(f,"file");_.setFolderAndFile(g,y);var T=n.getFolderById(g).getFileById(y);d.pivotX=this.parseFloat(f,"pivot_x",T.pivotX),d.pivotY=1-this.parseFloat(f,"pivot_y",1-T.pivotY)}return this.popMinDefsStack(),_},i.prototype.getTagChange=function(t){return this.parseInt(t,"t")},i}(t.SpriterFile);t.SpriterJSON=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(e){function i(t,i){void 0===i&&(i=null),e.call(this),this._xml=t;var n=t.documentElement.hasAttribute("min");this.setMinimized(n,i)}return __extends(i,e),i.prototype.getType=function(){return t.eFileType.XML},i.prototype.parseInt=function(t,e,i){void 0===i&&(i=0);var n=t.getAttribute(this.translateAttributeName(e));return null!==n?parseInt(n):i},i.prototype.parseFloat=function(t,e,i){void 0===i&&(i=0);var n=t.getAttribute(this.translateAttributeName(e));return null!==n?parseFloat(n):i},i.prototype.parseString=function(t,e,i){void 0===i&&(i="");var n=t.getAttribute(this.translateAttributeName(e));return null!==n?n:i},i.prototype.getNodes=function(e){this.setMinDefsToElementName(e);var i=this.translateElementName(e);return new t.NodeListXml(this,this._xml.documentElement.getElementsByTagName(i))},i.prototype.getNodesForElement=function(e,i){this.setMinDefsToElementName(i);var n=this.translateElementName(i);return new t.NodeListXml(this,e.getElementsByTagName(n))},i.prototype.getFolder=function(e){return new t.Folder(this.parseInt(e,"id"),this.parseString(e,"name"))},i.prototype.getFile=function(e){return e.hasAttribute("type")&&"sound"===e.getAttribute("type")?null:new t.File(this.parseInt(e,"id"),this.getFileNameWithoutExtension(this.parseString(e,"name")),this.parseFloat(e,"pivot_x"),1-this.parseFloat(e,"pivot_y"))},i.prototype.getTag=function(e){return new t.Item(this.parseInt(e,"id"),this.parseString(e,"name"))},i.prototype.getEntity=function(e){return new t.Entity(this.parseInt(e,"id"),this.parseString(e,"name"))},i.prototype.getObjectInfo=function(e,i){return new t.ObjectInfo(i,this.parseString(e,"name"),t.Types.getObjectTypeForName(this.parseString(e,"type")),this.parseFloat(e,"w"),this.parseFloat(e,"h"),this.parseFloat(e,"pivot_x"),this.parseFloat(e,"pivot_y"))},i.prototype.getCharMap=function(e){return new t.CharMap(this.parseInt(e,"id"),this.parseString(e,"name"))},i.prototype.getCharMapEntry=function(t,e,i){var n=i.getFolderById(this.parseInt(t,"folder")).getFileById(this.parseInt(t,"file")).name,r=null;t.hasAttribute("target_folder")&&t.hasAttribute("target_file")&&(r=i.getFolderById(this.parseInt(t,"target_folder")).getFileById(this.parseInt(t,"target_file"))),e.put(n,r)},i.prototype.getVariable=function(e){var i=t.Types.getVariableTypeForName(this.parseString(e,"type"));return new t.Variable(this.parseInt(e,"id"),this.parseString(e,"name"),i,i===t.eVariableType.STRING?this.parseString(e,"default"):this.parseFloat(e,"default",0))},i.prototype.getAnimation=function(e){return new t.Animation(this.parseInt(e,"id"),this.parseString(e,"name"),this.parseFloat(e,"length"),"true"===this.parseString(e,"looping","true")?t.eAnimationLooping.LOOPING:t.eAnimationLooping.NO_LOOPING)},i.prototype.getMainlineKey=function(e){return new t.KeyMainline(this.parseInt(e,"id"),this.parseFloat(e,"time"))},i.prototype.getRef=function(e){return new t.Ref(this.parseInt(e,"id"),this.parseInt(e,"parent",-1),this.parseInt(e,"timeline"),this.parseInt(e,"key"),this.parseInt(e,"z_index"))},i.prototype.getTimeline=function(e){return new t.Timeline(this.parseInt(e,"id"),this.parseString(e,"name"),t.Types.getObjectTypeForName(this.parseString(e,"object_type","sprite")),this.parseInt(e,"obj",-1))},i.prototype.getBaseline=function(e){return new t.Baseline(this.parseInt(e,"id"),this.parseString(e,"name",null))},i.prototype.getVarline=function(e){return new t.Varline(this.parseInt(e,"id"),this.parseInt(e,"def"))},i.prototype.getKey=function(e){return new t.Key(this.parseInt(e,"id"),this.parseInt(e,"time"))},i.prototype.getTagKey=function(e){return new t.KeyTag(this.parseInt(e,"id"),this.parseInt(e,"time"))},i.prototype.getVariableKey=function(e,i){return new t.KeyVariable(this.parseInt(e,"id"),this.parseInt(e,"time"),i===t.eVariableType.STRING?this.parseString(e,"val"):this.parseFloat(e,"val"))},i.prototype.getTimelineKey=function(e,i,n){var r=this.parseInt(e,"time"),s=this.parseInt(e,"spin",1),o=this.parseString(e,"curve_type","linear"),a=this.parseFloat(e,"c1",0),h=this.parseFloat(e,"c2",0),l=this.parseFloat(e,"c3",0),p=this.parseFloat(e,"c4",0),u=this.translateChildElementName("bone"),c=this.translateChildElementName("object"),_=null,f=e.firstElementChild,m=!1;f.tagName===u?(_=new t.KeyBone(i,r,s),this.setMinDefsToElementName("bone")):f.tagName===c&&(this.setMinDefsToElementName("object"),_=new t.KeyObject(i,r,s),m=!0),"linear"!==o&&_.setCurve(t.Types.getCurveTypeForName(o),a,h,l,p);var d=_.info;if(d.x=this.parseFloat(f,"x"),d.y=-this.parseFloat(f,"y"),d.scaleX=this.parseFloat(f,"scale_x",1),d.scaleY=this.parseFloat(f,"scale_y",1),d.angle=360-this.parseFloat(f,"angle"),d.alpha=this.parseFloat(f,"a",1),m){var g=this.parseInt(f,"folder"),y=this.parseInt(f,"file");_.setFolderAndFile(g,y);var T=n.getFolderById(g).getFileById(y);d.pivotX=this.parseFloat(f,"pivot_x",T.pivotX),d.pivotY=1-this.parseFloat(f,"pivot_y",1-T.pivotY)}return this.popMinDefsStack(),_},i.prototype.getTagChange=function(t){return this.parseInt(t,"t")},i}(t.SpriterFile);t.SpriterXml=e}(Spriter||(Spriter={}));var Spriter;!function(t){function e(t,e,i){return(e-t)*i+t}function i(t,e,i,n){return this.linear(this.linear(t,e,n),this.linear(e,i,n),n)}function n(t,e,i,n,r){return this.linear(this.quadratic(t,e,i,r),this.quadratic(e,i,n,r),r)}function r(t,e,i,n){return 0===i?t:(i>0?e>t&&(e-=360):t>e&&(e+=360),this.linear(t,e,n))}t.linear=e,t.quadratic=i,t.cubic=n,t.angleLinear=r}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(){function e(){this._folders=new t.IdNameMap,this._tags=new t.IdNameMap,this._entities=new t.IdNameMap}return e.prototype.addFolder=function(t){this._folders.add(t,t.id,t.name)},e.prototype.getFolderById=function(t){return this._folders.getById(t)},e.prototype.getFolderByName=function(t){return this._folders.getByName(t)},e.prototype.addEntity=function(t){this._entities.add(t,t.id,t.name)},e.prototype.getEntityById=function(t){return this._entities.getById(t)},e.prototype.getEntityByName=function(t){return this._entities.getByName(t)},e.prototype.addTag=function(t){this._tags.add(t,t.id,t.name)},e.prototype.getTagById=function(t){return this._tags.getById(t)},e.prototype.getTagByName=function(t){return this._tags.getByName(t)},Object.defineProperty(e.prototype,"tagsLength",{get:function(){return this._tags.length},enumerable:!0,configurable:!0}),e}();t.Spriter=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(){function e(){this.timeline=-1,this.timelineKey=-1,this.transformed=new t.SpatialInfo}return e.prototype.setOn=function(t){this._on=t},Object.defineProperty(e.prototype,"on",{get:function(){return this._on},enumerable:!0,configurable:!0}),e.prototype.setKey=function(i,n,r,s){this.timeline=r,this.timelineKey=s;var o=n.getTimelineById(r);this.name=o.name,this.objectInfo=-1===o.objectRef?null:i.getObjectInfoById(o.objectRef);var a=o.at(s),h=o.at(s+1,n.loopType!==t.eAnimationLooping.NO_LOOPING);this.key=a,this.timeFrom=a.time,this.timeTo=h.time,this.timeTo<this.timeFrom&&(this.timeTo=n.length),this.from=a.info,this.to=h.info,this.updateMask=0,Math.abs(this.from.x-this.to.x)>.001&&(this.updateMask+=e.UPDATE_X),Math.abs(this.from.y-this.to.y)>.001&&(this.updateMask+=e.UPDATE_Y),Math.abs(this.from.scaleX-this.to.scaleX)>.001&&(this.updateMask+=e.UPDATE_SCALE_X),Math.abs(this.from.scaleY-this.to.scaleY)>.001&&(this.updateMask+=e.UPDATE_SCALE_Y),Math.abs(this.from.pivotX-this.to.pivotX)>.001&&(this.updateMask+=e.UPDATE_PIVOT_X),Math.abs(this.from.pivotY-this.to.pivotY)>.001&&(this.updateMask+=e.UPDATE_PIVOT_Y),Math.abs(this.from.alpha-this.to.alpha)>.001&&(this.updateMask+=e.UPDATE_ALPHA),Math.abs(this.from.angle-this.to.angle)>.001&&(this.updateMask+=e.UPDATE_ANGLE),this.transformed.x=this.from.x,this.transformed.y=this.from.y,this.transformed.scaleX=this.from.scaleX,this.transformed.scaleY=this.from.scaleY,this.transformed.pivotX=this.from.pivotX,this.transformed.pivotY=this.from.pivotY,this.transformed.angle=this.from.angle,this.transformed.alpha=this.from.alpha},e.prototype.tween=function(i){var n=this.updateMask>0?this.getTweenTime(i):0;this.transformed.x=(this.updateMask&e.UPDATE_X)>0?t.linear(this.from.x,this.to.x,n):this.from.x,this.transformed.y=(this.updateMask&e.UPDATE_Y)>0?t.linear(this.from.y,this.to.y,n):this.from.y,this.transformed.scaleX=(this.updateMask&e.UPDATE_SCALE_X)>0?t.linear(this.from.scaleX,this.to.scaleX,n):this.from.scaleX,this.transformed.scaleY=(this.updateMask&e.UPDATE_SCALE_Y)>0?t.linear(this.from.scaleY,this.to.scaleY,n):this.from.scaleY,this.transformed.pivotX=(this.updateMask&e.UPDATE_PIVOT_X)>0?t.linear(this.from.pivotX,this.to.pivotX,n):this.from.pivotX,this.transformed.pivotY=(this.updateMask&e.UPDATE_PIVOT_Y)>0?t.linear(this.from.pivotY,this.to.pivotY,n):this.from.pivotY,this.transformed.alpha=(this.updateMask&e.UPDATE_ALPHA)>0?t.linear(this.from.alpha,this.to.alpha,n):this.from.alpha,this.transformed.angle=(this.updateMask&e.UPDATE_ANGLE)>0?t.angleLinear(this.from.angle,this.to.angle,this.key.spin,n):this.from.angle},e.prototype.update=function(t){this.transformed.angle*=Phaser.Math.sign(t.scaleX)*Phaser.Math.sign(t.scaleY),this.transformed.angle+=t.angle,this.transformed.scaleX*=t.scaleX,this.transformed.scaleY*=t.scaleY,this.scalePosition(t.scaleX,t.scaleY),this.rotatePosition(t.angle),this.translatePosition(t.x,t.y),this.transformed.alpha*=t.alpha},e.prototype.scalePosition=function(t,e){this.transformed.x*=t,this.transformed.y*=e},e.prototype.rotatePosition=function(t){var e=this.transformed.x,i=this.transformed.y;if(0!==e||0!==i){var n=t*(Math.PI/180),r=Math.cos(n),s=Math.sin(n);this.transformed.x=e*r-i*s,this.transformed.y=e*s+i*r}},e.prototype.translatePosition=function(t,e){this.transformed.x+=t,this.transformed.y+=e},e.prototype.getTweenTime=function(e){if(this.key.curveType===t.eCurveType.INSTANT)return 0;var i=Phaser.Math.clamp((e-this.timeFrom)/(this.timeTo-this.timeFrom),0,1);switch(this.key.curveType){case t.eCurveType.LINEAR:return i;case t.eCurveType.QUADRATIC:return t.quadratic(0,this.key.c1,1,i);case t.eCurveType.CUBIC:return t.cubic(0,this.key.c1,this.key.c2,1,i)}return 0},e.UPDATE_X=1,e.UPDATE_Y=2,e.UPDATE_SCALE_X=4,e.UPDATE_SCALE_Y=8,e.UPDATE_PIVOT_X=16,e.UPDATE_PIVOT_Y=32,e.UPDATE_ANGLE=64,e.UPDATE_ALPHA=128,e}();t.SpriterBone=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(e){function i(i,n,r,s,o,a){e.call(this,i,null),this.onLoop=new Phaser.Signal,this.onFinish=new Phaser.Signal,this.onSound=new Phaser.Signal,this.onEvent=new Phaser.Signal,this.onTagChange=new Phaser.Signal,this.onVariableSet=new Phaser.Signal,this._mainlineStepper=new t.LineStepper,this._lineSteppers=[],this._lineSteppersCount=0,this._bones=[],this._objects=[],this._tags=0,this._vars=[],this._paused=!1,this._spriter=n,this._entityName=s,this._entity=n.getEntityByName(s),this._textureKey=r,this._root=new t.SpatialInfo;for(var h=0;h<this._entity.variablesLength;h++)this._vars[h]=this._entity.getVariableById(h).clone();this._charMapStack=new t.CharMapStack(this._entity),void 0===a&&(a=100),this.setAnimationSpeedPercent(a),void 0===o||null===o?this.playAnimationById(0):"number"==typeof o?this.playAnimationById(o):this.playAnimationByName(o)}return __extends(i,e),Object.defineProperty(i.prototype,"spriter",{get:function(){return this._spriter},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"entity",{get:function(){return this._entity},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"charMapStack",{get:function(){return this._charMapStack},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"paused",{get:function(){return this._paused},set:function(t){this.paused=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationsCount",{get:function(){return this._entity.animationsLength},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentAnimationName",{get:function(){return this._animationName},enumerable:!0,configurable:!0}),i.prototype.pushCharMap=function(t){this._charMapStack.push(t),this.resetSprites()},i.prototype.removeCharMap=function(t){this._charMapStack.remove(t),this.resetSprites()},i.prototype.clearCharMaps=function(){this._charMapStack.reset(),this.resetSprites()},i.prototype.resetSprites=function(){for(var t=0;t<this._objects.length;t++)this._objects[t].resetFile()},i.prototype.isTagOn=function(t){return this.isTagOnById(this._spriter.getTagByName(t).id)},i.prototype.isTagOnById=function(t){return(this._tags&1<<t)>0},i.prototype.getVariable=function(t){return this.getVariableById(this._entity.getVariableByName(t).id)},i.prototype.getVariableById=function(t){return this._vars[t]},i.prototype.getObject=function(t){for(var e=0;e<this._objects.length;e++){var i=this._objects[e];if(i.name===t)return i}return null},i.prototype.setAnimationSpeedPercent=function(t){void 0===t&&(t=100),this._animationSpeed=t/100},i.prototype.playAnimationById=function(t){var e=this._entity.getAnimationById(t);void 0!==e&&null!==e&&this.playAnimation(e)},i.prototype.playAnimationByName=function(t){var e=this._entity.getAnimationByName(t);void 0!==e&&null!==e&&this.playAnimation(e)},i.prototype.playAnimation=function(t){this._animationName=t.name,this._animation=t,this._finished=!1,this._mainlineStepper.reset(),this._mainlineStepper.line=this._animation.mainline,this._time=0,this.resetLines(),this._tags=0;for(var e=0;e<this._vars.length;e++)this._vars[e].reset();this.loadKeys(this._animation.mainline.at(0),!0),this.updateCharacter()},i.prototype.resetLines=function(){this._lineSteppersCount=0;for(var e=0;e<this._animation.linesLength;e++){var i=this._animation.getLineById(e);this._lineSteppersCount>=this._lineSteppers.length&&(this._lineSteppers[this._lineSteppersCount]=new t.LineStepper);var n=this._lineSteppers[this._lineSteppersCount++];n.reset(),n.line=i}},i.prototype.setBones=function(e,i){void 0===i&&(i=!1);for(var n=0;n<this._bones.length;n++)void 0!==this._bones[n]&&this._bones[n].setOn(!1);for(var n=0;n<e.length;n++){var r=e[n];if(void 0===this._bones[r.id]){var s=new t.SpriterBone;s.type=t.eObjectType.BONE,this._bones[r.id]=s}var o=this._bones[r.id];o.setOn(!0),o.parent=r.parent,(o.timelineKey!==r.key||o.timeline!==r.timeline||i)&&o.setKey(this._entity,this._animation,r.timeline,r.key)}},i.prototype.setObjects=function(e,i){void 0===i&&(i=!1);for(var n=0;n<this._objects.length;n++)void 0!==this._objects[n]&&this._objects[n].setOn(!1);for(var r=!1,n=0;n<e.length;n++){var s=e[n],o=null,a=null;void 0===this._objects[s.id]?(a=new Phaser.Sprite(this.game,0,0,this._textureKey),o=new t.SpriterObject(this,a),this._objects[s.id]=o,this.add(a)):(o=this._objects[s.id],a=o.sprite),o.parent=s.parent,o.type=this._animation.getTimelineById(s.timeline).objectType,o.type===t.eObjectType.SPRITE&&(o.setOn(!0),o.sprite.z!==s.z&&(o.sprite.z=s.z,r=!0)),(o.timelineKey!==s.key||o.timeline!==s.timeline||i)&&o.setKey(this._entity,this._animation,s.timeline,s.key)}r&&this.sort()},i.prototype.loadKeys=function(t,e){void 0===e&&(e=!1),this.setBones(t.boneRefs,e),this.setObjects(t.objectRefs,e)},i.prototype.updateAnimation=function(){if(!this._paused&&!this._finished){var e=this._mainlineStepper;this._time>this._animation.length&&(this._animation.loopType===t.eAnimationLooping.NO_LOOPING?(this._time=this._animation.length,this._finished=!0):(this._time-=this._animation.length,this.onLoop.dispatch(this)));for(var i;null!==(i=e.step(this._time));)this.loadKeys(i),e.lastTime=i.time;this.updateCharacter(),this.updateLines(),this._finished&&this.onFinish.dispatch(this),this._time+=this.game.time.physicsElapsedMS*this._animationSpeed}},i.prototype.updateCharacter=function(){for(var t=0;t<this._bones.length;t++){var e=this._bones[t];if(e.on){var i=-1===e.parent?this._root:this._bones[e.parent].transformed;e.tween(this._time),e.update(i)}}for(var t=0;t<this._objects.length;t++){var n=this._objects[t];if(n.on){var i=-1===n.parent?this._root:this._bones[n.parent].transformed;n.tween(this._time),n.update(i)}}},i.prototype.updateLines=function(){for(var e=this._lineSteppersCount-1;e>=0;e--)for(var i,n=this._lineSteppers[e],r=n.line;null!==(i=n.step(this._time));){switch(r.type){case t.eTimelineType.SOUND_LINE:this.onSound.dispatch(this,r.name);break;case t.eTimelineType.EVENT_LINE:this.onEvent.dispatch(this,r.name);break;case t.eTimelineType.TAG_LINE:var s=i.tagsOn,o=this._tags^s;
this._tags=s;for(var a=0;a<this._spriter.tagsLength;a++){var h=1<<a;o&h&&this.onTagChange.dispatch(this,this._spriter.getTagById(a).name,(s&h)>0)}break;case t.eTimelineType.VAR_LINE:var l=i.value,p=this._vars[r.varDefId];p.value=l,this.onVariableSet.dispatch(this,p)}n.lastTime=i.time}},i}(Phaser.Group);t.SpriterGroup=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(e){function i(t,i){e.call(this),this._spriter=t.spriter,this._charMapStack=t.charMapStack,this._sprite=i}return __extends(i,e),Object.defineProperty(i.prototype,"sprite",{get:function(){return this._sprite},enumerable:!0,configurable:!0}),i.prototype.setOn=function(t){e.prototype.setOn.call(this,t),this._sprite.exists=t,this._sprite.visible=t&&!this._hide},i.prototype.setKey=function(i,n,r,s){if(e.prototype.setKey.call(this,i,n,r,s),this.type===t.eObjectType.SPRITE){var o=this.key,a=this._spriter.getFolderById(o.folder).getFileById(o.file);this._file=a,this.setFile(a)}else this._file=null},i.prototype.resetFile=function(){this.type===t.eObjectType.SPRITE&&this.setFile(this._file)},i.prototype.setFile=function(t){t=this._charMapStack.getFile(t),null!==t?(this._hide=!1,this._sprite.frameName=t.name):(this._hide=!0,this._sprite.visible=!1)},i.prototype.update=function(t){e.prototype.update.call(this,t),this.updateSprite()},i.prototype.updateSprite=function(){var t=this.transformed,e=this.sprite;e.position.set(t.x,t.y),e.scale.set(t.scaleX,t.scaleY),e.anchor.set(t.pivotX,t.pivotY),e.alpha=t.alpha,e.angle=t.angle},i}(t.SpriterBone);t.SpriterObject=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(){function t(t,e){this._id=t,this._name=e}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t}();t.Item=e}(Spriter||(Spriter={}));var Spriter;!function(t){!function(t){t[t.NO_LOOPING=0]="NO_LOOPING",t[t.LOOPING=1]="LOOPING"}(t.eAnimationLooping||(t.eAnimationLooping={}));var e=(t.eAnimationLooping,function(e){function i(i,n,r,s){e.call(this,i,n),this._length=r,this._loopType=s,this._timelines=new t.IdNameMap,this._lines=new t.IdNameMap}return __extends(i,e),Object.defineProperty(i.prototype,"mainline",{get:function(){return this._mainline},set:function(t){this._mainline=t},enumerable:!0,configurable:!0}),i.prototype.addTimeline=function(t){this._timelines.add(t,t.id,t.name)},i.prototype.getTimelineById=function(t){return this._timelines.getById(t)},i.prototype.getTimelineByName=function(t){return this._timelines.getByName(t)},i.prototype.addLine=function(t){this._lines.add(t,this._lines.length,t.name)},i.prototype.getLineById=function(t){return this._lines.getById(t)},i.prototype.getLineByName=function(t){return this._lines.getByName(t)},Object.defineProperty(i.prototype,"linesLength",{get:function(){return this._lines.length},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"loopType",{get:function(){return this._loopType},enumerable:!0,configurable:!0}),i}(t.Item));t.Animation=e}(Spriter||(Spriter={}));var Spriter;!function(t){!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.MAIN_LINE=1]="MAIN_LINE",t[t.TIME_LINE=2]="TIME_LINE",t[t.SOUND_LINE=3]="SOUND_LINE",t[t.EVENT_LINE=4]="EVENT_LINE",t[t.TAG_LINE=5]="TAG_LINE",t[t.VAR_LINE=6]="VAR_LINE"}(t.eTimelineType||(t.eTimelineType={}));var e=t.eTimelineType,i=function(t){function i(i,n){void 0===n&&(n=null),t.call(this,i,n),this._type=e.UNKNOWN}return __extends(i,t),Object.defineProperty(i.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"keys",{get:function(){return this._keys},enumerable:!0,configurable:!0}),i.prototype.add=function(t){(null===this._keys||void 0===this._keys)&&(this._keys=[]),this._keys.push(t)},i.prototype.at=function(t,e){if(void 0===e&&(e=!0),0>t)return null;var i=this._keys.length;return t>=i&&(e?t%=i:t=i-1),this._keys[t]},i}(t.Item);t.Baseline=i}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.put=function(t,e){void 0===this._map&&(this._map={}),void 0!==this._map[t],this._map[t]=e},e.prototype.value=function(t){return this._map[t]},e}(t.Item);t.CharMap=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(){function t(t){this._stack=[],this._length=0,this._entity=t}return t.prototype.reset=function(){this._length=0},t.prototype.push=function(t){var e=this.getCharMap(t);this._stack[this._length++]=e},t.prototype.remove=function(t){var e=this.getCharMap(t),i=this.findCharMap(e);if(-1!==i){for(var n=i;n<this._length-2;n++)this._stack[n]=this._stack[n+1];this._stack[--this._length]=null}},t.prototype.getFile=function(t){for(var e=this._length-1;e>=0;e--){var i=this._stack[e].value(t.name);if(void 0!==i)return i}return t},t.prototype.getCharMap=function(t){var e=this._entity.getCharMapByName(t);return e},t.prototype.findCharMap=function(t){for(var e=0;e<this._length;e++)if(this._stack[e]===t)return e;return-1},t}();t.CharMapStack=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(e){function i(i,n){e.call(this,i,n),this._objectInfos=new t.IdNameMap,this._charMaps=new t.IdNameMap,this._variables=new t.IdNameMap,this._animations=new t.IdNameMap}return __extends(i,e),i.prototype.addObjectInfo=function(t){this._objectInfos.add(t,t.id,t.name)},i.prototype.getObjectInfoById=function(t){return this._objectInfos.getById(t)},i.prototype.getObjectInfoByName=function(t){return this._objectInfos.getByName(t)},i.prototype.addCharMap=function(t){this._charMaps.add(t,t.id,t.name)},i.prototype.getCharMapById=function(t){return this._charMaps.getById(t)},i.prototype.getCharMapByName=function(t){return this._charMaps.getByName(t)},Object.defineProperty(i.prototype,"charMapsLength",{get:function(){return this._charMaps.length},enumerable:!0,configurable:!0}),i.prototype.addVariable=function(t){this._variables.add(t,t.id,t.name)},i.prototype.getVariableById=function(t){return this._variables.getById(t)},i.prototype.getVariableByName=function(t){return this._variables.getByName(t)},Object.defineProperty(i.prototype,"variablesLength",{get:function(){return this._variables.length},enumerable:!0,configurable:!0}),i.prototype.addAnimation=function(t){this._animations.add(t,t.id,t.name)},i.prototype.getAnimationById=function(t){return this._animations.getById(t)},i.prototype.getAnimationByName=function(t){return this._animations.getByName(t)},Object.defineProperty(i.prototype,"animationsLength",{get:function(){return this._animations.length},enumerable:!0,configurable:!0}),i}(t.Item);t.Entity=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(t){function e(e,i,n,r){t.call(this,e,i),this._pivotX=n,this._pivotY=r}return __extends(e,t),Object.defineProperty(e.prototype,"pivotX",{get:function(){return this._pivotX},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pivotY",{get:function(){return this._pivotY},enumerable:!0,configurable:!0}),e}(t.Item);t.File=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(e){function i(i,n){e.call(this,i,n),this._files=new t.IdNameMap}return __extends(i,e),i.prototype.addFile=function(t){this._files.add(t,t.id,t.name)},i.prototype.getFileById=function(t){return this._files.getById(t)},i.prototype.getFileByName=function(t){return this._files.getByName(t)},i}(t.Item);t.Folder=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(){function t(t,e){this._id=t,this._time=e}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){return this._time},enumerable:!0,configurable:!0}),t}();t.Key=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(e){function i(i,n,r){e.call(this,i,n),this._info=new t.SpatialInfo,this._spin=r,this.setCurve(t.eCurveType.LINEAR)}return __extends(i,e),i.prototype.setCurve=function(t,e,i,n,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),this._curveType=t,this._c1=e,this._c2=i,this._c3=n,this._c4=r},Object.defineProperty(i.prototype,"spin",{get:function(){return this._spin},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"curveType",{get:function(){return this._curveType},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"c1",{get:function(){return this._c1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"c2",{get:function(){return this._c2},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"c3",{get:function(){return this._c3},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"c4",{get:function(){return this._c4},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"info",{get:function(){return this._info},enumerable:!0,configurable:!0}),i}(t.Key);t.KeyTimeline=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(t.KeyTimeline);t.KeyBone=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(t){function e(){t.apply(this,arguments),this._boneRefs=[],this._objectRefs=[]}return __extends(e,t),Object.defineProperty(e.prototype,"boneRefs",{get:function(){return this._boneRefs},enumerable:!0,configurable:!0}),e.prototype.addBoneRef=function(t){this._boneRefs.push(t)},Object.defineProperty(e.prototype,"objectRefs",{get:function(){return this._objectRefs},enumerable:!0,configurable:!0}),e.prototype.addObjectRef=function(t){this._objectRefs.push(t)},e}(t.Key);t.KeyMainline=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.setFolderAndFile=function(t,e){this._folder=t,this._file=e},Object.defineProperty(e.prototype,"folder",{get:function(){return this._folder},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"file",{get:function(){return this._file},enumerable:!0,configurable:!0}),e}(t.KeyTimeline);t.KeyObject=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),Object.defineProperty(e.prototype,"tagsOn",{get:function(){return this._tagsOn},set:function(t){this._tagsOn=t},enumerable:!0,configurable:!0}),e}(t.Key);t.KeyTag=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(t){function e(e,i,n){t.call(this,e,i),this._value=n}return __extends(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e}(t.Key);t.KeyVariable=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(t){function e(e,i,n,r,s,o,a){t.call(this,e,i),this._type=n,this._width=r,this._height=s,this._pivotX=o,this._pivotY=a}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pivotX",{get:function(){return this._pivotX},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pivotY",{get:function(){return this._pivotY},enumerable:!0,configurable:!0}),e}(t.Item);t.ObjectInfo=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(){function t(t,e,i,n,r){void 0===r&&(r=0),this.id=t,this.parent=e,this.timeline=i,this.key=n,this.z=r}return t}();t.Ref=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(){function t(){this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.pivotX=0,this.pivotY=0,this.alpha=1,this.angle=0}return t}();t.SpatialInfo=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(e){function i(i,n,r,s){void 0===r&&(r=t.eObjectType.SPRITE),void 0===s&&(s=-1),e.call(this,i,n),this.type=t.eTimelineType.TIME_LINE,this._objectType=r,this._objectRef=s}return __extends(i,e),Object.defineProperty(i.prototype,"objectType",{get:function(){return this._objectType},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"objectRef",{get:function(){return this._objectRef},enumerable:!0,configurable:!0}),i}(t.Baseline);t.Timeline=e}(Spriter||(Spriter={}));var Spriter;!function(t){!function(t){t[t.SPRITE=0]="SPRITE",t[t.BONE=1]="BONE",t[t.BOX=2]="BOX",t[t.POINT=3]="POINT",t[t.SOUND=4]="SOUND"}(t.eObjectType||(t.eObjectType={}));var e=t.eObjectType;!function(t){t[t.LINEAR=0]="LINEAR",t[t.INSTANT=1]="INSTANT",t[t.QUADRATIC=2]="QUADRATIC",t[t.CUBIC=3]="CUBIC"}(t.eCurveType||(t.eCurveType={}));var i=t.eCurveType;!function(t){t[t.INT=0]="INT",t[t.FLOAT=1]="FLOAT",t[t.STRING=2]="STRING"}(t.eVariableType||(t.eVariableType={}));var n=t.eVariableType,r=function(){function t(){}return t.getObjectTypeForName=function(e){var i=t.nameToObjectType[e];return i},t.getCurveTypeForName=function(e){var i=t.nameToCurveType[e];return i},t.getVariableTypeForName=function(e){var i=t.nameToVariableType[e];return i},t.nameToObjectType={sprite:e.SPRITE,bone:e.BONE,box:e.BOX,point:e.POINT,sound:e.SOUND},t.nameToCurveType={instatnt:i.INSTANT,linear:i.LINEAR,quadratic:i.QUADRATIC,cubic:i.CUBIC},t.nameToVariableType={"int":n.INT,"float":n.FLOAT,string:n.STRING},t}();t.Types=r}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(e){function i(t,i,n,r){e.call(this,t,i),this._type=n,this._default=r,this.reset()}return __extends(i,e),i.prototype.clone=function(){return new i(this.id,this.name,this.type,this._default)},i.prototype.reset=function(){this.value=this._default},Object.defineProperty(i.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"value",{get:function(){return this._value},set:function(e){this._type===t.eVariableType.INT?this._value=Math.floor(e):this._value=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"int",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"float",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"string",{get:function(){return this._value},enumerable:!0,configurable:!0}),i}(t.Item);t.Variable=e}(Spriter||(Spriter={}));var Spriter;!function(t){var e=function(e){function i(i,n){e.call(this,i,null),this._varDefId=n,this.type=t.eTimelineType.VAR_LINE}return __extends(i,e),Object.defineProperty(i.prototype,"varDefId",{get:function(){return this._varDefId},enumerable:!0,configurable:!0}),i}(t.Baseline);t.Varline=e}(Spriter||(Spriter={}));var Leto;!function(t){var e=function(t){function e(){t.call(this),this._ignoreNextResize=!1}return __extends(e,t),e.prototype.init=function(){this.input.maxPointers=1,this.stage.disableVisibilityChange=!0;var t=Utils.ScreenUtils.screenMetrics;this.game.device.desktop?(this.scale.scaleMode=Phaser.ScaleManager.USER_SCALE,this.scale.setMinMax(.25*this.game.width,.25*this.game.height,2.5*this.game.width,2.5*this.game.height),this.scale.setUserScale(t.scaleX,t.scaleY),this.scale.pageAlignHorizontally=!0,this.scale.pageAlignVertically=!0,this.scale.setResizeCallback(this.gameResized,this)):(this.scale.scaleMode=Phaser.ScaleManager.USER_SCALE,this.scale.setUserScale(t.scaleX,t.scaleY),this.scale.pageAlignHorizontally=!0,this.scale.pageAlignVertically=!0,this.scale.forceOrientation(!0,!1),this.scale.setResizeCallback(this.gameResized,this),this.scale.onOrientationChange.add(this.orientationChange,this)),this.orientationChange(this.scale,"",!0)},e.prototype.create=function(){this.game.state.start("Preloader",!0,!1)},e.prototype.gameResized=function(t,e){},e.prototype.orientationChange=function(t,e,i){},e}(Phaser.State);t.Boot=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(t){function e(){t.call(this),this._restartCounter=2}return __extends(e,t),e.prototype.create=function(){var t=this.add.image(0,0,"Intro");t.inputEnabled=!0,t.events.onInputDown.add(function(){this._pressed=!0},this),this._once=!1,this._pressed=!1},e.prototype.onGameeRestart=function(){--this._restartCounter<=0&&(this._pressed=!0,Utils.AudioUtils.playSound("bonus1"))},e.prototype.onGameeButtonDown=function(t){this._pressed=!0},e.prototype.update=function(){this._once||this._pressed&&(this._once=!0,Gamee.Gamee.instance.gameStart(),this.game.state.start("Play"))},e}(Phaser.State);t.Menu=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(t){function e(){t.call(this),this._ready=!1}return __extends(e,t),e.prototype.preload=function(){var t="assets/";this.game.device.ie?(this.load.audio("konec","assets/sfx/konec.mp3"),this.load.audio("bonus1","assets/sfx/bonus1.mp3"),this.load.audio("bonus2","assets/sfx/bonus2.mp3"),this.load.audio("dopad","assets/sfx/dopad.mp3"),this.load.audio("laska","assets/sfx/laska.mp3"),this.load.audio("skok","assets/sfx/skok.mp3"),this.load.audio("kolize","assets/sfx/kolize.mp3")):this.load.audio("SFX",["assets/sfx/sfx.ogg","assets/sfx/sfx.m4a"]),this.load.atlas("Sprites",t+"Sprites.png",t+"Sprites.json"),this.load.xml("PlayerAnim",t+"player.xml"),this.load.json("Config",t+"config.json")},e.prototype.loadUpdate=function(){this.setLoadingText(this.load.progress)},e.prototype.create=function(){this.readConfig();var t=0;if(this.game.device.ie){t=.02,Utils.AudioUtils.setSounds(null);var e=this.add.audio("konec");e.allowMultiple=!0,Utils.AudioUtils.addSound("konec",e),e=this.add.audio("bonus1"),e.allowMultiple=!0,Utils.AudioUtils.addSound("bonus1",e),e=this.add.audio("bonus2"),e.allowMultiple=!0,Utils.AudioUtils.addSound("bonus2",e),e=this.add.audio("dopad"),e.allowMultiple=!0,Utils.AudioUtils.addSound("dopad",e),e=this.add.audio("laska"),e.allowMultiple=!0,Utils.AudioUtils.addSound("laska",e),e=this.add.audio("skok"),e.allowMultiple=!0,Utils.AudioUtils.addSound("skok",e),e=this.add.audio("kolize"),e.allowMultiple=!0,Utils.AudioUtils.addSound("kolize",e)}else{this.game.device.iOS&&(t=.1);var i=this.add.audio("SFX");Utils.AudioUtils.setSounds(i),i.allowMultiple=!0,i.addMarker("konec",0,1.3903),i.addMarker("bonus1",3-t,2.0773+t),i.addMarker("bonus2",7-t,3.6454+t),i.addMarker("dopad",12-t,.3787+t),i.addMarker("laska",14-t,2.9181+t),i.addMarker("skok",18-t,.8105+t),i.addMarker("kolize",20-t,.2666+t)}},e.prototype.readConfig=function(){this.game.cache.getJSON("Config")},e.prototype.update=function(){this._ready===!1&&(this._ready=!0,this.game.state.start("Play"))},e.prototype.setLoadingText=function(t){},e}(Phaser.State);t.Preloader=e}(Leto||(Leto={}));var Leto;!function(t){var e=function(e){function i(){e.call(this),this._jumpVelocities=[],this._jumpTimer=0,this._collisionTimer=0,this._justDown=!1,this._justUp=!1,this._gameOver=!1,this._runFromRestart=!1}return __extends(i,e),i.prototype.create=function(){this.camera.bounds=null,this.stage.backgroundColor=12632256,this.physics.startSystem(Phaser.Physics.ARCADE),this.physics.arcade.gravity.y=t.Gameplay.GRAVITY,this.addPlayer(),this._jumpVelocities=t.VelocityCalculator.calcVelocities(),this._jumpTables=t.VelocityCalculator.calcTables(this._jumpVelocities,this._player.body),this._background=new t.Background(this.game,this.world),this._topLayer=new Phaser.Group(this.game,this.world),this._generator=new t.Generator(this.game,this._jumpTables,this),this.addGirl(),this._topLayer.add(this._generator),this._topLayer.add(this._girl),this._topLayer.add(this._player),this.world.add(this.smallEmitter()),this.world.add(this.heartEmitter()),this._jumpKey=this.game.input.keyboard.addKey(Phaser.KeyCode.Z),this.game.input.onDown.add(function(){this._justDown=!0},this),this.game.input.onUp.add(function(){this._justUp=!0},this),this.reset()},i.prototype.onGameePause=function(){this.game.paused=!0},i.prototype.onGameeUnpause=function(){this.game.paused=!1},i.prototype.onGameeRestart=function(){t.Global.game.paused=!1,this.reset(),Gamee.Gamee.instance.gameStart(),Utils.AudioUtils.playSound("bonus1")},i.prototype.onGameeButtonDown=function(t){var e=Gamee.Gamee.instance;e.gameRunning?this._justDown=!0:this._runFromRestart||(e.gameStart(),Utils.AudioUtils.playSound("bonus1"))},i.prototype.onGameeButtonUp=function(t){var e=Gamee.Gamee.instance;e.gameRunning&&(this._justUp=!0)},i.prototype.reset=function(){this._gameOver=!1,this._player.position.set(128,192);var e=this._player.body;e.allowGravity=!0,e.velocity.set(0,0),this.camera.setPosition(Math.max(170,this._player.x-96),0),this._background.updatePosition(this.camera.x,(this._player.y-320)/10),this._girl.position.set(0,-300),this._girl.body.enable=!1,this._player.clearParticles(),this._heartEmitter.killAllParticles(),this._smallEmitter.killAllParticles(),this._bonusJump=!1,this._jumpTimer=0,this._score=0,this._collisionTimer=this.game.time.now+500,this._generator.reset(),this._justDown=!1,this._justUp=!1,this._startTime=this.game.time.time,this._score=0,t.Global.GAMEE&&(Gamee.Gamee.instance.score=0)},i.prototype.update=function(){var e=this._player.body;if(!this._gameOver){if(t.Global.GAMEE&&!Gamee.Gamee.instance.gameRunning)return this._player.position.set(128,192),void e.velocity.set(0,0);this.updatePhysics(),this.camera.x=Math.max(170,this._player.x-96),this._generator.generate(this.camera.x/t.Gameplay.GRID_SIZE);var i=Math.floor((this.game.time.time-this._startTime)/1e3);i>this._score&&(this._score=i,Gamee.Gamee.instance.addScore(1),i>0&&(i%t.Gameplay.GIRL_TIME===0&&(this._generator.girlTime=!0),i%t.Gameplay.HEARTS_TIME===0&&(this._generator.heartsTime=!0)))}var n=(this._player.y-320)/10;t.Global.paralax&&(this.camera.y=Phaser.Math.clamp(n,-32,32)),this._background.updatePosition(this.camera.x,n),this._player.updateAnim(e.velocity.y>=0&&e.touching.down,e.velocity.y,this._gameOver),this.projectShadow()},i.prototype.updatePhysics=function(){var e=this._player.body;if(this.physics.arcade.overlap(this._player,this._girl,this.hitGirl,null,this),this.physics.arcade.overlap(this._player,this._generator.spikes,this.overlap,null,this),!this._gameOver){e.touching.none=!0,e.touching.up=e.touching.down=e.touching.left=e.touching.right=!1;var i=this.physics.arcade.collide(this._player,this._generator.walls);if(i&&e.touching.right&&this.game.time.now>this._collisionTimer)return e.velocity.set(0,0),this.setGameOver(),void this._player.animateHit();e.velocity.x=t.Gameplay.VELOCITY_X;var n=this._jumpKey.justDown||this._justDown,r=this._jumpKey.justUp||this._justUp;(n&&e.touching.down&&this.game.time.now>this._jumpTimer||n&&this._bonusJump)&&(e.velocity.y=-this._jumpVelocities[this._jumpVelocities.length-1],this._jumpTimer=this.game.time.now+150,this._bonusJump=!1,this._player.animateJump()),r&&e.velocity.y<-this._jumpVelocities[0]&&(e.velocity.y=-this._jumpVelocities[0]),r&&(this._justDown=!1),e.velocity.y<=0&&(this._justDown=!1),this._justUp=!1}},i.prototype.girlAvailable=function(){return this._girl.x<this.camera.x},i.prototype.placeGirl=function(t,e){this._girl.position.set(64*t,64*e),this._girl.body.enable=!0},i.prototype.hitGirl=function(t,e){e.body.enable=!1,Utils.AudioUtils.playSound("laska"),this.emitHearts(),Gamee.Gamee.instance.addScore(3)},i.prototype.overlap=function(t,e){if(2===e.flag){var i=this._player.body;i.velocity.set(0,0),this.setGameOver(),this._player.animateHit()}else 3===e.flag&&(this._bonusJump=!0,this.emitHeart(e),this._generator.removeBonus(e),Utils.AudioUtils.playSound("bonus2"),Gamee.Gamee.instance.addScore(1))},i.prototype.addPlayer=function(){var e=new t.Player(this.game,this);this.world.add(e),e.position.set(128,192),this.game.physics.arcade.enable(e,!1);var i=e.body;i.allowGravity=!0,this._player=e,this._bonusJump=!1},i.prototype.addGirl=function(){var t=this.add.sprite(0,-300,"Sprites");t.anchor.set(.5,1),t.animations.add("girl",i.GIRL_ANIM,12,!0),t.animations.play("girl"),this.game.physics.enable(t,Phaser.Physics.ARCADE);var e=t.body;e.allowGravity=!1,e.immovable=!0,e.moves=!1,e.enable=!1,this._girl=t},i.prototype.setGameOver=function(){this._gameOver||(this._gameOver=!0,this.time.events.add(1500,function(){t.Global.GAMEE?(this._runFromRestart=!0,Gamee.Gamee.instance.gameOver()):this.reset()},this))},i.prototype.heartEmitter=function(){var e=new t.ParticlesEmitter(this.game,0,0,8);return e.lifetime=1,e.setXSpeed(-20,-20),e.setYSpeed(-200,-200),e.setAngularSpeed(-45,-90),e.setAlphaChange(t.eParameterChangeType.IN_TIME,-1,1),e.gravity=0,e.makeParticles("Sprites","srdce1"),this._heartEmitter=e,e},i.prototype.emitHeart=function(t){this._heartEmitter.emitAtObject(t),this._heartEmitter.emitParticle()},i.prototype.smallEmitter=function(){var e=new t.ParticlesEmitter(this.game,0,0,32);return e.emitObject=this._player,e.lifetime=.3,e.setXSpeed(0,0),e.setYSpeed(-200,200),e.setAngularSpeed(-45,-90),e.minParticleScale=.5,e.maxParticleScale=1,e.setScaleChange(t.eParameterChangeType.IN_TIME,1,1.2),e.gravity=0,e.makeParticles("Sprites","srdceMale"),this._smallEmitter=e,e},i.prototype.emitHearts=function(){this._smallEmitter.emitAt(5,5),this._smallEmitter.flow(100,2,40,!0)},i.prototype.projectShadow=function(){for(var t=this._player.x+10-20,e=this._player.x+10+20,i=this._generator.walls,n=1e4,r=1e4,s=this._generator.shadow,o=0;o<i.length;o++){var a=i.getChildAt(o);a.exists&&0===a.flag&&(a.x<=t&&a.x+64>t&&(n=Math.min(n,a.y)),a.x<=e&&a.x+64>e&&(r=Math.min(r,a.y)))}if(1e4>n&&n===r&&this._player.y<n){var h=90/(1+n-this._player.y);s.scale.x=h,s.position.set(this._player.x+10,n),s.visible=!0}else s.visible=!1},i.GIRL_ANIM=["animacka_001","animacka_002","animacka_003","animacka_004","animacka_005","animacka_006","animacka_007"],i}(Phaser.State);t.Play=e}(Leto||(Leto={}));var Utils;!function(t){var e=function(){function t(){}return t.setSounds=function(e,i){void 0===i&&(i=null),t._sfx=e,t._sfxIds=i},t.addSound=function(e,i){t._sfxs[e]=i},t.playSound=function(e){var i;i="number"==typeof e?t._sfxIds[e]:e,Leto.Global.soundOn&&(null!==t._sfx?t._sfx.play(i):void 0!==t._sfxs[i]&&t._sfxs[i].play())},Object.defineProperty(t,"currentMusic",{get:function(){return t._currentMusic},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isMusicPlaying",{get:function(){if(null===this._currentMusic||0===this._currentMusic.length)return!1;var e=t._music[t._currentMusic];return e.isPlaying},enumerable:!0,configurable:!0}),t.addMusic=function(e,i){t._music[e]=i},t.playMusic=function(e,i){if(void 0===i&&(i=!0),t._currentMusic!==e&&(null!==t._currentMusic&&t._currentMusic.length>0&&t.stopMusic(),e in t._music&&Leto.Global.musicOn)){t._currentMusic=e;var n=t._music[e];n.loop=i,n.play(),i||n.onStop.addOnce(function(){t.onFinished.dispatch(e)},this)}},t.stopMusic=function(){if(null!==t._currentMusic&&t._currentMusic.length>0){var e=t._music[t._currentMusic];e.isPlaying&&e.stop(),t._currentMusic=""}},t.pauseMusic=function(){if(null!==t._currentMusic&&t._currentMusic.length>0){var e=t._music[t._currentMusic];e.isPlaying&&e.pause()}},t.resumeMusic=function(){if(null!==t._currentMusic&&t._currentMusic.length>0){var e=t._music[t._currentMusic];e.paused&&e.resume()}},t._sfx=null,t._sfxs={},t._music={},t._currentMusic="",t.onFinished=new Phaser.Signal,t}();t.AudioUtils=e}(Utils||(Utils={}));var Utils;!function(t){var e=function(){function t(){}return t.supported=function(){var t=Leto.Global.game;return t.scale.compatibility.supportsFullScreen},t.isFullscreen=function(){return Leto.Global.game.scale.isFullScreen},t.changeFullscreen=function(){var e=Leto.Global.game;t._fullscreen?e.scale.stopFullScreen():e.scale.startFullScreen(!1,!1)},t.onEnterFullscreen=function(){t._fullscreen=!0,null!==t._listener&&t._listener.call(t._listenerContext,!0)},t.onLeaveFullscreen=function(){t._fullscreen=!1,null!==t._listener&&t._listener.call(t._listenerContext,!1)},t.setListener=function(e,i){t._listener=e,t._listenerContext=i},t.removeListener=function(){t._listener=null,t._listenerContext=null},t._fullscreen=!1,t._listener=null,t._listenerContext=null,t}();t.FullscreenUtils=e}(Utils||(Utils={}));var Utils;!function(t){var e=function(){function t(){}return t.ChangeAnimationPhaserJSONData=function(t){Phaser.AnimationParser.myCallback=t,Phaser.AnimationParser.JSONData=function(t,e){if(e.frames){for(var i=new Phaser.FrameData,n=e.frames,r=0;r<n.length;r++){var s=i.addFrame(new Phaser.Frame(r,n[r].frame.x,n[r].frame.y,n[r].frame.w,n[r].frame.h,n[r].filename));n[r].trimmed&&s.setTrim(n[r].trimmed,n[r].sourceSize.w,n[r].sourceSize.h,n[r].spriteSourceSize.x,n[r].spriteSourceSize.y,n[r].spriteSourceSize.w,n[r].spriteSourceSize.h),Phaser.AnimationParser.myCallback(s,n[r])}return i}}},t.AdjustTweenFunctions=function(){Phaser.TweenManager.prototype.removeFromUpdateQueue=function(t){var e=this._tweens.indexOf(t);-1!==e?this._tweens.splice(e,1):(e=this._add.indexOf(t),-1!==e&&this._add.splice(e,1))},Phaser.Tween.prototype.stopAndRemoveFromUpdateQueue=function(t){var e=this,i=e.stop(t);return e.manager.removeFromUpdateQueue(e),e.pendingDelete=!1,i}},t}();t.PhaserUtils=e}(Utils||(Utils={}));var Utils;!function(t){var e=function(){function t(){}return t}();t.ScreenMetrics=e,function(t){t[t.PORTRAIT=0]="PORTRAIT",t[t.LANDSCAPE=1]="LANDSCAPE"}(t.Orientation||(t.Orientation={}));var i=t.Orientation,n=function(){function t(){}return t.calculateScreenMetrics=function(t,n,r,s,o){void 0===r&&(r=i.LANDSCAPE);var a,h;a=window.innerWidth,h=window.innerHeight,a=Math.min(a,1.5*t),h=Math.min(h,1.5*n);var l=r===i.LANDSCAPE?t/n:t/n,p=a/h,u=0,c=0,_=0,f=0;p>l?(f=n,_=2*Math.ceil(f*p/2),_=Math.min(_,s),u=(_-t)/2,c=0):(_=t,f=2*Math.ceil(_/p/2),f=Math.min(f,o),u=0,c=(f-n)/2);var m=a/_,d=h/f;return this.screenMetrics=new e,this.screenMetrics.windowWidth=a,this.screenMetrics.windowHeight=h,this.screenMetrics.defaultGameWidth=t,this.screenMetrics.defaultGameHeight=n,this.screenMetrics.maxGameWidth=s,this.screenMetrics.maxGameHeight=o,this.screenMetrics.gameWidth=_,this.screenMetrics.gameHeight=f,this.screenMetrics.scaleX=m,this.screenMetrics.scaleY=d,this.screenMetrics.offsetX=u,this.screenMetrics.offsetY=c,this.screenMetrics},t}();t.ScreenUtils=n}(Utils||(Utils={}));var Utils;!function(t){var e=function(){function t(){}return t}(),i=function(){function t(){}return t.save=function(){if(t.localStorageSupported()){var i=new e;i.musicOn=Leto.Global.musicOn,i.soundOn=Leto.Global.soundOn,i.currentLanguage=Leto.Global.currentLanguage;var n=JSON.stringify(i);localStorage.setItem("summer_save",n)}},t.load=function(){if(t.localStorageSupported()){var e=JSON.parse(localStorage.getItem("summer_save"));return null===e||void 0===e?!1:(Leto.Global.musicOn=e.musicOn,Leto.Global.soundOn=e.soundOn,Leto.Global.currentLanguage=e.currentLanguage,!0)}},t.localStorageSupported=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}},t}();t.StorageUtils=i}(Utils||(Utils={}));var Utils;!function(t){var e=function(){function t(){}return t.padNumber=function(t,e,i){void 0===i&&(i="0");var n=t+"";return n.length>=e?n:new Array(e-n.length+1).join(i)+n},t}();t.StringUtils=e}(Utils||(Utils={}));var Utils;!function(t){var e=function(){function t(){}return t.isAndroidStockBrowser=function(){var t=navigator.userAgent,e=/Android/.test(t),i=/Chrome/.test(t);return e&&!i},t}();t.SystemUtils=e}(Utils||(Utils={}));var Utils;!function(t){var e=function(){function t(){}return t.setTexts=function(e){t._texts=e},t.getText=function(e){if(null===t._texts)return"Texts not set";var i=t._texts;if(void 0===i[e])return"";var n=i[e][Leto.Global.currentLanguage];return void 0===n&&(Leto.Global.currentLanguage="en",n=i[e][Leto.Global.currentLanguage]),n},t.game=null,t._texts=null,t}();t.TextUtils=e}(Utils||(Utils={}));
